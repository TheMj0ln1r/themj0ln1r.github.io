<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Jersey CTF 2023
        
    </title><meta content="Jersey CTF 2023" property=og:title><link href=/favicons/favicon.ico rel=icon type=image/png><link href=https://themj0ln1r.github.io/fonts.css rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel=stylesheet><script async data-goatcounter=https://themj0ln1r.goatcounter.com/count src=https://themj0ln1r.github.io/js/count.js></script><noscript><img src="https://themj0ln1r.goatcounter.com//count?p=/archive/jerseyctf23/&t=Jersey CTF 2023"></noscript><script src=https://themj0ln1r.github.io/js/codeblock.js></script><script src=https://themj0ln1r.github.io/js/toc.js></script><script src=https://themj0ln1r.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="TheMj0ln1r Blog" href=https://themj0ln1r.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://themj0ln1r.github.io/theme/light.css rel=stylesheet><link href=https://themj0ln1r.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://themj0ln1r.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://themj0ln1r.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://themj0ln1r.github.io/><b>TheMj0ln1r Blog</b></a><div class=socials></div></div><nav><a href=https://themj0ln1r.github.io/cv style=margin-left:.5em><b>CV</b></a><a href=https://themj0ln1r.github.io/archive style=margin-left:.5em><b>Archive</b></a><a href=https://themj0ln1r.github.io/tags style=margin-left:.5em><b>Tags</b></a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://themj0ln1r.github.io/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://themj0ln1r.github.io/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>Jersey CTF 2023</div><div class=meta>Posted on <time>2023-04-18</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://themj0ln1r.github.io/tags/ctf/>ctf</a> </span></div></div><div class=toc-container><h5 class=toc-title>Table of Contents</h5><ul class=toc-list><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#crypto-challs>Crypto Challs</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#missing-employee-1>missing employee-1</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#jack-and-jill>jack-and-jill</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#space-dust>space-dust</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#roko-cipher-in-the-console>roko-cipher-in-the-console</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#supply-stash>supply-stash</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#play-reasonably>play-reasonably</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#web-look-im-hacking>Web - Look-Im-Hacking</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#forensics-unknown-origin>Forensics - unknown-origin</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#forensics-firefox-history>Forensics - firefox-history</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#bin-plain>bin - plain</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#osint-record-me>OSINT - record-me</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#osint-geo-guess>OSINT - geo-guess</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#misc-pits-of-tartarus>Misc - pits-of-tartarus</a><li><a href=https://themj0ln1r.github.io/archive/jerseyctf23/#misc-crack-keepass>Misc - crack-keepass</a></ul></div><section class=body><p>Hello ctfian's! I played <a href=https://ctftime.org/event/1908 target=_blank>JerseyCTF 2023</a> which was happened from 15 Apr to 16 Apr. I played it with the team <a href=https://ctftime.org/team/217079>Invaders0x1</a>. This time I scored 2600+ points. And our Team secured 125th place in CTF.<p><img alt=Progess src=/assets/img/ctf_img/jersey23/jersey_progress.png><blockquote><p><strong>This time I solved 6 challs in crypto which is my fav category.</strong></blockquote><h1 id=crypto-challs>Crypto Challs</h1><h1 id=missing-employee-1>missing employee-1</h1><p><img alt=missingemp1 src=/assets/img/ctf_img/jersey23/jersey_missemp1.png><p><code>TGltYSBBbHBoYSBLaWxvIEVjaG8gTWlrZSBJbmRpYSBDaGFybGllIEhvdGVsIEluZGlhIEdvbGYgQWxwaGEgTm92ZW1iZXI=</code> Decoded this text from base64<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~JerseyCTF/crypto/missing_employe_done$ echo </span><span style=color:#183691>"TGltYSBBbHBoYSBLaWxvIEVjaG8gTWlrZSBJbmRpYSBDaGFybGllIEhvdGVsIEluZGlhIEdvbGYgQWxwaGEgTm92ZW1iZXI=" </span><span style=color:#a71d5d;font-weight:700>| </span><span>base64 -d
</span><span>Lima Alpha Kilo Echo Mike India Charlie Hotel India Golf Alpha November
</span></code></pre><p>Submitted this in flag format, but it doesn't worked for me. The did a quick google search these words. And i found that these are the <a href=https://en.wikipedia.org/wiki/NATO_phonetic_alphabet target=_blank><strong>NATO phonetic alphabets</strong></a>. And decoded it by following the representations of this words.<p>Lima - l<br>Alpha - a<br>Kilo - k<br> Echo - e<br> and so on.<blockquote><p><code>Flag: jctf{lake-michigan}</code></blockquote><h1 id=jack-and-jill>jack-and-jill</h1><p><img alt=jackandjill src=/assets/img/ctf_img/jersey23/jersey_jack.png><p>Ciphertext is given : <code>pgQVJFCohpccuyBSbwxcxpVZCAATRT</code>. A 2x2 matrix is given [[3,9],[4,7]].<p>By observing the description i found that this is a <code>hill cipher</code>. I quickly searched for the hill cipher decoder online. I used <a href=https://www.dcode.fr/hill-cipher target=_blank>this site</a> to decipher the text.<p><img alt=jackandjilldecode src=/assets/img/ctf_img/jersey23/jersey_jack1.png><p>The deciphered text is <strong><code>hiTHEREwelcomeTOlinearALGEBRAZ</code></strong><blockquote><p><code>Flag : jctf{hiTHEREwelcomeTOlinearALGEBRAZ}</code></blockquote><h1 id=space-dust>space-dust</h1><p><img alt=spacedust src=/assets/img/ctf_img/jersey23/jersey_spacedust.png><p>The challenge have this attachment <a download href=/assets/files/ctf_files/jerseyctf23/message_from_tom.txt>message_from_tom.txt </a><p>First of all, I observed a <code>==</code> at the end of the content of the file. Immediated I decoded it from base64 and stored in other file. And the file size is a bit suspicious so I observed its hexdump. It contains a PNG header. So, I renamed the image image into decoded.png. Then i opened the image it has the flag in it.<pre class=language-bash data-lang=bash style=color:#323232;background-color:#fff><code class=language-bash data-lang=bash><span>mj0ln1r@Linux:~/space-dust$ cat message_from_tom.txt </span><span style=color:#a71d5d;font-weight:700>| </span><span>base64 -d </span><span style=color:#a71d5d;font-weight:700>>></span><span> decoded
</span><span>mj0ln1r@Linux:~/space-dust$
</span><span>mj0ln1r@Linux:~/space-dust$ xxd decode </span><span style=color:#a71d5d;font-weight:700>| </span><span>head
</span><span>00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR
</span><span>00000010: 0000 0a00 0000 05a0 0806 0000 0092 001a  ................
</span><span>00000020: df00 0000 0173 5247 4200 aece 1ce9 0000  .....sRGB.......
</span><span>00000030: 0004 6741 4d41 0000 b18f 0bfc 6105 0000  ..gAMA......a...
</span><span>00000040: 0009 7048 5973 0000 0ec3 0000 0ec3 01c7  ..pHYs..........
</span><span>00000050: 6fa8 6400 00ff a549 4441 5478 5ee4 fd67  o.d....IDATx^..g
</span><span>00000060: 776c 3b92 a609 1a35 e9d4 fae8 2b43 6556  wl</span><span style=color:#a71d5d;font-weight:700>;</span><span>....5....+CeV
</span><span>00000070: 5677 4fcf 879e 5933 ffad fe5d d7a8 55d5  VwO...Y3...]..U.
</span><span>00000080: 5599 1915 1157 9c7b 34b5 763a f5bc cf6b  U....W.{4.v:...k
</span><span>
</span><span>mj0ln1r@Linux:~/space-dust$ mv decoded decoded.png
</span></code></pre><p>The decoded image is <a download href=/assets/files/ctf_files/jerseyctf23/decoded.png> decoded.png </a>.<blockquote><p><code>Flag : jctf{th1s_1s_n0t_a_game}</code></blockquote><h1 id=roko-cipher-in-the-console>roko-cipher-in-the-console</h1><p><img alt=roko src=/assets/img/ctf_img/jersey23/jersey_roko.png><p>We can see this is a transpositional cipher. <code>f1stg}th10_ej{s__act_nam</code>. I observed that the flag is plaintext but it was transposed. We can observe that the <code>jctf{}</code> letters in the ciphertext.<p>I wrote this ciphertext in different deapths. Like writing it in 4 columns, 5 columns and so on . I observed a standard format when I write this in 6 columns.<p><img alt=rokocol src=/assets/img/ctf_img/jersey23/jersey_roko1.png><p>We can get the flag by reading column by column and in every column the order of reading letters is row-3,row-4,row-2,row-1.<p>That is first column should be taken as <code>jctf</code>. Second column is <code>{th1</code> and so on.<blockquote><p><code>Flag : jctf{th1s_1s_n0t_a_game}</code></blockquote><h1 id=supply-stash>supply-stash</h1><p><img alt=supplystash1 src=/assets/img/ctf_img/jersey23/jersey_supply1.png> <img alt=supplystash2 src=/assets/img/ctf_img/jersey23/jersey_supply2.png><p>This is medium level challenge in crypto. The challenge has a java file name <code>numericalEncoder.java</code><pre class=language-java data-lang=java style=color:#323232;background-color:#fff><code class=language-java data-lang=java><span style=color:#969896;font-style:italic>//Encoding program originally by Logan DesRochers
</span><span style=color:#a71d5d;font-weight:700>import </span><span style=color:#0086b3>java</span><span>.</span><span style=color:#0086b3>lang</span><span>.</span><span style=color:#0086b3>Math</span><span>;
</span><span style=color:#a71d5d;font-weight:700>import </span><span style=color:#0086b3>java</span><span>.</span><span style=color:#0086b3>util</span><span>.</span><span style=color:#0086b3>ArrayList</span><span>;
</span><span style=color:#a71d5d;font-weight:700>import </span><span style=color:#0086b3>java</span><span>.</span><span style=color:#0086b3>util</span><span>.</span><span style=color:#0086b3>Scanner</span><span>; 
</span><span>
</span><span style=color:#a71d5d;font-weight:700>public class </span><span style=color:#0086b3>numericalEncoder</span><span>{ 
</span><span>	</span><span style=color:#a71d5d;font-weight:700>public static void </span><span style=color:#795da3;font-weight:700>main</span><span>(</span><span style=color:#0086b3>String</span><span style=color:#a71d5d;font-weight:700>[] </span><span>args){ 
</span><span>		</span><span style=color:#0086b3>String</span><span> alphabet </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>"abcdefghijklmnopqrstuvwxyz"</span><span>;
</span><span>		</span><span style=color:#0086b3>Scanner</span><span> sc </span><span style=color:#a71d5d;font-weight:700>= new </span><span style=color:#0086b3>Scanner</span><span>(</span><span style=color:#0086b3>System</span><span>.in); 
</span><span>		</span><span style=color:#0086b3>System</span><span>.out.println(</span><span style=color:#183691>"Enter string to be encoded: "</span><span>);
</span><span>		</span><span style=color:#0086b3>String</span><span> m </span><span style=color:#a71d5d;font-weight:700>=</span><span> sc.nextLine(); 
</span><span>		m </span><span style=color:#a71d5d;font-weight:700>=</span><span> m.toLowerCase(); 
</span><span>		</span><span style=color:#0086b3>System</span><span>.out.println(</span><span style=color:#183691>"Enter int block size: "</span><span>);
</span><span>		</span><span style=color:#a71d5d;font-weight:700>int</span><span> r </span><span style=color:#a71d5d;font-weight:700>=</span><span> sc.nextInt();  
</span><span>
</span><span>		</span><span style=color:#969896;font-style:italic>//padding to variable block size 
</span><span>		</span><span style=color:#a71d5d;font-weight:700>if</span><span>(m.length() </span><span style=color:#a71d5d;font-weight:700>%</span><span> r </span><span style=color:#a71d5d;font-weight:700>!= </span><span style=color:#0086b3>0</span><span>){ 
</span><span>			</span><span style=color:#a71d5d;font-weight:700>while</span><span>(m.length() </span><span style=color:#a71d5d;font-weight:700>%</span><span> r </span><span style=color:#a71d5d;font-weight:700>!= </span><span style=color:#0086b3>0</span><span>){ 
</span><span>				m </span><span style=color:#a71d5d;font-weight:700>=</span><span> m </span><span style=color:#a71d5d;font-weight:700>+ </span><span style=color:#183691>"x"</span><span>;
</span><span>			}
</span><span>		}
</span><span>		</span><span style=color:#0086b3>System</span><span>.out.println(</span><span style=color:#183691>"M after padding: " </span><span style=color:#a71d5d;font-weight:700>+</span><span> m);
</span><span>		
</span><span>		</span><span style=color:#969896;font-style:italic>//Variable block size 
</span><span>		</span><span style=color:#0086b3>ArrayList</span><span>&lt;</span><span style=color:#0086b3>Integer</span><span>> encodedBlocks </span><span style=color:#a71d5d;font-weight:700>= new </span><span style=color:#0086b3>ArrayList</span><span>&lt;</span><span style=color:#0086b3>Integer</span><span>>();
</span><span>		</span><span style=color:#a71d5d;font-weight:700>int</span><span> numBlocks </span><span style=color:#a71d5d;font-weight:700>=</span><span> m.length() </span><span style=color:#a71d5d;font-weight:700>/</span><span> r; 
</span><span>		</span><span style=color:#a71d5d;font-weight:700>for</span><span>(</span><span style=color:#a71d5d;font-weight:700>int</span><span> i </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0</span><span>; i </span><span style=color:#a71d5d;font-weight:700>&lt;</span><span> numBlocks; i</span><span style=color:#a71d5d;font-weight:700>++</span><span>){ 
</span><span>			</span><span style=color:#0086b3>String</span><span> block </span><span style=color:#a71d5d;font-weight:700>=</span><span> m.substring(i </span><span style=color:#a71d5d;font-weight:700>*</span><span> r, r </span><span style=color:#a71d5d;font-weight:700>+</span><span> i </span><span style=color:#a71d5d;font-weight:700>*</span><span> r); 
</span><span>			</span><span style=color:#0086b3>System</span><span>.out.println(block);
</span><span>			</span><span style=color:#a71d5d;font-weight:700>int</span><span> power </span><span style=color:#a71d5d;font-weight:700>=</span><span> block.length() </span><span style=color:#a71d5d;font-weight:700>- </span><span style=color:#0086b3>1</span><span>;
</span><span>			</span><span style=color:#a71d5d;font-weight:700>int</span><span> representation </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0</span><span>;
</span><span>			</span><span style=color:#a71d5d;font-weight:700>for</span><span>(</span><span style=color:#a71d5d;font-weight:700>int</span><span> j </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0</span><span>; j </span><span style=color:#a71d5d;font-weight:700>&lt;</span><span> block.length(); j </span><span style=color:#a71d5d;font-weight:700>++</span><span>){
</span><span>                        	</span><span style=color:#0086b3>String</span><span> currentLetter </span><span style=color:#a71d5d;font-weight:700>=</span><span> block.substring(j,j</span><span style=color:#a71d5d;font-weight:700>+</span><span style=color:#0086b3>1</span><span>);
</span><span>                        	</span><span style=color:#a71d5d;font-weight:700>int</span><span> letterValue </span><span style=color:#a71d5d;font-weight:700>=</span><span> alphabet.indexOf(currentLetter);
</span><span>                        	representation </span><span style=color:#a71d5d;font-weight:700>+=</span><span> letterValue </span><span style=color:#a71d5d;font-weight:700>* </span><span style=color:#0086b3>Math</span><span>.pow(</span><span style=color:#0086b3>26</span><span>, power);
</span><span>                        	power</span><span style=color:#a71d5d;font-weight:700>--</span><span>;
</span><span>                	} 
</span><span>			encodedBlocks.add(representation);
</span><span>		}
</span><span>	        </span><span style=color:#0086b3>System</span><span>.out.println(</span><span style=color:#183691>"Encoded blocks are as follows: "</span><span>);	
</span><span>		</span><span style=color:#a71d5d;font-weight:700>for</span><span>(</span><span style=color:#a71d5d;font-weight:700>int</span><span> num </span><span style=color:#a71d5d;font-weight:700>:</span><span> encodedBlocks){
</span><span>			</span><span style=color:#0086b3>System</span><span>.out.println(num);
</span><span>		}
</span><span>	}
</span><span>}
</span></code></pre><p>The output of the above code is <code>SUPPLIES: 6639182 5837362 7923517 8463981 3588695 8358510"</code> and this is the encoded vesion of our flag. So analyzed the code and reversed the encoding program.<p>My observations are, the above code is doing generating a integer for for a block of characters. That is <code>6639182</code> is on encoded version of a block of characters. This is generated by accessing the index of the character from alphabet string and this is multiplied <code>pow(26,power)</code> where <code>power=len(block)-1</code> and this power is decreased for every new character in the block.<p>Okay, lets have some math. lets assume block size = 4 <br>power = 3<br>the initial encoded block value will become<br> <code>index(char)x26^3 + index(char)x26^2 + index(char)x26^1 + index(char)x26^0</code><br> Simply it is doing a <code>base26</code> operation. So, in the decode program, we have to perform decoding of base26.<p>This is the solution script which can give the decoded message from encoded blocks.<pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#a71d5d;font-weight:700>import </span><span>string
</span><span>alphabet </span><span style=color:#a71d5d;font-weight:700>= </span><span>string.ascii_lowercase
</span><span>input_str </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#62a35c>input</span><span>(</span><span style=color:#183691>"Enter numerical blocks to be decoded (separated by spaces): "</span><span>)
</span><span style=color:#969896;font-style:italic># split input into individual numerical blocks
</span><span>input_blocks </span><span style=color:#a71d5d;font-weight:700>= </span><span>input_str.split(</span><span style=color:#183691>" "</span><span>)
</span><span>decoded_blocks </span><span style=color:#a71d5d;font-weight:700>= </span><span>[]
</span><span style=color:#a71d5d;font-weight:700>for </span><span>block </span><span style=color:#a71d5d;font-weight:700>in </span><span>input_blocks:
</span><span>    num </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>int</span><span>(block)
</span><span>    decoded </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>""
</span><span>    </span><span style=color:#a71d5d;font-weight:700>while </span><span>num </span><span style=color:#a71d5d;font-weight:700>> </span><span style=color:#0086b3>0</span><span>:
</span><span>        remainder </span><span style=color:#a71d5d;font-weight:700>= </span><span>num </span><span style=color:#a71d5d;font-weight:700>% </span><span style=color:#0086b3>26
</span><span>        decoded_letter </span><span style=color:#a71d5d;font-weight:700>= </span><span>alphabet[remainder]
</span><span>        decoded </span><span style=color:#a71d5d;font-weight:700>= </span><span>decoded_letter </span><span style=color:#a71d5d;font-weight:700>+ </span><span>decoded
</span><span>        num </span><span style=color:#a71d5d;font-weight:700>//= </span><span style=color:#0086b3>26
</span><span>    decoded_blocks.append(decoded)
</span><span style=color:#969896;font-style:italic># combine decoded blocks into original message
</span><span>decoded_message </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>""</span><span>.join(decoded_blocks)
</span><span style=color:#62a35c>print</span><span>(</span><span style=color:#183691>"Decoded message: " </span><span style=color:#a71d5d;font-weight:700>+ </span><span>decoded_message)
</span><span style=color:#969896;font-style:italic>#6639182 5837362 7923517 8463981 3588695 8358510
</span><span style=color:#969896;font-style:italic># onthemuddyriversnorthwestshore
</span><span style=color:#969896;font-style:italic># jctf{onthemuddyriversnorthwestshore}
</span></code></pre><blockquote><p><code>Flag : jctf{onthemuddyriversnorthwestshore}</code></blockquote><h1 id=play-reasonably>play-reasonably</h1><p><img alt=playreasonably src=/assets/img/ctf_img/jersey23/jersey_play.png><p>This one is a special challenge. I spent more than an hour to solve this. And at the end of the ctf play-reasonably has only 11 solves.<p>Okay coming to challenge, I searched many keywords online but I havent find any thing positive. By observing carefully the ciphertext looks like it is from an old cipher. And I know about play-fair cipher. And they said play-reasonably and it matched with it. So, i started deciphering this playfair ciphertext.<p>Ciphertext : <code>WTATRHABWKYKACBMWD</code><br> I tried it with the key <code>THEBOYSAREBACKINTOWN</code> as the description highlighted it. I solved it with pen and paper as i know the working of playfair. Tried evry possible 5x5 key matrix.<p><code>THEBOYSARCKINWDFGLMPQUVXZ (-J)</code><br><code>THEBOYSARCKINWDFGJLMPQUXZ (-V)</code><br> <code>THEBOYSARCKINWDFGJLMPUVXZ (-Q)</code><br><code>THEBOYSARCKINWDFGJLMPQUVX (-Z)</code><br> None of them are worked. So, I read the description again, They said <code>theboysarebackintown</code> are playing in reverse.<br> So, I tried the key matrix in reverse order. <br> <code>NWOTIKCABERSYH</code> And the key matrix will be <code>NWOTIKCABERSYHDFGLMPQUVXZ (-J)</code><br><p>And I got the plaintext : <code>NOBODYCANCRACKTHIS</code><br> Here is my paper work might help you out.<p><img alt=playreasonablypaper src=/assets/img/ctf_img/jersey23/jersey_play1.jpeg><p>You can use <a href=https://www.dcode.fr/playfair-cipher target=_blank>this site</a> to decrypt or learn more about playfair ciper <a href=https://www.geeksforgeeks.org/playfair-cipher-with-examples/ target=_blank>here</a>.<blockquote><p><code>Flag : jctf{NOBODYCANCRACKTHIS}</code></blockquote><hr><h1 id=web-look-im-hacking>Web - Look-Im-Hacking</h1><p><img alt=look src=/assets/img/ctf_img/jersey23/jersey_lookim.png><p>A simple web challenge. The challenge url has the login page. I looked at the source code of it. And found this script.<pre class=language-html data-lang=html style=color:#323232;background-color:#fff><code class=language-html data-lang=html><span>&lt;!</span><span style=color:#a71d5d;font-weight:700>DOCTYPE </span><span style=color:#0086b3>html</span><span>>
</span><span>&lt;</span><span style=color:#63a35c>html </span><span style=color:#795da3>lang</span><span>=</span><span style=color:#183691>"en"</span><span>>
</span><span>
</span><span>&lt;</span><span style=color:#63a35c>head</span><span>>
</span><span>    &lt;</span><span style=color:#63a35c>meta </span><span style=color:#795da3>charset</span><span>=</span><span style=color:#183691>"UTF-8"</span><span>>
</span><span>    &lt;</span><span style=color:#63a35c>meta </span><span style=color:#795da3>http-equiv</span><span>=</span><span style=color:#183691>"X-UA-Compatible" </span><span style=color:#795da3>content</span><span>=</span><span style=color:#183691>"text/html"</span><span>>
</span><span>    &lt;</span><span style=color:#63a35c>meta </span><span style=color:#795da3>name</span><span>=</span><span style=color:#183691>"viewport" </span><span style=color:#795da3>content</span><span>=</span><span style=color:#183691>"width=device-width, initial-scale=1.0"</span><span>>
</span><span>    &lt;</span><span style=color:#63a35c>title</span><span>>Document&lt;/</span><span style=color:#63a35c>title</span><span>>
</span><span>
</span><span>    &lt;</span><span style=color:#63a35c>script </span><span style=color:#795da3>type</span><span>=</span><span style=color:#183691>"text/javascript"</span><span>>
</span><span>        </span><span style=color:#a71d5d;font-weight:700>var </span><span>passkey </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>''</span><span>;
</span><span>
</span><span>        </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>createPass</span><span>() {
</span><span>            </span><span style=color:#a71d5d;font-weight:700>const </span><span>valids </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$#@!&%"
</span><span>            </span><span style=color:#a71d5d;font-weight:700>for </span><span>(</span><span style=color:#a71d5d;font-weight:700>let </span><span>i </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0</span><span>; i </span><span style=color:#a71d5d;font-weight:700>&lt; </span><span style=color:#0086b3>20</span><span>; i</span><span style=color:#a71d5d;font-weight:700>++</span><span>) {
</span><span>                passkey </span><span style=color:#a71d5d;font-weight:700>+= </span><span>valids.charAt(</span><span style=color:#0086b3>Math</span><span>.</span><span style=color:#0086b3>floor</span><span>(</span><span style=color:#0086b3>Math</span><span>.</span><span style=color:#0086b3>random</span><span>() </span><span style=color:#a71d5d;font-weight:700>* </span><span>valids.length))
</span><span>            }
</span><span>            passkey </span><span style=color:#a71d5d;font-weight:700>= </span><span>btoa(passkey);
</span><span>        }
</span><span>
</span><span>        </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>checkPass</span><span>() {
</span><span>            </span><span style=color:#795da3>console</span><span>.</span><span style=color:#0086b3>log</span><span>(passkey)
</span><span>            </span><span style=color:#a71d5d;font-weight:700>if </span><span>(</span><span style=color:#0086b3>document</span><span>.getElementById(</span><span style=color:#183691>"un1"</span><span>).value </span><span style=color:#a71d5d;font-weight:700>== </span><span style=color:#183691>"admin" </span><span style=color:#a71d5d;font-weight:700>&& </span><span style=color:#0086b3>document</span><span>.getElementById(</span><span style=color:#183691>"pw2"</span><span>).value </span><span style=color:#a71d5d;font-weight:700>== </span><span>atob(passkey)) {
</span><span>                loadFlag();
</span><span>            }
</span><span>        }
</span><span>
</span><span>        </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>loadFlag</span><span>() {
</span><span>            </span><span style=color:#a71d5d;font-weight:700>const </span><span>xhttp </span><span style=color:#a71d5d;font-weight:700>= new </span><span style=color:#0086b3>XMLHttpRequest</span><span>();
</span><span>            </span><span style=color:#0086b3>xhttp</span><span>.</span><span style=color:#323232;font-weight:700>onload </span><span style=color:#a71d5d;font-weight:700>= function </span><span>() {
</span><span>                </span><span style=color:#0086b3>document</span><span>.getElementById(</span><span style=color:#183691>"reveal"</span><span>).innerHTML </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#ed6a43>this</span><span>.responseText;
</span><span>            }
</span><span>            xhttp.open(</span><span style=color:#183691>"GET"</span><span>, </span><span style=color:#183691>"./flag.txt"</span><span>)
</span><span>            xhttp.send();
</span><span>        }
</span><span>    &lt;/</span><span style=color:#63a35c>script</span><span>>
</span><span>&lt;/</span><span style=color:#63a35c>head</span><span>>
</span></code></pre><p>Found that there is a <code>/flag.txt</code> end point. And simply curling it results the flag.<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~/web$ curl https://www.jerseyctf.online/flag.txt
</span><span>$Hacker</span><span style=color:#a71d5d;font-weight:700>&</span><span>?r3@L$
</span></code></pre><blockquote><p><code>Flag : jctf{$Hacker&?r3@L$}</code></blockquote><hr><h1 id=forensics-unknown-origin>Forensics - unknown-origin</h1><p><img alt=unknown src=/assets/img/ctf_img/jersey23/jersey_unknown.png><p>The challenge have this attached <a download href=/assets/files/ctf_files/jerseyctf23/Photo.jpg>Photo.jpg</a>.<p>Simple strings does the job.<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~/forensics$ strings Photo.jpg </span><span style=color:#a71d5d;font-weight:700>| </span><span>grep jctf
</span><span>jctf{0gre$_h@ve_l@yers}
</span></code></pre><blockquote><p><code>Flag : jctf{0gre$_h@ve_l@yers}</code></blockquote><h1 id=forensics-firefox-history>Forensics - firefox-history</h1><p><img alt=firefox src=/assets/img/ctf_img/jersey23/jersey_firefox.png><p>Attached file : <a download href=/assets/files/ctf_files/jerseyctf23/places.sqlite>places.sqlite</a><p>So, i quickly searched for sqlite viewer online (I dont want to install additionally :) )<p>Found <a href=https://inloop.github.io/sqlite-viewer/ target=_blank>this site</a> to view sqlite file.<p>As the file name hints places. So selected <code>moz_places</code> table to view.<p><img alt="firefox places" src=/assets/img/ctf_img/jersey23/jersey_firefox1.png><p>As the description said, i looked for the jerseyctf.com entry in the table. It was on 137th row.<p><img alt="firefox jersey" src=/assets/img/ctf_img/jersey23/jersey_firefox2.png><p>I copied the last time visited value of the 137th entry. As the flag format is <code>jctf{YYYY-MM-DD-HH-MM-SS}</code> of this time, I used a seconds to epoch converter to get this format.<p><code>1674907264007000</code> to epoch on <a href=https://www.epochconverter.com/ target=_blank> this site </a><p><img alt="firefox epoch" src=/assets/img/ctf_img/jersey23/jersey_firefox3.png><p>And the correct format is the date in GMT that is <code>2023-01-28-12-01-04</code><blockquote><p><code>Flag : jctf{2023-01-28-12-01-04}</code></blockquote><hr><h1 id=bin-plain>bin - plain</h1><p><img alt=plain src=/assets/img/ctf_img/jersey23/jersey_plain.png><p>The challenge has bin executable named <code>plain</code><p>strings done the job for us again.<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~/forensics$ strings plain </span><span style=color:#a71d5d;font-weight:700>| </span><span>grep jctf
</span><span>jctf{i_</span><span style=color:#a71d5d;font-weight:700>&lt;</span><span style=color:#0086b3>3</span><span>_5tr1Ng5_59af0c0ed}
</span></code></pre><blockquote><p><code>Flag : jctf{i_&lt;3_5tr1Ng5_59af0c0ed}</code></blockquote><hr><h1 id=osint-record-me>OSINT - record-me</h1><p><img alt=recordme src=/assets/img/ctf_img/jersey23/jersey_record.png><p>The challenge is highlighting <code>record</code> and <code>jerseyctf.com</code>. So, I search for all the DNS records of jerseyctf.com.<p>I search all the <code>whois</code> records of the jerseyctf.com. And in there a string <code>pw-d714d7aa25df63925ec2b3893928671b</code>. As they are talking about password <code>pw</code> tempts me to submit it as flag.<br>But afer many unsuccesful tries I tried <code>dig</code> to fetch <code>DNS records</code> of jerseyctf.com.<p>And finally the flag is available at <code>TXT records</code> of jerseyctf.com. I used <code>dig</code> to do it.<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~/osint$ dig jerseyctf.com txt
</span><span>
</span><span style=color:#a71d5d;font-weight:700>; &lt;&lt;>></span><span> DiG 9.18.12-0ubuntu0.22.04.1-Ubuntu </span><span style=color:#a71d5d;font-weight:700>&lt;&lt;>></span><span> jerseyctf.com txt
</span><span>;</span><span style=color:#a71d5d;font-weight:700>; </span><span>global options: +cmd
</span><span>;</span><span style=color:#a71d5d;font-weight:700>; </span><span>Got answer:
</span><span>;</span><span style=color:#a71d5d;font-weight:700>; </span><span>-</span><span style=color:#a71d5d;font-weight:700>>></span><span>HEADER</span><span style=color:#a71d5d;font-weight:700>&lt;&lt;- opcode</span><span>: QUERY, status: NOERROR, id: 48664
</span><span style=color:#183691>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1
</span><span style=color:#183691>
</span><span style=color:#183691>;; OPT PSEUDOSECTION:
</span><span style=color:#183691>; EDNS: version: 0, flags:; udp: 65494
</span><span style=color:#183691>;; QUESTION SECTION:
</span><span style=color:#183691>;jerseyctf.com.			IN	TXT
</span><span style=color:#183691>
</span><span style=color:#183691>;; ANSWER SECTION:
</span><span style=color:#183691>jerseyctf.com.		3600	IN	TXT	"jctf{hop_OFF_TIKTOK_and_GET_s0me_SUN_OUTSID3!}"
</span><span style=color:#183691>
</span><span style=color:#183691>;; Query time: 732 msec
</span><span style=color:#183691>;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
</span><span style=color:#183691>;; WHEN: Fri Apr 21 12:14:36 IST 2023
</span><span style=color:#183691>;; MSG SIZE  rcvd: 101
</span></code></pre><blockquote><p><code>Flag : jctf{hop_OFF_TIKTOK_and_GET_s0me_SUN_OUTSID3!}</code></blockquote><h1 id=osint-geo-guess>OSINT - geo-guess</h1><p><img alt=geoguess src=/assets/img/ctf_img/jersey23/jersey_geoguess.png><p>So, its clear that we have to find the name of the building given in the picture.<p><img alt=geo src=/assets/img/ctf_img/jersey23/jersey_geoguess1.png><p>I did a quick google image search and found the building name right on the top of result.<p><img alt=geo src=/assets/img/ctf_img/jersey23/jersey_geoguess2.png><blockquote><p><code>Flag: jctf{west-edmonton-mall}</code></blockquote><hr><h1 id=misc-pits-of-tartarus>Misc - pits-of-tartarus</h1><p><img alt=pits src=/assets/img/ctf_img/jersey23/jersey_pits.png><p>The attached file : <a download href=/assets/files/ctf_files/jerseyctf23/file834.tar.gz>file834.tar.gz</a><p>This tar is a hundrends of recompressions of tar.gz<p>So, I run this command to loop over all the compressions in it and extract the files.<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~/misc$ for i in {834..1}</span><span style=color:#a71d5d;font-weight:700>; do </span><span>tar -xf file$i.tar.gz</span><span style=color:#a71d5d;font-weight:700>; </span><span>rm file$i.tar.gz</span><span style=color:#a71d5d;font-weight:700>; done
</span><span>mj0ln1r@Linux:~/misc$ ls
</span><span>file0.tar.gz
</span></code></pre><p>The above command will extract the zips and deletes it prior zip to make directory clean. As we can see now <code>file0.tar.gz</code> is the last one left.<p>Again this <code>file0.tar.gz</code> contains zips from file-1.tar.gz, and so on. So i extracted file0.tar.gz just one time then modified above command lil bit to extract this sequece of tars.<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~/misc$ tar -xf file0.tar.gz
</span><span>mj0ln1r@Linux:~/misc$ ls
</span><span>file-1.tar.gz
</span><span>mj0ln1r@Linux:~/misc$ for i in {1..833}</span><span style=color:#a71d5d;font-weight:700>; do </span><span>tar -xf file-$i.tar.gz</span><span style=color:#a71d5d;font-weight:700>; </span><span>rm file-$i.tar.gz</span><span style=color:#a71d5d;font-weight:700>; done
</span><span>tar: file-390.tar.gz: Cannot open: No such file or directory
</span><span>tar: Error is not recoverable: exiting now
</span><span>mj0ln1r@Linux:~/misc$ ls
</span><span>file.txt
</span><span>mj0ln1r@Linux:~/misc$ cat file.txt
</span><span>jctf{N0t_$tuck_in_tHe_t@r}
</span></code></pre><p>I assumed that there will be again 834 zips so I tried the above loop. But actually there were only <code>389</code> tars. Eventhough the above command extracted the file that we want but returned some error. The flag is present in <code>file.txt</code><blockquote><p><code>Flag : jctf{N0t_$tuck_in_tHe_t@r}</code></blockquote><hr><h1 id=misc-crack-keepass>Misc - crack-keepass</h1><p><img alt=keepass src=/assets/img/ctf_img/jersey23/jersey_keepass.png><p>Attached file : <a download href=/assets/files/ctf_files/jerseyctf23/Databse.kdbx>Databse.kdbx</a><p>This time I installed <code>keepassx</code> on my machine.<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~/misc$ sudo apt install keepassx
</span></code></pre><p>And I Opened the Database.kdbx with kepassx GUI app. It prompts me for a master password. As the challenge hints that crack, I cracked it with <code>JOHN</code> and <code>rockyou.txt</code>.<pre class=language-sh data-lang=sh style=color:#323232;background-color:#fff><code class=language-sh data-lang=sh><span>mj0ln1r@Linux:~/misc$ keepass2john Database.kdbx </span><span style=color:#a71d5d;font-weight:700>>></span><span> database_hashes_new.hash
</span><span>mj0ln1r@Linux:~/misc$ john --wordlist</span><span style=color:#a71d5d;font-weight:700>=</span><span>/usr/share/wordlists/rockyou.txt -format:keepass databse_hashes_new.hash
</span><span>Using default input encoding: UTF-8
</span><span>		Loaded 1 password hash (KeePass </span><span style=color:#a71d5d;font-weight:700>[</span><span>SHA256 AES 32/64</span><span style=color:#a71d5d;font-weight:700>]</span><span>)
</span><span>		Cost 1 (iteration count) is 60000 for all loaded hashes
</span><span>		Cost 2 (version) is 2 for all loaded hashes
</span><span>		Cost 3 (algorithm </span><span style=color:#a71d5d;font-weight:700>[</span><span>0=AES, 1=TwoFish, 2=ChaCha</span><span style=color:#a71d5d;font-weight:700>]</span><span>) is 0 for all loaded hashes
</span><span>		Press </span><span style=color:#183691>'q'</span><span> or Ctrl-C to abort, almost any other key for status
</span><span>		1jersey          (</span><span style=color:#a71d5d;font-weight:700>?</span><span>)
</span><span>		1g 0:01:57:04 DONE (2023-04-16 16:24) 0.000142g/s 53.41p/s 53.41c/s 53.41C/s 1jersey
</span><span>		Use the </span><span style=color:#183691>"--show"</span><span> option to display all of the cracked passwords reliably
</span><span>		Session completed
</span></code></pre><p>Master key of the database is <code>1jersey</code>.<p>So, I opened it the database file with master key. When I am navigating through the database file in keepassx app. I found a file named <code>flag</code> in General category.<blockquote><p><code>Flag : jctf{pr073c7_y0ur_v4ul7}</code></blockquote><hr></section></article></main></div>