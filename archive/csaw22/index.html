<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         CSAW CTF Qualification Round 2022
        
    </title><meta content="CSAW CTF Qualification Round 2022" property=og:title><link href=/favicons/favicon.ico rel=icon type=image/png><link href=https://themj0ln1r.github.io/fonts.css rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel=stylesheet><script async data-goatcounter=https://themj0ln1r.goatcounter.com/count src=https://themj0ln1r.github.io/js/count.js></script><noscript><img src="https://themj0ln1r.goatcounter.com//count?p=/archive/csaw22/&t=CSAW CTF Qualification Round 2022"></noscript><script src=https://themj0ln1r.github.io/js/codeblock.js></script><script src=https://themj0ln1r.github.io/js/toc.js></script><script src=https://themj0ln1r.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="TheMj0ln1r Blog" href=https://themj0ln1r.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://themj0ln1r.github.io/theme/light.css rel=stylesheet><link href=https://themj0ln1r.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://themj0ln1r.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://themj0ln1r.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://themj0ln1r.github.io/><b>TheMj0ln1r Blog</b></a><div class=socials></div></div><nav><a href=https://themj0ln1r.github.io/cv style=margin-left:.5em><b>CV</b></a><a href=https://themj0ln1r.github.io/archive style=margin-left:.5em><b>Archive</b></a><a href=https://themj0ln1r.github.io/tags style=margin-left:.5em><b>Tags</b></a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://themj0ln1r.github.io/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://themj0ln1r.github.io/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>CSAW CTF Qualification Round 2022</div><div class=meta>Posted on <time>2022-09-12</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://themj0ln1r.github.io/tags/ctf/>ctf</a> </span></div></div><div class=toc-container><h5 class=toc-title>Table of Contents</h5><ul class=toc-list><li><a href=https://themj0ln1r.github.io/archive/csaw22/#gotta-crack-them-all>Gotta Crack Them All</a><li><a href=https://themj0ln1r.github.io/archive/csaw22/#phi-in-too-much-common>Phi in Too Much Common</a> <ul><li><a href=https://themj0ln1r.github.io/archive/csaw22/#what-is-common-modulus-attack>What is common modulus attack?</a></ul><li><a href=https://themj0ln1r.github.io/archive/csaw22/#docker-leakage>Docker Leakage</a><li><a href=https://themj0ln1r.github.io/archive/csaw22/#word-wide-web>Word Wide Web</a><li><a href=https://themj0ln1r.github.io/archive/csaw22/#our-spy-in-new-terrain-osint>Our Spy In New Terrain(OSINT)</a></ul></div><section class=body><p>Hello ctfian's!,<p>I played the CSAW CTF Qualification Round 2022 which is a world wide ctf event held on 9th September 2022. CSAW CTF is one of the oldest and biggest CTFs with 1216 teams with 1+ points in 2021. Designed as an entry-level, jeopardy-style CTF, this competition is for students who are trying to break into the field of security, as well as for advanced students and industry professionals who want to practice their skills.<p>I solved 5 challenges in crypto, rev, web and forensics categories. These challenges boosted my confidence as it is my second ctf event and i spent complete two days to solve these challenges.<p>Okay lets see how i solved those challenges.<h1 id=gotta-crack-them-all>Gotta Crack Them All</h1><p><img alt=gotta_crack_them_all src=/assets/img/ctf_img/csaw22/gotta.png><p>The content of <code>encrypt.py</code><pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#a71d5d;font-weight:700>with </span><span style=color:#62a35c>open</span><span>(</span><span style=color:#183691>'key.txt'</span><span>,</span><span style=color:#183691>'rb'</span><span>) </span><span style=color:#a71d5d;font-weight:700>as </span><span>f:
</span><span>	key </span><span style=color:#a71d5d;font-weight:700>= </span><span>f.read()
</span><span style=color:#a71d5d;font-weight:700>def </span><span style=color:#323232;font-weight:700>encrypt</span><span>(plain):
</span><span>	</span><span style=color:#a71d5d;font-weight:700>return b</span><span style=color:#183691>''</span><span>.join((</span><span style=color:#62a35c>ord</span><span>(x) </span><span style=color:#a71d5d;font-weight:700>^ </span><span>y).to_bytes(</span><span style=color:#0086b3>1</span><span>,</span><span style=color:#183691>'big'</span><span>) </span><span style=color:#a71d5d;font-weight:700>for </span><span>(x,y) </span><span style=color:#a71d5d;font-weight:700>in </span><span style=color:#62a35c>zip</span><span>(plain,key))
</span><span>plain </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>"Cacturne-Grass-Dark"
</span><span style=color:#62a35c>print</span><span>(encrypt(plain))
</span></code></pre><p>The leaked password is <code>Cacturne-Grass-Dark</code> and the encrypted passwords are available in <code>encrypted_password.txt</code>.<p>If we observe the encrypt.py the passwords are encrypted using the XOR encryption.<p>First i tried to encrypt the leaked password with the given encryption algorithm. <img alt=gotta_leak src=/assets/img/ctf_img/csaw22/gotta_leak.png><p>Now i have a leaked password and its cipher <code>kz\xc6\xb9\xd9Du\xcb\x8a\x9e\xe0\x9d\xbeo\xee\x03\xcf\xddd</code>. Now the idea was simple if we XORed the leaked password with the cipher we can get the encryption key then that key can be used to decrypt all the encrypted passwords.<p>This code can do what we are talking about.<pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#a71d5d;font-weight:700>from </span><span>pwn </span><span style=color:#a71d5d;font-weight:700>import </span><span>xor
</span><span>f </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#62a35c>open</span><span>(</span><span style=color:#183691>"encrypted_passwords.txt"</span><span>,</span><span style=color:#183691>"rb"</span><span>)
</span><span>l </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>"Cacturne-Grass-Dark"
</span><span>c </span><span style=color:#a71d5d;font-weight:700>= b</span><span style=color:#183691>"kz</span><span style=color:#0086b3>\xc6\xb9\xd9</span><span style=color:#183691>Du</span><span style=color:#0086b3>\xcb\x8a\x9e\xe0\x9d\xbe</span><span style=color:#183691>o</span><span style=color:#0086b3>\xee\x03\xcf\xdd</span><span style=color:#183691>d"
</span><span>key </span><span style=color:#a71d5d;font-weight:700>= </span><span>xor(c,l)
</span><span>lines </span><span style=color:#a71d5d;font-weight:700>= </span><span>f.readlines()
</span><span style=color:#a71d5d;font-weight:700>for </span><span>i </span><span style=color:#a71d5d;font-weight:700>in </span><span>lines:
</span><span>	i </span><span style=color:#a71d5d;font-weight:700>= </span><span>i.strip()
</span><span>	tmp </span><span style=color:#a71d5d;font-weight:700>=</span><span style=color:#183691>''
</span><span>	</span><span style=color:#a71d5d;font-weight:700>for </span><span>y,l </span><span style=color:#a71d5d;font-weight:700>in </span><span style=color:#62a35c>zip</span><span>(key,i):
</span><span>		tmp </span><span style=color:#a71d5d;font-weight:700>+= </span><span style=color:#62a35c>chr</span><span>(y </span><span style=color:#a71d5d;font-weight:700>^ </span><span>l)
</span><span>	</span><span style=color:#62a35c>print</span><span>(tmp)
</span></code></pre><p>The output is<pre style=color:#323232;background-color:#fff><code><span>Chespin-Grass                                                                                                                                                        
</span><span>Mr. Mime-Psychic-Fa                                                                                                                                                  
</span><span>Tornadus-Flying                                                                                                                                                      
</span><span>Pupitar-Rock-Ground                                                                                                                                                  
</span><span>Combusken-Fire-Figh                                                                                                                                                  
</span><span>Guzzlord-Dark-Drago                                                                                                                                                  
</span><span>Carnivine-Grass                                                                                                                                                      
</span><span>Growlithe-Fire                                                                                                                                                       
</span><span>Grubbin-Bug                                                                                                                                                          
</span><span>Gastrodon-Water-Gro                                                                                                                                                  
</span><span>Goomy-Dragon                                                                                                                                                         
</span><span>Thievul-Dark                                                                                                                                                         
</span><span>1n53cu2357234mc1ph3                                                                                                                                                  
</span><span>Seadra-Water 
</span></code></pre><p>As we can see the last but one row has the flag but its not a complete flag. To find the full flag we have to find the key which is longer than the current one for that we can take the any decrypted password which is longer than the leaked password, then we can repeat the above process to get the complete flag.<p>I am taking <code>Gastrodon-Water-Ground-Steel</code> for now,<pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#a71d5d;font-weight:700>from </span><span>pwn </span><span style=color:#a71d5d;font-weight:700>import </span><span>xor
</span><span>f </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#62a35c>open</span><span>(</span><span style=color:#183691>"encrypted_passwords.txt"</span><span>,</span><span style=color:#183691>"rb"</span><span>)
</span><span>l </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>"Gastrodon-Water-Ground-Steel"
</span><span>c </span><span style=color:#a71d5d;font-weight:700>= b</span><span style=color:#183691>'oz</span><span style=color:#0086b3>\xd6\xb9\xde</span><span style=color:#183691>Y</span><span style=color:#0086b3>\x7f\xc1\xc9\xf4\xc5\x9d\xb9</span><span style=color:#183691>y</span><span style=color:#0086b3>\xb1</span><span style=color:#183691>j</span><span style=color:#0086b3>\xe9\xdd</span><span style=color:#183691>`</span><span style=color:#0086b3>\xe0\xe2\xdf</span><span style=color:#183691>'
</span><span>key </span><span style=color:#a71d5d;font-weight:700>= </span><span>xor(c,l)
</span><span>lines </span><span style=color:#a71d5d;font-weight:700>= </span><span>f.readlines()
</span><span style=color:#a71d5d;font-weight:700>for </span><span>i </span><span style=color:#a71d5d;font-weight:700>in </span><span>lines:
</span><span>	i </span><span style=color:#a71d5d;font-weight:700>= </span><span>i.strip()
</span><span>	tmp </span><span style=color:#a71d5d;font-weight:700>=</span><span style=color:#183691>''
</span><span>	</span><span style=color:#a71d5d;font-weight:700>for </span><span>y,l </span><span style=color:#a71d5d;font-weight:700>in </span><span style=color:#62a35c>zip</span><span>(key,i):
</span><span>		tmp </span><span style=color:#a71d5d;font-weight:700>+= </span><span style=color:#62a35c>chr</span><span>(y </span><span style=color:#a71d5d;font-weight:700>^ </span><span>l)
</span><span>	</span><span style=color:#62a35c>print</span><span>(tmp)
</span></code></pre><p>Wooooooh! we got it...<blockquote><p><code>The flag is 1n53cu2357234mc1ph32</code></blockquote><hr><h1 id=phi-in-too-much-common>Phi in Too Much Common</h1><p>Here it is the Chall which takes 5 hours of my life. But at the end it boosted my confidence levels upto the sky.<p><img alt=phi_in_too_much_common src=/assets/img/ctf_img/csaw22/phi.png><p>First i connected to the challenge with the netcat.<pre class=language-bash data-lang=bash style=color:#323232;background-color:#fff><code class=language-bash data-lang=bash><span>$ nc crypto.chal.csaw.io 5000
</span><span>**********   TOO MUCH IN COMMON      </span><span style=color:#a71d5d;font-weight:700>**********
</span><span>
</span><span>   Have at it!
</span><span>
</span><span>/------------------------------\
</span><span style=color:#a71d5d;font-weight:700>|           </span><span>COMMANDS              </span><span style=color:#a71d5d;font-weight:700>|
</span><span style=color:#a71d5d;font-weight:700>|                                 |
</span><span style=color:#a71d5d;font-weight:700>|   </span><span>1) ciphertext_info            </span><span style=color:#a71d5d;font-weight:700>|
</span><span style=color:#a71d5d;font-weight:700>|   </span><span>2) solve_challenge </span><span style=color:#a71d5d;font-weight:700>&lt;</span><span>password</span><span style=color:#a71d5d;font-weight:700>> |
</span><span style=color:#a71d5d;font-weight:700>|   </span><span>3) </span><span style=color:#62a35c>exit                       </span><span style=color:#a71d5d;font-weight:700>|
</span><span style=color:#0086b3>\-</span><span>-----------------------------/
</span><span>
</span><span style=color:#a71d5d;font-weight:700>> </span><span style=color:#0086b3>1
</span><span>N = 66230379529365020257079274492974065493126330971013187062230550667484536336498921190934189244362957312249586769969174687366278892047021464836842536529323843984917711253546999262427337059964746457287003004612989077687496386808318868155443955433495669933416861831960406309846051654977485404679018836950591207073
</span><span>e = 3203033219058218846809870595889303749356759660802874921757919347285050689023
</span><span>c = 16602634789029238804962653840385596228672793718393061759190379436477434589539439401344810124749337507914027486814367920958698864422367836842000865838169143446244202199945258912479805482529460471614475452210103481314126501905118652422131330354981855680471366776223771244856426005553912820240798175126871245542
</span><span style=color:#a71d5d;font-weight:700>></span><span> /------------------------------\
</span><span style=color:#a71d5d;font-weight:700>|           </span><span>COMMANDS              </span><span style=color:#a71d5d;font-weight:700>|
</span><span style=color:#a71d5d;font-weight:700>|                                 |
</span><span style=color:#a71d5d;font-weight:700>|   </span><span>1) ciphertext_info            </span><span style=color:#a71d5d;font-weight:700>|
</span><span style=color:#a71d5d;font-weight:700>|   </span><span>2) solve_challenge </span><span style=color:#a71d5d;font-weight:700>&lt;</span><span>password</span><span style=color:#a71d5d;font-weight:700>> |
</span><span style=color:#a71d5d;font-weight:700>|   </span><span>3) </span><span style=color:#62a35c>exit                       </span><span style=color:#a71d5d;font-weight:700>|
</span><span style=color:#0086b3>\-</span><span>-----------------------------/
</span><span>
</span><span style=color:#a71d5d;font-weight:700>> </span><span style=color:#0086b3>1
</span><span>N = 97158515552243305887166842257349497196761944723849796333314570210192465467248058977973817520811466238434579242618470413011446370885671769783517122178886737136267378478851110781637707375501871752419723352747812903232025026662684439394479235396634760931569159089432041476376506570454407306279469567609447874133
</span><span>e = 18408112354007983870269760119469358714794425138855862698209283717095203251527
</span><span>c = 40597559051967819648988812970676624339815299554173974340185756834851649772498697096416499057158638069790189014561709885506503658509085168258788719816632907655273832559720389170846504255470221971178328064025401908633312901398161846240306537659732243916190526957713561623469784228736357566604931785270598213207
</span></code></pre><p>When i choose option 1 multiple times the N, e and c values are changing. When i observed carefully the modulus(N) was common for the two different groups of N, e and c. Which means the common modulus attack can be performed on it.<h4 id=what-is-common-modulus-attack>What is common modulus attack?</h4><p>A Common Modulus attack can be used to recover the plaintext when the same message is encrypted to two RSA keys that use the same modulus.<pre class=language-bash data-lang=bash style=color:#323232;background-color:#fff><code class=language-bash data-lang=bash><span>c1 = m^e1 % N
</span><span>c2 = m^e2 % N
</span></code></pre><p>Assume that we find out <code>a</code> and <code>b</code> such that <code>(e1 * a) + (e2 * b) = 1</code> then we can decode the plain text as <code>(c1 ^ a) + (c2 ^ b)</code>. If we substitute how <code>c1</code> and <code>c2</code> is calculated to above equation, we can get <code>m^(e1 * a + e2 * b) = m^1 = m</code><p>I used the below script to perform common modulus attack.<pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#a71d5d;font-weight:700>import </span><span>gmpy2
</span><span style=color:#a71d5d;font-weight:700>import </span><span>codecs
</span><span style=color:#a71d5d;font-weight:700>from </span><span>Crypto.Util.number </span><span style=color:#a71d5d;font-weight:700>import </span><span>long_to_bytes
</span><span>
</span><span style=color:#a71d5d;font-weight:700>class </span><span style=color:#0086b3>RSAModuli</span><span>:
</span><span>   </span><span style=color:#a71d5d;font-weight:700>def </span><span style=color:#62a35c;font-weight:700>__init__</span><span>(self):
</span><span>       self.a </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0
</span><span>       self.b </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0
</span><span>       self.m </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0
</span><span>       self.i </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0
</span><span>   </span><span style=color:#a71d5d;font-weight:700>def </span><span style=color:#323232;font-weight:700>gcd</span><span>(self, num1, num2):
</span><span>       </span><span style=color:#a71d5d;font-weight:700>if </span><span>num1 </span><span style=color:#a71d5d;font-weight:700>&lt; </span><span>num2:
</span><span>           num1, num2 </span><span style=color:#a71d5d;font-weight:700>= </span><span>num2, num1
</span><span>       </span><span style=color:#a71d5d;font-weight:700>while </span><span>num2 </span><span style=color:#a71d5d;font-weight:700>!= </span><span style=color:#0086b3>0</span><span>:
</span><span>           num1, num2 </span><span style=color:#a71d5d;font-weight:700>= </span><span>num2, num1 </span><span style=color:#a71d5d;font-weight:700>% </span><span>num2
</span><span>       </span><span style=color:#a71d5d;font-weight:700>return </span><span>num1
</span><span>   </span><span style=color:#a71d5d;font-weight:700>def </span><span style=color:#323232;font-weight:700>extended_euclidean</span><span>(self, e1, e2):
</span><span>       self.a </span><span style=color:#a71d5d;font-weight:700>= </span><span>gmpy2.invert(e1, e2)
</span><span>       self.b </span><span style=color:#a71d5d;font-weight:700>= </span><span>(</span><span style=color:#0086b3>float</span><span>(self.gcd(e1, e2)</span><span style=color:#a71d5d;font-weight:700>-</span><span>(self.a</span><span style=color:#a71d5d;font-weight:700>*</span><span>e1)))</span><span style=color:#a71d5d;font-weight:700>/</span><span style=color:#0086b3>float</span><span>(e2)
</span><span>   </span><span style=color:#a71d5d;font-weight:700>def </span><span style=color:#323232;font-weight:700>modular_inverse</span><span>(self, c1, c2, N):
</span><span>       i </span><span style=color:#a71d5d;font-weight:700>= </span><span>gmpy2.invert(c2, N)
</span><span>       mx </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#62a35c>pow</span><span>(c1, self.a,N)
</span><span>       my </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#62a35c>pow</span><span>(i, </span><span style=color:#0086b3>int</span><span>(</span><span style=color:#a71d5d;font-weight:700>-</span><span>self.b),N)
</span><span>       self.m</span><span style=color:#a71d5d;font-weight:700>= </span><span>mx </span><span style=color:#a71d5d;font-weight:700>* </span><span>my </span><span style=color:#a71d5d;font-weight:700>% </span><span>N
</span><span>   </span><span style=color:#a71d5d;font-weight:700>def </span><span style=color:#323232;font-weight:700>print_value</span><span>(self):
</span><span>       </span><span style=color:#62a35c>print</span><span>(self.m)
</span><span>       </span><span style=color:#62a35c>print</span><span>(</span><span style=color:#183691>"password: "</span><span>,long_to_bytes(self.m))
</span><span style=color:#a71d5d;font-weight:700>def </span><span style=color:#323232;font-weight:700>main</span><span>():
</span><span>    c </span><span style=color:#a71d5d;font-weight:700>= </span><span>RSAModuli()
</span><span>    N </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>109912000665029852639110613517648329286456723008641339857280704469596849864902904497433699518400583047127310193951815657600773158070846253214404943365973285212833463085396438213201198699119774809946581077944790242766448113154577763539028406891886330959853165465205722422606657099078700917856140467421167666409
</span><span>
</span><span>    e1 </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>8483335375054406977170922622504583186337530016838437863282901026110032873283
</span><span>    c1 </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>36218335015829965116681857862094923911529670604844967899611205377832760775576260326404103773026455274015383498872180067299326123507394567136495776656445721750008053407884406429721981213028123626917002902133344001001211001153129276054910760656332569712713895293665052824134204563668126899459472515260162748678
</span><span>
</span><span>    e2 </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>1696092050134307306926141131399489465348028792933115624119794329313181584569
</span><span>    c2 </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>94573796694066531827336525466059061961386054753413091261062046296320713225203050227297438106686083614973232091111723401726835099681471993365822074034482977617851105101070185949797837862416460448964419708443214952302196757178552098691993586224947072414712511340978383044414218196216980045151588556976520156351
</span><span>
</span><span>    c.extended_euclidean(e1, e2)
</span><span>    c.modular_inverse(c1, c2, N)
</span><span>    c.print_value()
</span><span>
</span><span style=color:#a71d5d;font-weight:700>if </span><span>__name__ </span><span style=color:#a71d5d;font-weight:700>== </span><span style=color:#183691>'__main__'</span><span>:
</span><span>   main()
</span></code></pre><p>I found the password as <code>d0nt_reUs3_c0mm0n_m0duLus_iN_RSA</code><p>We are done with the first part of the challenge to solve the second part..<pre class=language-bash data-lang=bash style=color:#323232;background-color:#fff><code class=language-bash data-lang=bash><span>$ solve_challenge d0nt_reUs3_c0mm0n_m0duLus_iN_RSA
</span><span>
</span><span>********** What the Phi</span><span style=color:#a71d5d;font-weight:700>?  **********
</span><span>
</span><span>Give me phi and I</span><span style=color:#183691>'ll give you a flag
</span><span style=color:#183691>
</span><span style=color:#183691>
</span><span style=color:#183691>N = 66066217976516971108331646970610979560181811216809026125374761401858626331392870627229620955983691200317085064577482992998109175639414254550344337027939622032942798889975535536500814391606941216261629656776109514048858091999991043910655394546974123840192922578050723036392957820297149086606568090771652618243
</span><span style=color:#183691>
</span><span style=color:#183691>e = 20911404459149607080658877037893189424319551114362027603024719781837162747157
</span><span style=color:#183691>
</span><span style=color:#183691>d = 32917938316361268851470019425123434593213351924151169940566051302446183421108067642636220773665398581581750049220982066160562413581944447113654550659609920491577412625130031315991437456861571031336990406560139987319989696833394896272093289655434473735396587020547428232094106902009380465366775232334689581885
</span><span style=color:#183691>/------------------------------\
</span><span style=color:#183691>|           COMMANDS              |
</span><span style=color:#183691>|                                 |
</span><span style=color:#183691>|   1) try_again                  |
</span><span style=color:#183691>|   2) phi &lt;phi_value>            |
</span><span style=color:#183691>|   3) exit                       |
</span><span style=color:#183691>\------------------------------/
</span></code></pre><p>Now we have to find the phi value to get the flag.<p>For this second part i struggled a lot and i wrote this script on my own and i dont know how it was successfully generated those two valid primes and the phi, haha.<pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#a71d5d;font-weight:700>import </span><span>random
</span><span style=color:#a71d5d;font-weight:700>import </span><span>math
</span><span>
</span><span>d </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>32917938316361268851470019425123434593213351924151169940566051302446183421108067642636220773665398581581750049220982066160562413581944447113654550659609920491577412625130031315991437456861571031336990406560139987319989696833394896272093289655434473735396587020547428232094106902009380465366775232334689581885
</span><span>e </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>20911404459149607080658877037893189424319551114362027603024719781837162747157
</span><span>n </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>66066217976516971108331646970610979560181811216809026125374761401858626331392870627229620955983691200317085064577482992998109175639414254550344337027939622032942798889975535536500814391606941216261629656776109514048858091999991043910655394546974123840192922578050723036392957820297149086606568090771652618243
</span><span>k </span><span style=color:#a71d5d;font-weight:700>= </span><span>(d</span><span style=color:#a71d5d;font-weight:700>*</span><span>e)</span><span style=color:#a71d5d;font-weight:700>-</span><span style=color:#0086b3>1
</span><span>t </span><span style=color:#a71d5d;font-weight:700>= </span><span>k
</span><span>g </span><span style=color:#a71d5d;font-weight:700>= </span><span>random.randint(</span><span style=color:#0086b3>2</span><span>,n</span><span style=color:#a71d5d;font-weight:700>-</span><span style=color:#0086b3>1</span><span>)
</span><span style=color:#a71d5d;font-weight:700>for </span><span>i </span><span style=color:#a71d5d;font-weight:700>in </span><span style=color:#62a35c>range</span><span>(</span><span style=color:#0086b3>1000000</span><span>):
</span><span>	</span><span style=color:#a71d5d;font-weight:700>if </span><span>(t</span><span style=color:#a71d5d;font-weight:700>%</span><span style=color:#0086b3>2 </span><span style=color:#a71d5d;font-weight:700>== </span><span style=color:#0086b3>0</span><span>):
</span><span>		t </span><span style=color:#a71d5d;font-weight:700>= </span><span>t</span><span style=color:#a71d5d;font-weight:700>//</span><span style=color:#0086b3>2
</span><span>		x </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#62a35c>pow</span><span>(g,t,n)
</span><span>	</span><span style=color:#a71d5d;font-weight:700>else</span><span>:
</span><span>		g </span><span style=color:#a71d5d;font-weight:700>= </span><span>random.randint(</span><span style=color:#0086b3>2</span><span>,n</span><span style=color:#a71d5d;font-weight:700>-</span><span style=color:#0086b3>1</span><span>)
</span><span>y </span><span style=color:#a71d5d;font-weight:700>= </span><span>math.gcd(x</span><span style=color:#a71d5d;font-weight:700>-</span><span style=color:#0086b3>1</span><span>,n)
</span><span style=color:#a71d5d;font-weight:700>if</span><span>(x</span><span style=color:#a71d5d;font-weight:700>></span><span style=color:#0086b3>1 </span><span style=color:#a71d5d;font-weight:700>and </span><span>y</span><span style=color:#a71d5d;font-weight:700>></span><span style=color:#0086b3>1</span><span>):
</span><span>	p </span><span style=color:#a71d5d;font-weight:700>= </span><span>y
</span><span>	q </span><span style=color:#a71d5d;font-weight:700>= </span><span>n</span><span style=color:#a71d5d;font-weight:700>//</span><span>y
</span><span>	p</span><span style=color:#a71d5d;font-weight:700>=</span><span>p</span><span style=color:#a71d5d;font-weight:700>-</span><span style=color:#0086b3>1
</span><span>	q</span><span style=color:#a71d5d;font-weight:700>=</span><span>q</span><span style=color:#a71d5d;font-weight:700>-</span><span style=color:#0086b3>1
</span><span>	</span><span style=color:#62a35c>print</span><span>(</span><span style=color:#183691>"phi = "</span><span>,p</span><span style=color:#a71d5d;font-weight:700>*</span><span>q)
</span></code></pre><p>The output is<pre style=color:#323232;background-color:#fff><code><span>phi =  6606621797651697110833164697061097956018181121680902612537476140185862633139287062722962095598369120031708506457748299299810917563941425455034433702793960573434125683360519280660171596715437809832319695445903799227924638336403470759412317164477901296089898605107284333156354738806489492495310099184632281164
</span></code></pre><p>But the hardest truth is that we can do the second part in just 5 lines of code <code>-_-</code><pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#a71d5d;font-weight:700>from </span><span>Crypto.Util.number </span><span style=color:#a71d5d;font-weight:700>import </span><span style=color:#0086b3>*
</span><span style=color:#a71d5d;font-weight:700>from </span><span>Crypto.PublicKey </span><span style=color:#a71d5d;font-weight:700>import </span><span style=color:#0086b3>RSA
</span><span>rsa </span><span style=color:#a71d5d;font-weight:700>= </span><span>RSA.construct((N, e, d))
</span><span>p </span><span style=color:#a71d5d;font-weight:700>= </span><span>rsa.p
</span><span>q </span><span style=color:#a71d5d;font-weight:700>= </span><span>rsa.q
</span><span>phi </span><span style=color:#a71d5d;font-weight:700>= </span><span>(p </span><span style=color:#a71d5d;font-weight:700>- </span><span style=color:#0086b3>1</span><span>) </span><span style=color:#a71d5d;font-weight:700>* </span><span>(q </span><span style=color:#a71d5d;font-weight:700>- </span><span style=color:#0086b3>1</span><span>)
</span></code></pre><p>Anyways, when i submitted the phi value to the program it printed the flag. Woooooooh!<pre class=language-bash data-lang=bash style=color:#323232;background-color:#fff><code class=language-bash data-lang=bash><span style=color:#a71d5d;font-weight:700>> </span><span style=color:#0086b3>2 </span><span>6606621797651697110833164697061097956018181121680902612537476140185862633139287062722962095598369120031708506457748299299810917563941425455034433702793960573434125683360519280660171596715437809832319695445903799227924638336403470759412317164477901296089898605107284333156354738806489492495310099184632281164
</span><span>
</span><span>What?! How did you do that</span><span style=color:#a71d5d;font-weight:700>??
</span><span>
</span><span>flag{aR3nT_U_tH3_RSA_ninJA}
</span></code></pre><blockquote><p><code>Flag : flag{aR3nT_U_tH3_RSA_ninJA}</code></blockquote><p>Thank you Phi in Too Much Common.<hr><h1 id=docker-leakage>Docker Leakage</h1><p><img alt=DockeRElekage src=/assets/img/ctf_img/csaw22/dockeREleakage.png><p>Docker Leakage is a reversing challenge, the challenge provides a dockeREleakage.zip file which consist of docker image details.<p>Lets do some reversing on the dockeRElekage folder.<p>I found some intresting data in the <code>acbb216b17482071caca135101282177f6ffed7b8ee0bfc5323aae103c216d74.json</code> file.<pre style=color:#323232;background-color:#fff><code><span>{"architecture":"amd64","config":{"Hostname":"","Domainname":"","User":"","AttachStdin":false,"AttachStdout":false,"AttachStderr":false,"Tty":false,"OpenStdin":false,"StdinOnce":false,"Env":["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"],"Cmd":["/bin/sh"],"Image":"sha256:3b6dbca4ef6990ef88e9d4f28fae8ca57308e779dcb94dc9c4a8fee02e1322c0","Volumes":null,"WorkingDir":"/chal","Entrypoint":null,"OnBuild":null,"Labels":null},"container":"1e4786117e284daaf67335704abef1dac17eaff92d5714a9683ce735c48004c8","container_config":{"Hostname":"1e4786117e28","Domainname":"","User":"","AttachStdin":false,"AttachStdout":false,"AttachStderr":false,"Tty":false,"OpenStdin":false,"StdinOnce":false,"Env":["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"],"Cmd":["/bin/sh","-c","#(nop) ","CMD [\"/bin/sh\"]"],"Image":"sha256:3b6dbca4ef6990ef88e9d4f28fae8ca57308e779dcb94dc9c4a8fee02e1322c0","Volumes":null,"WorkingDir":"/chal","Entrypoint":null,"OnBuild":null,"Labels":{}},"created":"2022-09-03T07:46:14.235116602Z","docker_version":"20.10.11+dfsg1","history":[{"created":"2022-08-09T17:19:53.274069586Z","created_by":"/bin/sh -c #(nop) ADD file:2a949686d9886ac7c10582a6c29116fd29d3077d02755e87e111870d63607725 in / "},{"created":"2022-08-09T17:19:53.47374331Z","created_by":"/bin/sh -c #(nop)  CMD [\"/bin/sh\"]","empty_layer":true},{"created":"2022-09-03T07:46:11.653961901Z","created_by":"/bin/sh -c #(nop) WORKDIR /chal"},{"created":"2022-09-03T07:46:11.863666686Z","created_by":"/bin/sh -c #(nop) COPY file:d65d0cfa1f5c483eff02b6016940ff4d85eb3b216f05d23a2b891cea6801be2a in p-flag.txt "},{"created":"2022-09-03T07:46:12.680399343Z","created_by":"/bin/sh -c echo \"ZmxhZ3tuM3Yzcl9sMzR2M181M241MTcxdjNfMW5mMHJtNDcxMG5fdW5wcjA=\" \u003e /dev/null","empty_layer":true},{"created":"2022-09-03T07:46:13.319972067Z","created_by":"/bin/sh -c cat p-flag.txt \u003e tmp.txt; rm -rf flag.txt p-flag.txt; mv tmp.txt flag.txt; echo \"\" \u003e\u003e flag.txt"},{"created":"2022-09-03T07:46:14.02363242Z","created_by":"/bin/sh -c echo \"Find the rest of the flag by yourself!\" \u003e\u003e flag.txt"},{"created":"2022-09-03T07:46:14.235116602Z","created_by":"/bin/sh -c #(nop)  CMD [\"/bin/sh\"]","empty_layer":true}],"os":"linux","rootfs":{"type":"layers","diff_ids":["sha256:994393dc58e7931862558d06e46aa2bb17487044f670f310dffe1d24e4d1eec7","sha256:3496f3297d64782df57121721ca912bebd3d8c0bf5c5a12d76ac2f4c58d900a5","sha256:0c0811e580c073e93ce547fd176f40debc3e67b99325fa633c4ea877dbf2c543","sha256:10f39dbbae65c969d02d804d337d3836517c61706ec93b1f929a326451cbe0b2","sha256:d09e067ee442e434d4c350e403b686f5038c29da8f94eff1f25b15aa7c158c46"]}}
</span></code></pre><p>There is a base64 encoded data found in the above data. <code>ZmxhZ3tuM3Yzcl9sMzR2M181M241MTcxdjNfMW5mMHJtNDcxMG5fdW5wcjA=</code><pre class=language-bash data-lang=bash style=color:#323232;background-color:#fff><code class=language-bash data-lang=bash><span>$ echo </span><span style=color:#183691>"ZmxhZ3tuM3Yzcl9sMzR2M181M241MTcxdjNfMW5mMHJtNDcxMG5fdW5wcjA=" </span><span style=color:#a71d5d;font-weight:700>| </span><span>base64 -d
</span><span>$ flag{n3v3r_l34v3_53n5171v3_1nf0rm4710n_unpr0
</span></code></pre><p>As you can see i got the first part of the flag.<p>Lets move much deeper to for the remaining flag. I found a layer.zip file in the 4ec42253273e93963f11241e29497f0fcef730a2864d8ea025dcdb4fc316659e folder. When i extract that zip file i found the flag.txt file inside the chall folder. The flag.txt has the second part of the flag.<blockquote><p><code>Flag : flag{n3v3r_l34v3_53n5171v3_1nf0rm4710n_unpr073c73d_w17h1n_7h3_d0ck3rf1l3}</code></blockquote><hr><h1 id=word-wide-web>Word Wide Web</h1><p><img alt=Word_Wide_Web src=/assets/img/ctf_img/csaw22/wordwideweb.png><p>http://web.chal.csaw.io:5010/stuff have the huge number of words in it, among all of them one word has the hyperlink to the another page. When we automate the process until we get the last page which can get the flag.<pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#969896;font-style:italic>#!/usr/bin/env python3
</span><span style=color:#a71d5d;font-weight:700>import </span><span>requests
</span><span style=color:#a71d5d;font-weight:700>import </span><span>re
</span><span>
</span><span>s </span><span style=color:#a71d5d;font-weight:700>= </span><span>requests.Session()
</span><span>
</span><span>url </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>'http://web.chal.csaw.io:5010'
</span><span>path </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>''
</span><span>
</span><span style=color:#a71d5d;font-weight:700>while </span><span style=color:#0086b3>True</span><span>:
</span><span>    r </span><span style=color:#a71d5d;font-weight:700>= </span><span>s.get(url </span><span style=color:#a71d5d;font-weight:700>+ </span><span>path)
</span><span>    body </span><span style=color:#a71d5d;font-weight:700>= </span><span>r.text
</span><span>
</span><span>    pattern </span><span style=color:#a71d5d;font-weight:700>= r</span><span style=color:#183691>'</span><span style=color:#0086b3>\&lt;</span><span style=color:#183691>a href="(</span><span style=color:#0086b3>\/.</span><span style=color:#a71d5d;font-weight:700>+</span><span style=color:#183691>)"</span><span style=color:#0086b3>\></span><span style=color:#183691>'
</span><span>    m </span><span style=color:#a71d5d;font-weight:700>= </span><span>re.search(pattern, body)
</span><span>    </span><span style=color:#a71d5d;font-weight:700>if </span><span>m </span><span style=color:#a71d5d;font-weight:700>is </span><span style=color:#0086b3>None</span><span>:
</span><span>        </span><span style=color:#62a35c>print</span><span>(body)
</span><span>        </span><span style=color:#a71d5d;font-weight:700>break
</span><span>    path </span><span style=color:#a71d5d;font-weight:700>= </span><span>m.group(</span><span style=color:#0086b3>1</span><span>)
</span></code></pre><blockquote><p><code>Flag : CTF{w0rdS_4R3_4mAz1nG_r1ght}</code></blockquote><hr><h1 id=our-spy-in-new-terrain-osint>Our Spy In New Terrain(OSINT)</h1><p><img alt=OSINT src=/assets/img/ctf_img/csaw22/our_sint.png><p>This is an intresting OSINT challenge from the forensics category. They provided just the twitter account name of the recruit. We have to answer the questions been asked in the remote program <code>nc misc.chall.csaw.io 5005</code>.<p>There are total 6 questions asked.<p>1.When did the enemy agent join twitter?<blockquote><p>08/2022</blockquote><p>2.What is the spy's github username?<p>I used wayback machine to view the deleted tweets of the agent.<blockquote><p>spyduhman</blockquote><p>3.What is the full name of the file that contains communications between the enemy and the evil spy?<p>There is a deleted log.txt file in which communications are done.<blockquote><p>log.txt</blockquote><p>4.Which country is the target based in?<p>The log.txt file contains a link to the a audio file. I used an online morse code converter to decode the Assignment.wav<p>The decoded text is <code>HTLLO EVIL AGENT YOUR NEXT TARGET IS A BANK THE BANK'S BIN NUMBER IS 452234 THE TARGETS SWIFT CODE IS YOUR PASSWORD FOR MORE INSTRUCTIONS VISIT BIT.LY SLASH Ã˜SINTSEC GOOD LUCK</code><blockquote><p>canada</blockquote><p>5.What is the target's international Swift code?<p>BIN : 452234(canada bank) The bank which is having above bin number is TORONTO-DOMINION BANK<blockquote><p>SWIFT code: TDOMCATTTOR</blockquote><p>6.What is a crime?<p>The YoureSoClose.pdf is available in bit.ly/osintsec the link is found from the morse code decoder.<p>The YoureSoClose.pdf is password protected the password is TDOMCATTTOR. The title of the pdf is the crime.<blockquote><p>copyright infringement</blockquote><p>After that we got the flag.<blockquote><p><code>Flag : flag{C0N6r475463N7600DW0rKN3X771M3N0PU811C53rV3r}</code></blockquote><hr></section></article></main></div>