<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         MetaRed CTF 2023
        
    </title><meta content="MetaRed CTF 2023" property=og:title><link href=/favicons/favicon.ico rel=icon type=image/png><link href=https://themj0ln1r.github.io/fonts.css rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel=stylesheet><script async data-goatcounter=https://themj0ln1r.goatcounter.com/count src=https://themj0ln1r.github.io/js/count.js></script><noscript><img src="https://themj0ln1r.goatcounter.com//count?p=/archive/metaredctf23/&t=MetaRed CTF 2023"></noscript><script src=https://themj0ln1r.github.io/js/codeblock.js></script><script src=https://themj0ln1r.github.io/js/toc.js></script><script src=https://themj0ln1r.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="TheMj0ln1r Blog" href=https://themj0ln1r.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://themj0ln1r.github.io/theme/light.css rel=stylesheet><link href=https://themj0ln1r.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://themj0ln1r.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://themj0ln1r.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://themj0ln1r.github.io/><b>TheMj0ln1r Blog</b></a><div class=socials></div></div><nav><a href=https://themj0ln1r.github.io/cv style=margin-left:.5em><b>CV</b></a><a href=https://themj0ln1r.github.io/archive style=margin-left:.5em><b>Archive</b></a><a href=https://themj0ln1r.github.io/tags style=margin-left:.5em><b>Tags</b></a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://themj0ln1r.github.io/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://themj0ln1r.github.io/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>MetaRed CTF 2023</div><div class=meta>Posted on <time>2023-10-26</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://themj0ln1r.github.io/tags/ctf/>ctf</a>, <a class=post-tag href=https://themj0ln1r.github.io/tags/blockchain/>blockchain</a> </span></div></div><div class=toc-container><h5 class=toc-title>Table of Contents</h5><ul class=toc-list><li><a href=https://themj0ln1r.github.io/archive/metaredctf23/#blockchain>Blockchain</a> <ul><li><a href=https://themj0ln1r.github.io/archive/metaredctf23/#givememoney-500pts>GiveMeMoney [500pts]</a><li><a href=https://themj0ln1r.github.io/archive/metaredctf23/#open-500pts>Open [500pts]</a><li><a href=https://themj0ln1r.github.io/archive/metaredctf23/#ether-footprint-500pts>Ether Footprint [500pts]</a></ul></ul></div><section class=body><p>Hello mate, I played <a href=https://ctftime.org/event/2107 target=_blank>MetaRedCTF</a>. I am too late to the party got few hours to play, but solved few blockchain challenges. Challenges are not available after CTF, so I can't explain in detail what the challenge is. I try my best to explain what I did.<h1 id=blockchain>Blockchain</h1><h2 id=givememoney-500pts>GiveMeMoney [500pts]</h2><p>Challenge is to find network and contract method to call. We are given with contract address.<p><strong>0xA2720666b2e3D878b0E7FC80bc1D02958EA648DE</strong><p>Initiated a foundry project quickly.<p><code>forge init</code><p>Created the solution script under <code>/scripts</code>.<p><code>SolveGiveMeMoney.s.sol</code><pre class=language-javascript data-lang=javascript style=color:#323232;background-color:#fff><code class=language-javascript data-lang=javascript><span style=color:#969896;font-style:italic>// SPDX-License-Identifier: UNLICENSED
</span><span>pragma solidity </span><span style=color:#a71d5d;font-weight:700>^</span><span style=color:#0086b3>0.8</span><span>.</span><span style=color:#0086b3>13</span><span>;
</span><span>
</span><span style=color:#a71d5d;font-weight:700>import </span><span style=color:#183691>"forge-std/Script.sol"</span><span>;
</span><span>contract GiveMeMoneyScript is Script {
</span><span>    </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>setUp</span><span>() </span><span style=color:#795da3;font-weight:700>public </span><span>{}
</span><span>
</span><span>    </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>run</span><span>() </span><span style=color:#795da3;font-weight:700>public </span><span>{
</span><span>        vm.</span><span style=color:#795da3;font-weight:700>startBroadcast</span><span>();
</span><span>        </span><span style=color:#795da3;font-weight:700>solveGiveMeMoney</span><span>();
</span><span>        vm.</span><span style=color:#795da3;font-weight:700>stopBroadcast</span><span>();
</span><span>    }
</span><span>    </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>solveGiveMeMoney</span><span>() </span><span style=color:#795da3;font-weight:700>public </span><span>{
</span><span>        address target </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0xA2720666b2e3D878b0E7FC80bc1D02958EA648DE</span><span>;
</span><span>        (bool success, ) </span><span style=color:#a71d5d;font-weight:700>= </span><span>target.call{value:</span><span style=color:#0086b3>0.101 </span><span>ether}(abi.</span><span style=color:#795da3;font-weight:700>encodeWithSignature</span><span>(</span><span style=color:#183691>"deposit(string)"</span><span>,</span><span style=color:#183691>"ODM1.pHrlmtdBQY9UIYaE-WVDGTPOWP0"</span><span>));
</span><span>        </span><span style=color:#62a35c>require</span><span>(success);
</span><span>    }
</span><span>}
</span></code></pre><p>This script will call the contract method <code>deposit()</code> with the string provided in the challenge as arguement. We have to send above <code>0.1 Eth</code> along with the call.<p>To run the script we need to find the network of the contract. It is <code>Goerli</code>, Found from etherscan. We need some test ether mined it from goerli POW faucet.<p>To run the script :<pre class=language-bash data-lang=bash style=color:#323232;background-color:#fff><code class=language-bash data-lang=bash><span>mj0ln1r@AHLinux:~/$ forge script scripts/SolveGiveMeMoney.s.sol --rpc-url </span><span style=color:#a71d5d;font-weight:700>&lt;</span><span>REDACTED</span><span style=color:#a71d5d;font-weight:700>> </span><span>--private-key </span><span style=color:#a71d5d;font-weight:700>&lt;</span><span>REDACTED</span><span style=color:#a71d5d;font-weight:700>> </span><span>--broadcast
</span></code></pre><p>The RPC-URL can create from alchemy, private-key is your testing wallet private key.<p>We wont get the flag, the challenge will be automatically solved once we run this.<h2 id=open-500pts>Open [500pts]</h2><p><strong>Contract : 0x35388184260d8A3cE75B5df5bbA1904b68746b27</strong><p>This challenge is also kinda same, the solve script is as follows,<p><code>SolveOpen.s.sol</code><pre class=language-javascript data-lang=javascript style=color:#323232;background-color:#fff><code class=language-javascript data-lang=javascript><span style=color:#969896;font-style:italic>// SPDX-License-Identifier: UNLICENSED
</span><span>pragma solidity </span><span style=color:#a71d5d;font-weight:700>^</span><span style=color:#0086b3>0.8</span><span>.</span><span style=color:#0086b3>13</span><span>;
</span><span>
</span><span style=color:#a71d5d;font-weight:700>import </span><span style=color:#183691>"forge-std/Script.sol"</span><span>;
</span><span style=color:#a71d5d;font-weight:700>import </span><span>{console} </span><span style=color:#a71d5d;font-weight:700>from </span><span style=color:#183691>"forge-std/console.sol"</span><span>;
</span><span>
</span><span>contract OpenScript is Script {
</span><span>    </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>setUp</span><span>() </span><span style=color:#795da3;font-weight:700>public </span><span>{}
</span><span>
</span><span>    </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>run</span><span>() </span><span style=color:#795da3;font-weight:700>public </span><span>{
</span><span>        vm.</span><span style=color:#795da3;font-weight:700>startBroadcast</span><span>();
</span><span>        </span><span style=color:#795da3;font-weight:700>solveOpen</span><span>();
</span><span>        vm.</span><span style=color:#795da3;font-weight:700>stopBroadcast</span><span>();
</span><span>    }
</span><span>    </span><span style=color:#a71d5d;font-weight:700>function </span><span style=color:#795da3;font-weight:700>solveOpen</span><span>() </span><span style=color:#795da3;font-weight:700>public </span><span>{
</span><span>        address target </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>0x35388184260d8A3cE75B5df5bbA1904b68746b27</span><span>;
</span><span>        (bool success, bytes memory _data) </span><span style=color:#a71d5d;font-weight:700>= </span><span>target.</span><span style=color:#62a35c>call</span><span>(abi.</span><span style=color:#795da3;font-weight:700>encodeWithSignature</span><span>(</span><span style=color:#183691>"givemetheflag(string)"</span><span>,</span><span style=color:#183691>"ODM1.pHrlmtdBQY9UIYaE-WVDGTPOWP0"</span><span>));
</span><span>        </span><span style=color:#62a35c>require</span><span>(success);
</span><span>        </span><span style=color:#0086b3>console</span><span>.</span><span style=color:#795da3;font-weight:700>logBytes</span><span>(_data);
</span><span>    }
</span><span>}
</span></code></pre><p>To run the script :<pre class=language-bash data-lang=bash style=color:#323232;background-color:#fff><code class=language-bash data-lang=bash><span>mj0ln1r@AHLinux:~/$ forge script scripts/SolveOpen.s.sol --rpc-url </span><span style=color:#a71d5d;font-weight:700>&lt;</span><span>REDACTED</span><span style=color:#a71d5d;font-weight:700>> </span><span>--private-key </span><span style=color:#a71d5d;font-weight:700>&lt;</span><span>REDACTED</span><span style=color:#a71d5d;font-weight:700>> </span><span>--broadcast
</span></code></pre><p>Flag will be automatically submitted once we run this script.<h2 id=ether-footprint-500pts>Ether Footprint [500pts]</h2><p>Challenge provided with a contract address. And description says observe the ether dance.<p><strong>Contract : 0x24D1a591b816C175eBF4cD62277ecCcdA42d1211</strong><p>When I look the transactions to the given contract on goerli etherscan, there are 37 transactions available. I observed that the eth value in every transaction was different. I saw in the challenge tag something like <code>9856855-9856895</code>. These two numbers are block numbers of the starting trransaction and last block number of the transaction to this contract.<p>Look here to observe : <a heref="https://goerli.etherscan.io/txs?a=0x24D1a591b816C175eBF4cD62277ecCcdA42d1211" target=_blank>Goerli Etherscan</a><p>So, I used <code>web3.py</code> to list all the transaction to the target contract between these two block numbers. I fetched the value of each transaction in wei. I observed the <code>0,1 indexes</code> of the wei string represents the index of the character. And <code>4,5,6</code> indexes are the ascii values of the flag.<p>I wrote this <code>web3.py</code> script which solves challenge and prints flag for us.<p><code>Solve.py</code><pre class=language-python data-lang=python style=color:#323232;background-color:#fff><code class=language-python data-lang=python><span style=color:#a71d5d;font-weight:700>from </span><span>decimal </span><span style=color:#a71d5d;font-weight:700>import </span><span>Decimal
</span><span style=color:#a71d5d;font-weight:700>from </span><span>web3 </span><span style=color:#a71d5d;font-weight:700>import </span><span style=color:#0086b3>*
</span><span style=color:#0086b3>START_BLOCK </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>9856855
</span><span style=color:#0086b3>END_BLOCK </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>9856895
</span><span>
</span><span style=color:#0086b3>RPC_URL </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#183691>"https://eth-goerli.g.alchemy.com/v2/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
</span><span style=color:#a71d5d;font-weight:700>def </span><span style=color:#323232;font-weight:700>main</span><span>():
</span><span>  values </span><span style=color:#a71d5d;font-weight:700>= </span><span>[]
</span><span>  w3 </span><span style=color:#a71d5d;font-weight:700>= </span><span>Web3(Web3.HTTPProvider(</span><span style=color:#0086b3>RPC_URL</span><span>))
</span><span>  </span><span style=color:#a71d5d;font-weight:700>for </span><span>_block </span><span style=color:#a71d5d;font-weight:700>in </span><span style=color:#62a35c>range</span><span>(</span><span style=color:#0086b3>START_BLOCK</span><span style=color:#a71d5d;font-weight:700>+</span><span style=color:#0086b3>1</span><span>, </span><span style=color:#0086b3>END_BLOCK</span><span>):
</span><span>    block </span><span style=color:#a71d5d;font-weight:700>= </span><span>w3.eth.get_block(_block, full_transactions</span><span style=color:#a71d5d;font-weight:700>=</span><span style=color:#0086b3>True</span><span>)
</span><span>    </span><span style=color:#a71d5d;font-weight:700>for </span><span>transaction </span><span style=color:#a71d5d;font-weight:700>in </span><span>block.transactions:
</span><span>      </span><span style=color:#a71d5d;font-weight:700>if </span><span>transaction[</span><span style=color:#183691>"to"</span><span>] </span><span style=color:#a71d5d;font-weight:700>== </span><span style=color:#183691>"0x24D1a591b816C175eBF4cD62277ecCcdA42d1211"</span><span>:
</span><span>        </span><span style=color:#62a35c>print</span><span>(_block,transaction[</span><span style=color:#183691>"value"</span><span>])
</span><span>        values.append(transaction[</span><span style=color:#183691>"value"</span><span>])
</span><span>  d </span><span style=color:#a71d5d;font-weight:700>= </span><span>{}
</span><span>  </span><span style=color:#a71d5d;font-weight:700>for </span><span>i </span><span style=color:#a71d5d;font-weight:700>in </span><span>values:
</span><span>    string </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#0086b3>str</span><span>(i)
</span><span>    </span><span style=color:#a71d5d;font-weight:700>if</span><span>(</span><span style=color:#62a35c>len</span><span>(string) </span><span style=color:#a71d5d;font-weight:700>!= </span><span style=color:#0086b3>15</span><span>):
</span><span>      string </span><span style=color:#a71d5d;font-weight:700>= </span><span>((</span><span style=color:#0086b3>15 </span><span style=color:#a71d5d;font-weight:700>- </span><span style=color:#62a35c>len</span><span>(string)) </span><span style=color:#a71d5d;font-weight:700>* </span><span style=color:#183691>"0"</span><span>) </span><span style=color:#a71d5d;font-weight:700>+ </span><span>string </span><span style=color:#a71d5d;font-weight:700>+ </span><span style=color:#183691>"x"</span><span style=color:#969896;font-style:italic># extra x to identify padded str
</span><span>    </span><span style=color:#a71d5d;font-weight:700>if</span><span>(string[</span><span style=color:#a71d5d;font-weight:700>-</span><span style=color:#0086b3>1</span><span>] </span><span style=color:#a71d5d;font-weight:700>== </span><span style=color:#183691>"x"</span><span>):
</span><span>      d[</span><span style=color:#0086b3>int</span><span>(string[</span><span style=color:#0086b3>0</span><span>:</span><span style=color:#0086b3>2</span><span>])] </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#62a35c>chr</span><span>(</span><span style=color:#0086b3>int</span><span>(string[</span><span style=color:#0086b3>4</span><span>:</span><span style=color:#0086b3>7</span><span>]))
</span><span>    </span><span style=color:#a71d5d;font-weight:700>else</span><span>:
</span><span>      d[</span><span style=color:#0086b3>int</span><span>(string[</span><span style=color:#0086b3>0</span><span>:</span><span style=color:#0086b3>2</span><span>])] </span><span style=color:#a71d5d;font-weight:700>= </span><span style=color:#62a35c>chr</span><span>(</span><span style=color:#0086b3>int</span><span>(string[</span><span style=color:#0086b3>4</span><span>:</span><span style=color:#0086b3>7</span><span>]))
</span><span>  </span><span style=color:#a71d5d;font-weight:700>for </span><span>i </span><span style=color:#a71d5d;font-weight:700>in </span><span style=color:#62a35c>range</span><span>(</span><span style=color:#0086b3>37</span><span>):
</span><span>    </span><span style=color:#62a35c>print</span><span>(d[i],end</span><span style=color:#a71d5d;font-weight:700>=</span><span style=color:#183691>""</span><span>)
</span><span>
</span><span>
</span><span>
</span><span style=color:#a71d5d;font-weight:700>if </span><span>__name__ </span><span style=color:#a71d5d;font-weight:700>== </span><span style=color:#183691>"__main__"</span><span>:
</span><span>  main()
</span><span>
</span><span style=color:#969896;font-style:italic># Output
</span><span>
</span><span style=color:#969896;font-style:italic># flag{Gg_g00d_j0b_3th3r3um_1s_4w3s0m3}
</span><span>
</span></code></pre><p>Yeah Ethereum is awesome...</section></article></main></div>