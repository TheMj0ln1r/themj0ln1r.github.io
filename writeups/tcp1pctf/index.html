<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         TCP1P CTF 2023
        
    </title><meta content="TCP1P CTF 2023" property=og:title><meta content="Known as TheMj0ln1r" property=og:description><meta content="Known as TheMj0ln1r" name=description><link href=/favicons/favicon.ico rel=icon type=image/png><link href=https://themj0ln1r.github.io/fonts.css rel=stylesheet><script src=https://themj0ln1r.github.io/js/codeblock.js></script><script src=https://themj0ln1r.github.io/js/toc.js></script><script src=https://themj0ln1r.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Charan Nomula" href=https://themj0ln1r.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://themj0ln1r.github.io/theme/light.css rel=stylesheet><link href=https://themj0ln1r.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://themj0ln1r.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://themj0ln1r.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://themj0ln1r.github.io/>Charan Nomula</a><div class=socials><a class=social href=https://x.com/TheMj0ln1r/ rel=me target=_blank> <img alt=twitter src=https://themj0ln1r.github.io/social_icons/twitter.svg> </a><a class=social href=https://linkedin.com/in/mj0ln1r/ rel=me target=_blank> <img alt=linkedin src=https://themj0ln1r.github.io/social_icons/linkedin.svg> </a><a class=social href=https://github.com/TheMj0ln1r/ rel=me target=_blank> <img alt=github src=https://themj0ln1r.github.io/social_icons/github.svg> </a><a href="mailto: playermj0ln1r@gmail.com" class=social rel=me target=_blank> <img alt=Email src=https://themj0ln1r.github.io/social_icons/email.svg> </a></div></div><nav><a href=https://themj0ln1r.github.io/posts style=margin-left:.5em>/posts</a><a href=https://themj0ln1r.github.io/writeups style=margin-left:.5em>/writeups</a><a href=https://themj0ln1r.github.io/projects style=margin-left:.5em>/projects</a><a href=https://themj0ln1r.github.io/contact style=margin-left:.5em>/contact</a><a href=https://themj0ln1r.github.io/tags style=margin-left:.5em>/tags</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://themj0ln1r.github.io/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://themj0ln1r.github.io/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>TCP1P CTF 2023<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2023-10-16</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://themj0ln1r.github.io/tags/ctf/>ctf</a>, <a class=post-tag href=https://themj0ln1r.github.io/tags/blockchain/>blockchain</a> </span></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://themj0ln1r.github.io/writeups/tcp1pctf/#blockchain>Blockchain</a><li><a href=https://themj0ln1r.github.io/writeups/tcp1pctf/#venue>Venue</a><li><a href=https://themj0ln1r.github.io/writeups/tcp1pctf/#location>Location</a><li><a href=https://themj0ln1r.github.io/writeups/tcp1pctf/#invitation>Invitation</a><li><a href=https://themj0ln1r.github.io/writeups/tcp1pctf/#vip>VIP</a> <ul><li><a href=https://themj0ln1r.github.io/writeups/tcp1pctf/#quick-way-to-solve>Quick way to Solve</a><li><a href=https://themj0ln1r.github.io/writeups/tcp1pctf/#references>References</a></ul></ul></div><section class=body><p>Hello readers, I played TCP1P CTF alone (but not anymore). I am focused on blockchain challenges only this time and I managed to solved <strong><code>All</code></strong> blockchain challenges within few hours of CTF. I got many new friends and like minded people in during this CTF. I am excited to share those challenge writeups here.</p><img class=autoimg src=/assets/img/ctf_img/tcp1p23/tcp1pctf23_progress.png><h1 id=blockchain><a aria-label="Anchor link for: blockchain" class=zola-anchor href=#blockchain>Blockchain</a></h1><h1 id=venue><a aria-label="Anchor link for: venue" class=zola-anchor href=#venue>Venue</a></h1><p><strong>Description :</strong><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Look at the Amazing Party Venue So do you wish to enter?
</span><span>contract: 0x1AC90AFd478F30f2D617b3Cb76ee00Dd73A9E4d3
</span><span>provider: https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
</span><span>Priv-Key: Please use your own private-key, if you need ETH for transact, You can either DM the Author, or get it by yourself at https://sepoliafaucet.com/
</span><span>
</span><span>Attached Files : [Venue.sol, 101.txt]
</span><span>
</span></code></pre><p>It is just a warmup challenge, can be simply done by loading contract on remix, but I wrote a simple <code>ethersJS</code> script to interact with the contract.<p><code>101.txt</code><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Feeling Confuse?
</span><span>
</span><span>Here's how you can attempt this challenge
</span><span>First thing first you need to know what the code does,
</span><span>then you need to write a code using web3.js or web3.py
</span></code></pre><p>Okay lets see how the contract looks like,<p><code>Venue.sol</code><pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span style=color:#abb0b6;font-style:italic>// SPDX-License-Identifier: MIT
</span><span>pragma solidity </span><span style=color:#ed9366>^</span><span style=color:#ff8f40>0.8</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>13</span><span style=color:#61676ccc>;
</span><span>
</span><span>contract Venue{
</span><span>    string private flag</span><span style=color:#61676ccc>;
</span><span>    string private message</span><span style=color:#61676ccc>;
</span><span>
</span><span>    </span><span style=color:#f29718>constructor</span><span>(string memory initialFlag</span><span style=color:#61676ccc>, </span><span>string memory initialMessage){
</span><span>        flag </span><span style=color:#ed9366>= </span><span>initialFlag</span><span style=color:#61676ccc>;
</span><span>        message </span><span style=color:#ed9366>= </span><span>initialMessage</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>enterVenue</span><span>() </span><span style=color:#f29718>public view returns</span><span>(</span><span style=color:#ff8f40>string memory</span><span>){
</span><span>        </span><span style=color:#fa6e32>return </span><span>flag</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>goBack</span><span>() </span><span style=color:#f29718>public view returns</span><span>(</span><span style=color:#ff8f40>string memory</span><span>){
</span><span>        </span><span style=color:#fa6e32>return </span><span>message</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span></code></pre><p>Okay, what we have to do here is to call the <code>enterVenue()</code> function which will return the flag for us.<p>To interact with a contract on blockchain we need few things.<pre style=color:#61676c;background-color:#fafafa><code><span>- Contract ABI
</span><span>- Contract Address
</span><span>- RPC URI
</span><span>- Few Test ETH
</span></code></pre><p>✅ We can get Test ETH from faucets<p>✅ RPC URI is provided<p>✅ Contract Address is available<p>Now lets get the ABI using <code>solc</code> compiler. We can get ABI using <code>Remix</code> too, but do it in command line.<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/venue$</span><span> solc Venue.sol</span><span style=color:#ff8f40> --combined-json</span><span> abi
</span><span style=color:#f29718>{</span><span style=color:#86b300>"contracts"</span><span style=color:#f29718>:{</span><span style=color:#86b300>"Venue.sol:Venue"</span><span style=color:#f29718>:{</span><span style=color:#86b300>"abi"</span><span style=color:#f29718>:[{</span><span style=color:#86b300>"inputs"</span><span style=color:#f29718>:[{</span><span style=color:#86b300>"internalType"</span><span style=color:#f29718>:</span><span style=color:#86b300>"string"</span><span style=color:#f29718>,</span><span style=color:#86b300>"name"</span><span style=color:#f29718>:</span><span style=color:#86b300>"initialFlag"</span><span style=color:#f29718>,</span><span style=color:#86b300>"type"</span><span style=color:#f29718>:</span><span style=color:#86b300>"string"</span><span>}</span><span style=color:#f29718>,{</span><span style=color:#86b300>"internalType"</span><span style=color:#f29718>:</span><span style=color:#86b300>"string"</span><span style=color:#f29718>,</span><span style=color:#86b300>"name"</span><span style=color:#f29718>:</span><span style=color:#86b300>"initialMessage"</span><span style=color:#f29718>,</span><span style=color:#86b300>"type"</span><span style=color:#f29718>:</span><span style=color:#86b300>"string"</span><span>}</span><span style=color:#f29718>],</span><span style=color:#86b300>"stateMutability"</span><span style=color:#f29718>:</span><span style=color:#86b300>"nonpayable"</span><span style=color:#f29718>,</span><span style=color:#86b300>"type"</span><span style=color:#f29718>:</span><span style=color:#86b300>"constructor"</span><span>}</span><span style=color:#f29718>,{</span><span style=color:#86b300>"inputs"</span><span style=color:#f29718>:[],</span><span style=color:#86b300>"name"</span><span style=color:#f29718>:</span><span style=color:#86b300>"enterVenue"</span><span style=color:#f29718>,</span><span style=color:#86b300>"outputs"</span><span style=color:#f29718>:[{</span><span style=color:#86b300>"internalType"</span><span style=color:#f29718>:</span><span style=color:#86b300>"string"</span><span style=color:#f29718>,</span><span style=color:#86b300>"name"</span><span style=color:#f29718>:</span><span style=color:#86b300>""</span><span style=color:#f29718>,</span><span style=color:#86b300>"type"</span><span style=color:#f29718>:</span><span style=color:#86b300>"string"</span><span>}</span><span style=color:#f29718>],</span><span style=color:#86b300>"stateMutability"</span><span style=color:#f29718>:</span><span style=color:#86b300>"view"</span><span style=color:#f29718>,</span><span style=color:#86b300>"type"</span><span style=color:#f29718>:</span><span style=color:#86b300>"function"</span><span>}</span><span style=color:#f29718>,{</span><span style=color:#86b300>"inputs"</span><span style=color:#f29718>:[],</span><span style=color:#86b300>"name"</span><span style=color:#f29718>:</span><span style=color:#86b300>"goBack"</span><span style=color:#f29718>,</span><span style=color:#86b300>"outputs"</span><span style=color:#f29718>:[{</span><span style=color:#86b300>"internalType"</span><span style=color:#f29718>:</span><span style=color:#86b300>"string"</span><span style=color:#f29718>,</span><span style=color:#86b300>"name"</span><span style=color:#f29718>:</span><span style=color:#86b300>""</span><span style=color:#f29718>,</span><span style=color:#86b300>"type"</span><span style=color:#f29718>:</span><span style=color:#86b300>"string"</span><span>}</span><span style=color:#f29718>],</span><span style=color:#86b300>"stateMutability"</span><span style=color:#f29718>:</span><span style=color:#86b300>"view"</span><span style=color:#f29718>,</span><span style=color:#86b300>"type"</span><span style=color:#f29718>:</span><span style=color:#86b300>"function"</span><span>}</span><span style=color:#f29718>]</span><span>}}</span><span style=color:#f29718>,</span><span style=color:#86b300>"version"</span><span style=color:#f29718>:</span><span style=color:#86b300>"0.8.21+commit.d9974bed.Linux.g++"</span><span>}
</span></code></pre><p>✅ We got ABI too<p>Lets write a simple <code>Ethers JS</code> script to interact with our contract.<pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span style=color:#f07171>require</span><span>(</span><span style=color:#86b300>'dotenv'</span><span>)</span><span style=color:#ed9366>.</span><span style=color:#f29718>config</span><span>()</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>const </span><span>ethers </span><span style=color:#ed9366>= </span><span style=color:#f07171>require</span><span>(</span><span style=color:#86b300>'ethers'</span><span>)</span><span style=color:#61676ccc>;
</span><span>
</span><span>ADDRESS </span><span style=color:#ed9366>= </span><span style=color:#86b300>'0x1AC90AFd478F30f2D617b3Cb76ee00Dd73A9E4d3'
</span><span>ABI </span><span style=color:#ed9366>= </span><span>[{</span><span style=color:#86b300>"inputs"</span><span style=color:#61676ccc>:</span><span>[{</span><span style=color:#86b300>"internalType"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"string"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"name"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"initialFlag"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"type"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"string"</span><span>}</span><span style=color:#61676ccc>,</span><span>{</span><span style=color:#86b300>"internalType"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"string"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"name"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"initialMessage"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"type"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"string"</span><span>}]</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"stateMutability"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"nonpayable"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"type"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"constructor"</span><span>}</span><span style=color:#61676ccc>,</span><span>{</span><span style=color:#86b300>"inputs"</span><span style=color:#61676ccc>:</span><span>[]</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"name"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"enterVenue"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"outputs"</span><span style=color:#61676ccc>:</span><span>[{</span><span style=color:#86b300>"internalType"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"string"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"name"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>""</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"type"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"string"</span><span>}]</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"stateMutability"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"view"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"type"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"function"</span><span>}</span><span style=color:#61676ccc>,</span><span>{</span><span style=color:#86b300>"inputs"</span><span style=color:#61676ccc>:</span><span>[]</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"name"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"goBack"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"outputs"</span><span style=color:#61676ccc>:</span><span>[{</span><span style=color:#86b300>"internalType"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"string"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"name"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>""</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"type"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"string"</span><span>}]</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"stateMutability"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"view"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"type"</span><span style=color:#61676ccc>:</span><span style=color:#86b300>"function"</span><span>}]
</span><span style=color:#abb0b6;font-style:italic>// provider
</span><span style=color:#fa6e32>const </span><span>provider </span><span style=color:#ed9366>= new </span><span style=color:#399ee6>ethers</span><span style=color:#ed9366>.</span><span style=color:#399ee6>AlchemyProvider</span><span>(</span><span style=color:#86b300>'sepolia'</span><span style=color:#61676ccc>, </span><span>process</span><span style=color:#ed9366>.</span><span>env</span><span style=color:#ed9366>.</span><span>API_KEY)</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>const </span><span>wallet </span><span style=color:#ed9366>= new </span><span style=color:#399ee6>ethers</span><span style=color:#ed9366>.</span><span style=color:#399ee6>Wallet</span><span>(process</span><span style=color:#ed9366>.</span><span>env</span><span style=color:#ed9366>.</span><span>PRIVATE_KEY</span><span style=color:#61676ccc>, </span><span>provider)</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>async function </span><span style=color:#f29718>main</span><span>(){
</span><span>    </span><span style=color:#fa6e32>const </span><span>venueContract </span><span style=color:#ed9366>= new </span><span style=color:#399ee6>ethers</span><span style=color:#ed9366>.</span><span style=color:#399ee6>Contract</span><span>(ADDRESS</span><span style=color:#61676ccc>, </span><span>ABI</span><span style=color:#61676ccc>, </span><span>wallet)
</span><span>    </span><span style=color:#fa6e32>const </span><span>message </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>await </span><span>venueContract</span><span style=color:#ed9366>.</span><span style=color:#f29718>goBack</span><span>()</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#55b4d4;font-style:italic>console</span><span style=color:#ed9366>.</span><span style=color:#f07171>log</span><span>(message)</span><span style=color:#61676ccc>;
</span><span>    </span><span style=color:#fa6e32>const </span><span>flag </span><span style=color:#ed9366>= </span><span style=color:#fa6e32>await </span><span>venueContract</span><span style=color:#ed9366>.</span><span style=color:#f29718>enterVenue</span><span>()</span><span style=color:#61676ccc>; 
</span><span>    </span><span style=color:#55b4d4;font-style:italic>console</span><span style=color:#ed9366>.</span><span style=color:#f07171>log</span><span>(flag)</span><span style=color:#61676ccc>;
</span><span>}
</span><span style=color:#f29718>main</span><span>()
</span></code></pre><p>To make this script works you need to do few things.<ul><li>Install Dependencies</ul><p><code>npm install --save ethers && npm install dotenv</code><ul><li>Make sure to use .env</ul><p>sample <code>.env</code><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>PRIVATE_KEY=853024a95f52d73fe68a50e4ee11a1a2a6818ef71b63eccea9c07edde5e595c
</span><span>API_KEY=SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
</span></code></pre><p>Now if we run the javascript code above then the flag will be printed to the screen.<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/venue$</span><span> node solve.js
</span><span style=color:#f29718>But....</span><span> You</span><span style=color:#86b300>'ve come this far... come on! just go inside!
</span><span style=color:#86b300>TCP1P{d0_3nj0y_th3_p4rty_bu7_4r3_y0u_4_VIP?}
</span></code></pre><blockquote><p><code>Flag : TCP1P{d0_3nj0y_th3_p4rty_bu7_4r3_y0u_4_VIP?}</code></blockquote><h1 id=location><a aria-label="Anchor link for: location" class=zola-anchor href=#location>Location</a></h1><p><strong>Description :</strong><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Will you accept the invitation? If so, find the party location now!
</span><span>
</span><span>Challenge : nc ctf.tcp1p.com 20005
</span></code></pre><p>Lets connect to challenge<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/venue$</span><span> nc ctf.tcp1p.com 20005
</span><span style=color:#ed9366>=</span><span style=color:#86b300>===Going </span><span style=color:#f29718>to</span><span> The Party====
</span><span>
</span><span style=color:#f29718>To</span><span> Find the party location
</span><span style=color:#f29718>You</span><span> need to solve a simple riddle regarding a SLOT
</span><span style=color:#f29718>Answer</span><span> everything correctly, and find the exact location!
</span><span>
</span><span style=color:#f29718>Question:</span><span> In which Slot is Password Stored</span><span style=color:#ed9366>?
</span><span>
</span><span style=color:#f29718>You</span><span style=color:#86b300>'ll answer with and ONLY WITH [numbers]
</span><span style=color:#86b300>ex: 
</span><span style=color:#86b300>0,1,2,3,4.....99
</span><span style=color:#86b300>
</span><span style=color:#86b300>Note: 
</span><span style=color:#86b300>    -   Slot start from 0
</span><span style=color:#86b300>    -   If it doesn'</span><span style=color:#f29718>t</span><span> stored on SLOT, answer 0
</span><span>
</span><span style=color:#f29718>Identification</span><span> Required for Guest
</span><span>
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge2 {
</span><span>    address</span><span style=color:#fa6e32>[</span><span>2</span><span style=color:#fa6e32>]</span><span> private investor;
</span><span>    uint64 private password;
</span><span>    bytes32 private user;
</span><span>    address private owner;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer: 
</span></code></pre><p>Lets understood challenge clearly<ul><li>It is EVM storage puzzle<li>We have to find the storage slot of the password<li>Slots starts from 0<li>If password not stored on storage then answer will be 0</ul><p>So, Lets learn EVM storage layout<p>State variables of contracts are stored in storage in a compact way such that multiple values sometimes use the same storage slot. Except for dynamically-sized arrays and mappings (see below), data is stored contiguously item after item starting with the first state variable, which is stored in slot 0.<p>The below image will illustrate the storage layout of the EVM.</p><img class=autoimg src=/assets/img/ctf_img/tcp1p23/tcp1pctf23_location1.png><p>State variable stored in the continous manner in storage slots of EVM. Each slot of size 32 bytes or 256 bits only. See an example how the state variables are stores in the storage slots.<pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span>Contract MyContract {
</span><span>  uint256 zero</span><span style=color:#61676ccc>;                          </span><span style=color:#abb0b6;font-style:italic>// in slot 0
</span><span>  </span><span style=color:#f29718>mapping</span><span>(</span><span style=color:#ff8f40>address </span><span style=color:#fa6e32>=> </span><span>uint256) one</span><span style=color:#61676ccc>;    </span><span style=color:#abb0b6;font-style:italic>// in slot 1
</span><span>  address two</span><span style=color:#61676ccc>;                          </span><span style=color:#abb0b6;font-style:italic>// in slot 2 
</span><span>  bool a</span><span style=color:#61676ccc>;                              </span><span style=color:#abb0b6;font-style:italic>// in slot 3 - 1 byte
</span><span>  uint8 b</span><span style=color:#61676ccc>;                             </span><span style=color:#abb0b6;font-style:italic>// in slot 3 - 1 byte 
</span><span>  bytes16 c</span><span style=color:#61676ccc>;                           </span><span style=color:#abb0b6;font-style:italic>// in slot 3 - 16 bytes
</span><span>  address immutable noWhere</span><span style=color:#61676ccc>;           </span><span style=color:#abb0b6;font-style:italic>// Do not stored on storage
</span><span>}
</span></code></pre><p>The Solidity dont store constant or immutable variables in storage instead the vaues will replaced in every occurrence of these variables with their assigned value in the contract’s bytecode.<blockquote><p><strong>Enough knowedge for the challenge, Lets solve challenge.</strong></blockquote><p>Here in Challenge2 the password is stored in slot 2 as address[2] will reserve slot 0 and slot 1 for two addresses. Slot 2 will be allocated to password.<pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span>contract StorageChallenge2 {
</span><span>    address[</span><span style=color:#ff8f40>2</span><span>] private investor</span><span style=color:#61676ccc>; </span><span style=color:#abb0b6;font-style:italic>// slot 0 - 1
</span><span>    uint64 private password</span><span style=color:#61676ccc>;  </span><span style=color:#abb0b6;font-style:italic>// slot 2
</span><span>    bytes32 private user</span><span style=color:#61676ccc>;  </span><span style=color:#abb0b6;font-style:italic>// slot 3
</span><span>    address private owner</span><span style=color:#61676ccc>;  </span><span style=color:#abb0b6;font-style:italic>// slot 4
</span><span>}
</span></code></pre><p>Lets see Challenge7, Here the password declared as <code>immutable</code> so it wont stored in any slot so the answer would be 0.<pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span>contract StorageChallenge7 {
</span><span>    bytes32 private key</span><span style=color:#61676ccc>;
</span><span>    bytes4 private key_1</span><span style=color:#61676ccc>;
</span><span>    bytes16 private key_2</span><span style=color:#61676ccc>;
</span><span>    address private owner</span><span style=color:#61676ccc>;
</span><span>    uint256 private Token</span><span style=color:#61676ccc>;
</span><span>    address private immutable Investor</span><span style=color:#61676ccc>;
</span><span>    address private Courier</span><span style=color:#61676ccc>;
</span><span>    bytes32 private immuatble password</span><span style=color:#61676ccc>;  </span><span style=color:#abb0b6;font-style:italic>// no slot for password 
</span><span>}
</span></code></pre><p>Similiarly calculated storage slots for all the 10 challenges manually.<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/location$</span><span> nc ctf.tcp1p.com 20005
</span><span style=color:#ed9366>=</span><span style=color:#86b300>===Going </span><span style=color:#f29718>to</span><span> The Party====
</span><span>
</span><span style=color:#f29718>To</span><span> Find the party location
</span><span style=color:#f29718>You</span><span> need to solve a simple riddle regarding a SLOT
</span><span style=color:#f29718>Answer</span><span> everything correctly, and find the exact location!
</span><span>
</span><span style=color:#f29718>Question:</span><span> In which Slot is Password Stored</span><span style=color:#ed9366>?
</span><span>
</span><span style=color:#f29718>You</span><span style=color:#86b300>'ll answer with and ONLY WITH [numbers]
</span><span style=color:#86b300>ex: 
</span><span style=color:#86b300>0,1,2,3,4.....99
</span><span style=color:#86b300>
</span><span style=color:#86b300>Note: 
</span><span style=color:#86b300>    -   Slot start from 0
</span><span style=color:#86b300>    -   If it doesn'</span><span style=color:#f29718>t</span><span> stored on SLOT, answer 0
</span><span>
</span><span style=color:#f29718>Identification</span><span> Required for Guest
</span><span>
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge7 {
</span><span>    bytes32 private key;
</span><span>    bytes4 private key_1;
</span><span>    bytes16 private key_2;
</span><span>    address private owner;
</span><span>    uint256 private Token;
</span><span>    address private immutable Investor;
</span><span>    address private Courier;
</span><span>    bytes32 private immuatble password;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 0
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge1 {
</span><span>    bytes32 private user;
</span><span>    address</span><span style=color:#fa6e32>[</span><span>2</span><span style=color:#fa6e32>]</span><span> private investor;
</span><span>    uint64 private password;
</span><span>    address private owner;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 3
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge8 {
</span><span>    bytes32 private key;
</span><span>    bytes4 private key_1;
</span><span>    bytes16 private key_2;
</span><span>    address private owner;
</span><span>    uint256 private Token;
</span><span>    address private immutable Investor;
</span><span>    address private Courier;
</span><span>    uint256 private lump_sum;
</span><span>    bytes32 private password;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 6
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge4 {
</span><span>    uint64 private password;
</span><span>    bytes32 private user;
</span><span>    address</span><span style=color:#fa6e32>[</span><span>2</span><span style=color:#fa6e32>]</span><span> private investor;
</span><span>    bytes32 immutable  passphrase
</span><span>    address private owner;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 0
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge10 {
</span><span>    bool private string_true;
</span><span>    bool private number_false;
</span><span>    bool private user_true;
</span><span>    bytes32 private username;
</span><span>    bytes32 private password;
</span><span>    bool public status_creds;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 2
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge3 {
</span><span>    address private owner;
</span><span>    uint64 private password;
</span><span>    bytes32 private user;
</span><span>    address</span><span style=color:#fa6e32>[</span><span>2</span><span style=color:#fa6e32>]</span><span> private investor;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 0
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge2 {
</span><span>    address</span><span style=color:#fa6e32>[</span><span>2</span><span style=color:#fa6e32>]</span><span> private investor;
</span><span>    uint64 private password;
</span><span>    bytes32 private user;
</span><span>    address private owner;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 2
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge9 {
</span><span>    bytes32 private unique_code;
</span><span>    bytes32 private 12_key;
</span><span>    address private owner;
</span><span>    address</span><span style=color:#fa6e32>[</span><span>20</span><span style=color:#fa6e32>]</span><span> public player;
</span><span>    bool private valid;
</span><span>    bytes32 private password;
</span><span>    address private enemy;
</span><span>    bool private answered;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 24
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge5 {
</span><span>    address</span><span style=color:#fa6e32>[</span><span>2</span><span style=color:#fa6e32>]</span><span> private investor;
</span><span>    bytes32 private user;
</span><span>    address private owner;
</span><span>    uint64 private password;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 3
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> StorageChallenge6 {
</span><span>    bytes32 immutable passphrase;
</span><span>    uint64 private password;
</span><span>    bytes32 private user;
</span><span>    address</span><span style=color:#fa6e32>[</span><span>2</span><span style=color:#fa6e32>]</span><span> private investor;
</span><span>    address private owner;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 0
</span><span style=color:#ed9366>=</span><span style=color:#86b300>==================================
</span><span style=color:#f29718>Final</span><span> Question:
</span><span>
</span><span style=color:#f29718>contract</span><span> Hell_0 {
</span><span>    uint256 private avail_money;
</span><span>    uint256 private saved_money;
</span><span>    bool private not_minus;
</span><span>    address private owner;
</span><span>    uint256</span><span style=color:#fa6e32>[</span><span>2</span><span style=color:#fa6e32>]</span><span> private geo_loc;
</span><span>    bool private is_there;
</span><span>    bool private there;
</span><span>    address private wallet;
</span><span>    address private receiver;
</span><span>    address</span><span style=color:#fa6e32>[</span><span>20</span><span style=color:#fa6e32>]</span><span> private transaction_list;
</span><span>    bytes32 private user_creds;
</span><span>    uint256 private immutable user_in_uint;
</span><span>    bytes32 private password;
</span><span>    uint256 private password_uint;
</span><span>    bool private correct_password;
</span><span>    bool private is_user;
</span><span>}
</span><span>
</span><span style=color:#f29718>Answer:</span><span> 28
</span><span style=color:#f29718>Go</span><span> to Camelleion Street 78
</span><span style=color:#f29718>TCP1P{W00t_w00t_t0_th3_p4rty_47JHbddc</span><span>}
</span><span>
</span></code></pre><p>We can calculate the storage slots from remix too. Compile each contract on Remix and go to compilation details and view <code>STORAGELAYOUT</code>.</p><img class=autoimg src=/assets/img/ctf_img/tcp1p23/tcp1pctf23_location2.png><blockquote><p><code>Flag : TCP1P{W00t_w00t_t0_th3_p4rty_47JHbddc}</code></blockquote><h1 id=invitation><a aria-label="Anchor link for: invitation" class=zola-anchor href=#invitation>Invitation</a></h1><p><strong>Description :</strong><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>An Invitation to an amazing party, only if you find the right location.
</span><span>
</span><span>Note: Please read the 101.txt.
</span><span>Attached Files : [Invitation.txt, 101.txt]
</span><span>
</span></code></pre><p><code>101.txt</code><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Description:
</span><span>    You are provided a bytecode there, yeah?
</span><span>    Find out a way to get a certain function name from it,
</span><span>    the correct function name begin with "TCP1P" string.
</span><span>
</span><span>Flag Format
</span><span>    if you manage to find the correct function name
</span><span>    do the exact same thing as the example below
</span><span>    
</span><span>    Found Function name: TCP1P_th1s_1s_4_fl4g_()
</span><span>        -> remove the "()"
</span><span>        -> replace the first "_" with "{"
</span><span>        -> replace the last "_" with "}"
</span><span>    
</span><span>    Final and Right flag format: TCP1P{th1s_1s_4_fl4g}
</span></code></pre><p><code>Invitation.txt</code><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>60806040526040518060400160405280601e81526020017f546865207269676874206f6e652068617320544350315020737472696e670000815250600090816200004a919062000483565b506040518060400160405280600681526020017f6e6f74206d6500000000000000000000000000000000000000000000000000008152506001908162000091919062000483565b506040518060400160405280601b81526020017f46756e6374696f6e2064623f206e6576657220686561726420656d000000000081525060029081620000d8919062000483565b506040518060400160405280601e81526020017f49742773206e6f7420746865207269676874207468696e67206e6f2e2e2e0000815250600390816200011f919062000483565b506040518060400160405280601081526020017f4841484148414841204e4f54204d4521000000000000000000000000000000008152506004908162000166919062000483565b506040518060400160405280601b81526020017f505553482050555348205055534821212120574841543f20343f20000000000081525060059081620001ad919062000483565b506040518060400160405280601881526020017f54686520342062797465732c206974277320666973687921000000000000000081525060069081620001f4919062000483565b503480156200020257600080fd5b506200056a565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806200028b57607f821691505b602082108103620002a157620002a062000243565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026200030b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82620002cc565b620003178683620002cc565b95508019841693508086168417925050509392505050565b6000819050919050565b6000819050919050565b6000620003646200035e62000358846200032f565b62000339565b6200032f565b9050919050565b6000819050919050565b620003808362000343565b620003986200038f826200036b565b848454620002d9565b825550505050565b600090565b620003af620003a0565b620003bc81848462000375565b505050565b5b81811015620003e457620003d8600082620003a5565b600181019050620003c2565b5050565b601f8211156200043357620003fd81620002a7565b6200040884620002bc565b8101602085101562000418578190505b620004306200042785620002bc565b830182620003c1565b50505b505050565b600082821c905092915050565b6000620004586000198460080262000438565b1980831691505092915050565b600062000473838362000445565b9150826002028217905092915050565b6200048e8262000209565b67ffffffffffffffff811115620004aa57620004a962000214565b5b620004b6825462000272565b620004c3828285620003e8565b600060209050601f831160018114620004fb5760008415620004e6578287015190505b620004f2858262000465565b86555062000562565b601f1984166200050b86620002a7565b60005b8281101562000535578489015182556001820191506020850194506020810190506200050e565b8683101562000555578489015162000551601f89168262000445565b8355505b6001600288020188555050505b505050505050565b6106f1806200057a6000396000f3fe608060405234801561001057600080fd5b50600436106100b45760003560e01c8063937cc96711610071578063937cc96714610145578063b00d78a51461014f578063b8d6426714610159578063c3ea113614610177578063dcbc088514610195578063dd7f7b4b1461019f576100b4565b8063236ff8ab146100b9578063346dbadd146100d75780633d8a63e4146100f55780634adfcb1314610113578063795abd871461011d57806392dca47614610127575b600080fd5b6100c16101bd565b6040516100ce9190610639565b60405180910390f35b6100df61024b565b6040516100ec9190610639565b60405180910390f35b6100fd6102d9565b60405161010a9190610639565b60405180910390f35b61011b610367565b005b610125610369565b005b61012f61036b565b60405161013c9190610639565b60405180910390f35b61014d6103f9565b005b6101576103fb565b005b6101616103fd565b60405161016e9190610639565b60405180910390f35b61017f61048b565b60405161018c9190610639565b60405180910390f35b61019d610519565b005b6101a761051b565b6040516101b49190610639565b60405180910390f35b600480546101ca9061068a565b80601f01602080910402602001604051908101604052809291908181526020018280546101f69061068a565b80156102435780601f1061021857610100808354040283529160200191610243565b820191906000526020600020905b81548152906001019060200180831161022657829003601f168201915b505050505081565b600680546102589061068a565b80601f01602080910402602001604051908101604052809291908181526020018280546102849061068a565b80156102d15780601f106102a6576101008083540402835291602001916102d1565b820191906000526020600020905b8154815290600101906020018083116102b457829003601f168201915b505050505081565b600380546102e69061068a565b80601f01602080910402602001604051908101604052809291908181526020018280546103129061068a565b801561035f5780601f106103345761010080835404028352916020019161035f565b820191906000526020600020905b81548152906001019060200180831161034257829003601f168201915b505050505081565b565b565b600580546103789061068a565b80601f01602080910402602001604051908101604052809291908181526020018280546103a49061068a565b80156103f15780601f106103c6576101008083540402835291602001916103f1565b820191906000526020600020905b8154815290600101906020018083116103d457829003601f168201915b505050505081565b565b565b6000805461040a9061068a565b80601f01602080910402602001604051908101604052809291908181526020018280546104369061068a565b80156104835780601f1061045857610100808354040283529160200191610483565b820191906000526020600020905b81548152906001019060200180831161046657829003601f168201915b505050505081565b600180546104989061068a565b80601f01602080910402602001604051908101604052809291908181526020018280546104c49061068a565b80156105115780601f106104e657610100808354040283529160200191610511565b820191906000526020600020905b8154815290600101906020018083116104f457829003601f168201915b505050505081565b565b600280546105289061068a565b80601f01602080910402602001604051908101604052809291908181526020018280546105549061068a565b80156105a15780601f10610576576101008083540402835291602001916105a1565b820191906000526020600020905b81548152906001019060200180831161058457829003601f168201915b505050505081565b600081519050919050565b600082825260208201905092915050565b60005b838110156105e35780820151818401526020810190506105c8565b60008484015250505050565b6000601f19601f8301169050919050565b600061060b826105a9565b61061581856105b4565b93506106258185602086016105c5565b61062e816105ef565b840191505092915050565b600060208201905081810360008301526106538184610600565b905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806106a257607f821691505b6020821081036106b5576106b461065b565b5b5091905056fea2646970667358221220746841f27e5037f89c15c7d04d5c1102b534a6fc0a7d4297aaa71c7392bedfd164736f6c63430008120033
</span></code></pre><p>Okay, We have enough Information from <code>101.txt</code>. And we are given a EVM bytecode of the contract in <code>Invitation.txt</code><p>Our Goal :<ul><li>Get the function name which starts with <code>TCP1P</code></ul><p>Observations :<ul><li>We have only the bytecode of the challenge</ul><blockquote><p><strong>What can we do? Can we decompile bytecode into readable solidity contract?</strong></blockquote><p>Yes, We can get <code>OP codes</code> and somewhat readable contract by using some decompiling tools. Here is the list of few EVM bytecode Decompilers<ul><li><a href=https://library.dedaub.com/ target=_blank>Dedaub</a><li><a href=https://ethervm.io/decompile target=_blank>EtherVM</a><li><a href=https://github.com/palkeo/panoramix target=_blank>Panoramix</a><li><a href=https://github.com/Jon-Becker/heimdall-rs target=_blank>Heimdall</a></ul><p><code>Dedaub</code> is many folks favourite and free to use. So, we can decompile our bytecode using Dedaub online decompiler.<blockquote><p><strong><code>Before decompiling lets see how function names stores in bytecode</code></strong></blockquote><p>Function names won't be directly stores as it is in the bytecode. Only function selector of that particular function will be stored in bytecode.<p><span style=color:green><strong>What is function selector?</strong></span><p>A function selector is a four-byte identifier determined through the Keccak256 hash of the function's signature. The function signature is derived from the function name and the parenthesized list of parameter types. For example a function is defined as below :<pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span style=color:#fa6e32>function </span><span style=color:#f29718>sum</span><span>(</span><span style=color:#ff8f40>uint a</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>uint b</span><span>) </span><span style=color:#f29718>public returns</span><span>(</span><span style=color:#ff8f40>uint</span><span>){
</span><span>    </span><span style=color:#abb0b6;font-style:italic>//....
</span><span>}
</span></code></pre><p>Function signature of sum() is <code>sum(uint,uint)</code>.<p>Function selector of sum() is <code>bytes4(keccak256(bytes("sum(uint,uint)")))</code><p>We can get the function selector using <code>cast</code> cli tool.<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/invitation$</span><span> cast sig </span><span style=color:#86b300>"sum(uint,uint)"
</span><span style=color:#f29718>0xcad0899b
</span></code></pre><p>As you can see only 4 bytes hex value is the function signature. This 4 bytes value only stored in the EVM bytecode.<p><span style=color:green><strong>Which OP code operates this function signature?</strong></span><p>It is <code>PUSH4</code> as PUSH4 OP code used to push 4 bytes at a time into the stack. For the above example, the assembly will be <strong><code>PUSH 0xcad0899b</code></strong>.<blockquote><p>We have got enough knowledge know lets solve the challenge</blockquote><p><span style=color:green><strong>Decompile the EVM bytecode and find the function selector</strong></span><p>I am using <code>Dedaub</code> to decompile. Enter the Bytecode in online decompiler and continue to decompile the EVM bytecode and view the disassembled section for the OP Codes. Our aim is to find the function selector which is operated by <code>PUSH4</code> OP Code, so lets find PUSH4 in the OP Codes.As you can see in below image we found few function selectors.</p><img class=autoimg src=/assets/img/ctf_img/tcp1p23/tcp1pctf23_invitation1.png><blockquote><p><strong>Can we get back the original function name from function selector?</strong></blockquote><p>Absolutely not, it is impossible to get the original function signature information back theatrically. But there is a way to find it. There is a database available which collects tons of function signatures and their hashes.<ul><li><a href=https://www.4byte.directory/ target=_blank>4byte.directory</a></ul><p>Search one by one function selectors that we found from the decompilation. <code>0xb00d78a5</code> is the one that we are looking.</p><img class=autoimg src=/assets/img/ctf_img/tcp1p23/tcp1pctf23_invitation2.png><p>Finally change the function name to flag format as specified in the 101.txt<blockquote><p><code>Flag : TCP1P{4_Bytes_SigNAtuRe_aS_4n_Invitation_congratz}</code></blockquote><h1 id=vip><a aria-label="Anchor link for: vip" class=zola-anchor href=#vip>VIP</a></h1><p><strong>Description :</strong><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>A very simple system at a party. If you are a VIP, you can get everything.
</span><span>
</span><span>Challenge : nc ctf.tcp1p.com 23345
</span></code></pre><p>Lets connect to challenge,<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@AHLinux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> nc ctf.tcp1p.com 23345
</span><span style=color:#f29718>Welcome</span><span> to TCP1P Blockchain Challenge
</span><span>
</span><span style=color:#f29718>1.</span><span> How to 101</span><span style=color:#ed9366>?
</span><span style=color:#f29718>2.</span><span> get Contract
</span><span style=color:#ed9366>>> </span><span style=color:#ff8f40>1
</span><span style=color:#f29718>Same</span><span> as the last challenge, but this time, call the help() </span><span style=color:#fa6e32>function </span><span style=color:#f29718>first
</span><span>
</span><span>mj0ln1r@AHLinux:~/vip$ nc ctf.tcp1p.com 23345
</span><span>Welcome to TCP1P Blockchain Challenge
</span><span>
</span><span>1. How to 101?
</span><span>2. get Contract
</span><span>>> 2
</span><span>Contract Addess: 0xCf2C346b07CE9931962fC8B6d93fF094FbF447B9
</span><span>RPC URL        : https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
</span><span>To start       : Simply call the help() function, everything is written there
</span><span>
</span><span>Note: Due it's deployed on Sepolia network, please use your own Private key to do the transaction
</span><span>      If you need funds, you can either DM the probset or get it on https://sepoliafaucet.com/
</span></code></pre><p>Firstly get some Sepolia ETH if you dont have like me. Thank you <strong>@kiinzu(author)</strong> for the Sepolia ETH :-).<p>Initially I did this challenge by writing a contract on remix and called challenge contract from there. Now I will explain a much more easy way using <code>Foundry</code>.<p><strong>Setup Foundry</strong><ol><li><code>forge init</code> (to setup foundry project)<li>Delete boiler plate codes under (/src, /test, /script)<li>Create a new file <code>Solve.s.sol</code> in <code>/script</code><li>Import Script and console to write scripts and logging.</ol><p>First of all as challenge 101 said, call the <code>help()</code> function. I used <code>call</code> method to call the help() function and decoded using <code>abi.decode</code>.<pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span style=color:#abb0b6;font-style:italic>// SPDX-License-Identifier: UNLICENSED
</span><span>pragma solidity </span><span style=color:#ed9366>^</span><span style=color:#ff8f40>0.8</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>13</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// import "forge-std/Script.sol";
</span><span style=color:#fa6e32>import </span><span>{Script} </span><span style=color:#fa6e32>from </span><span style=color:#86b300>"forge-std/Script.sol"</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#86b300>"forge-std/console.sol"</span><span style=color:#61676ccc>;
</span><span>
</span><span>contract SolveVIP is Script {
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>getHelp</span><span>() </span><span style=color:#f29718>public</span><span>{
</span><span>        address target </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637</span><span style=color:#61676ccc>;
</span><span>        (bool success</span><span style=color:#61676ccc>, </span><span>bytes memory _help) </span><span style=color:#ed9366>= </span><span>target</span><span style=color:#ed9366>.</span><span style=color:#f07171>call</span><span>(abi</span><span style=color:#ed9366>.</span><span style=color:#f29718>encodeWithSignature</span><span>(</span><span style=color:#86b300>"help()"</span><span>))</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#f07171>require</span><span>(success)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>console</span><span style=color:#ed9366>.</span><span style=color:#f29718>logBytes</span><span>(abi</span><span style=color:#ed9366>.</span><span style=color:#f29718>decode</span><span>(_help</span><span style=color:#61676ccc>, </span><span>(bytes)))</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>run</span><span>() </span><span style=color:#f29718>public </span><span>{
</span><span>        </span><span style=color:#f29718>getHelp</span><span>()</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span></code></pre><p>If we run the script and decoded the output we will get some message to move forward in challenge.<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> forge script script/Solve.s.sol</span><span style=color:#ff8f40> --rpc-url</span><span> https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
</span><span style=color:#f29718>[⠢]</span><span> Compiling...
</span><span style=color:#f29718>[⠒]</span><span> Compiling 15 files with 0.8.20
</span><span style=color:#f29718>[⠢]</span><span> Solc 0.8.20 finished in 5.83s
</span><span style=color:#f29718>Compiler</span><span> run successful!
</span><span style=color:#f29718>Script</span><span> ran successfully.
</span><span>
</span><span style=color:#ed9366>=</span><span style=color:#86b300>= </span><span style=color:#f29718>Logs</span><span> ==
</span><span>  </span><span style=color:#f29718>0x57656c636f6d6520746f205443503150205072697661746520436c7562210a0a456e6a6f792074686520435446205061727479206f6620796f7572206c6966652068657265210a4275742066697273742e2e2e20506c656173652067697665206d6520796f75722069642c206e6f726d616c2070656f706c652068617665206174206c65617374206d656d62657220726f6c650a4f6620436f757273652c2074686572652061726520616c736f206d616e792056495073206f76657220686572652e20422d290a0a46756e6374696f6e733a0a0a456e7472616e636528726f6c6529202d3e2076657269667920796f757220726f6c6520686572652c2061726520796f752061206d656d626572206f722056495020436c6173730a2020203e20726f6c6520202d2d3e20696e70757420796f757220726f6c6520617320737472696e670a737465616c564950436f64652829202d3e20736f6d656f6e65206d69676874277665206a75737420737465616c20612076697020636f646520616e642077616e7420746f206769766520697420746f20796f750a676574466c616728292020202020202d3e204f6e636520796f752073686f7720796f757220726f6c652c20796f752063616e2074727920796f7572206c75636b21204f4e4c59205649502043616e206765742074686520466c6167210a0a0a
</span><span>
</span><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> python3
</span><span style=color:#ed9366>>>></span><span> from </span><span style=color:#f29718>Crypto.Util.number</span><span> import long_to_bytes
</span><span style=color:#ed9366>>>></span><span> long_to_bytes(</span><span style=color:#f29718>0x57656c636f6d6520746f205443503150205072697661746520436c7562210a0a456e6a6f792074686520435446205061727479206f6620796f7572206c6966652068657265210a4275742066697273742e2e2e20506c656173652067697665206d6520796f75722069642c206e6f726d616c2070656f706c652068617665206174206c65617374206d656d62657220726f6c650a4f6620436f757273652c2074686572652061726520616c736f206d616e792056495073206f76657220686572652e20422d290a0a46756e6374696f6e733a0a0a456e7472616e636528726f6c6529202d3e2076657269667920796f757220726f6c6520686572652c2061726520796f752061206d656d626572206f722056495020436c6173730a2020203e20726f6c6520202d2d3e20696e70757420796f757220726f6c6520617320737472696e670a737465616c564950436f64652829202d3e20736f6d656f6e65206d69676874277665206a75737420737465616c20612076697020636f646520616e642077616e7420746f206769766520697420746f20796f750a676574466c616728292020202020202d3e204f6e636520796f752073686f7720796f757220726f6c652c20796f752063616e2074727920796f7572206c75636b21204f4e4c59205649502043616e206765742074686520466c6167210a0a0a</span><span>)
</span><span>
</span><span style=color:#f29718>b</span><span style=color:#86b300>"Welcome to TCP1P Private Club!
</span><span style=color:#86b300>
</span><span style=color:#86b300>Enjoy the CTF Party of your life here!
</span><span style=color:#86b300>But first... Please give me your id, normal people have at least member role
</span><span style=color:#86b300>Of Course, there are also many VIPs over here. B-)
</span><span style=color:#86b300>Functions:
</span><span style=color:#86b300>Entrance(role) -> verify your role here, are you a member or VIP Class
</span><span style=color:#86b300>   > role  --> input your role as string
</span><span style=color:#86b300>   stealVIPCode() -> someone might've just steal a vip code and want to give it to you
</span><span style=color:#86b300>   getFlag()      -> Once you show your role, you can try your luck! ONLY VIP Can get the Flag!"
</span><span>
</span></code></pre><p>Now we its clear that we need to call <code>stealVIPCode()</code> first then get the VIP Code and use it to call the <code>Entrance(role)</code> to solve the challenge. Finally calling the <code>getFlag()</code> will give us the flag.<p>Lets call <code>stealVIPCode()</code><pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span style=color:#abb0b6;font-style:italic>// SPDX-License-Identifier: UNLICENSED
</span><span>pragma solidity </span><span style=color:#ed9366>^</span><span style=color:#ff8f40>0.8</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>13</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#abb0b6;font-style:italic>// import "forge-std/Script.sol";
</span><span style=color:#fa6e32>import </span><span>{Script} </span><span style=color:#fa6e32>from </span><span style=color:#86b300>"forge-std/Script.sol"</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#86b300>"forge-std/console.sol"</span><span style=color:#61676ccc>;
</span><span>
</span><span>contract SolveVIP is Script {
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>callStealVIPCode</span><span>() </span><span style=color:#f29718>public </span><span>{
</span><span>            address target </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637</span><span style=color:#61676ccc>;
</span><span>            (bool success</span><span style=color:#61676ccc>, </span><span>bytes memory _vipCode) </span><span style=color:#ed9366>= </span><span>target</span><span style=color:#ed9366>.</span><span style=color:#f07171>call</span><span>(abi</span><span style=color:#ed9366>.</span><span style=color:#f29718>encodeWithSignature</span><span>(</span><span style=color:#86b300>"stealVIPCode()"</span><span>))</span><span style=color:#61676ccc>;
</span><span>            </span><span style=color:#f07171>require</span><span>(success)</span><span style=color:#61676ccc>;
</span><span>            </span><span style=color:#55b4d4;font-style:italic>console</span><span style=color:#ed9366>.</span><span style=color:#f29718>logBytes</span><span>(abi</span><span style=color:#ed9366>.</span><span style=color:#f29718>decode</span><span>(_vipCode</span><span style=color:#61676ccc>,</span><span>(bytes)))</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>run</span><span>() </span><span style=color:#f29718>public </span><span>{
</span><span>        </span><span style=color:#f29718>callStealVIPCode</span><span>()</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span></code></pre><p>Run Script and Decode the hex to get the VIPCode.<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> forge script script/Solve.s.sol</span><span style=color:#ff8f40> --rpc-url</span><span> https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
</span><span style=color:#f29718>[⠢]</span><span> Compiling...
</span><span style=color:#f29718>[⠒]</span><span> Compiling 15 files with 0.10.20
</span><span style=color:#f29718>[⠢]</span><span> Solc 0.8.20 finished in 5.35s
</span><span style=color:#f29718>Compiler</span><span> run successful!
</span><span style=color:#f29718>Script</span><span> ran successfully.
</span><span>
</span><span style=color:#ed9366>=</span><span style=color:#86b300>= </span><span style=color:#f29718>Logs</span><span> ==
</span><span>  </span><span style=color:#f29718>0x2049206d6179206f72206d6179206e6f742067657420796f752061207469636b65742c20627574204920646f6e277420756e6465727374616e64206d7563682061626f757420686f7720746f206465636f646520746869732e0a4974277320736f6d6520736f7274206f6620746865697220616269436f64657220706f6c6963792e200a5649502d5469636b65743a203078303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303032303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030326635343433353033313530333137333734343336633631373337333533363536313734323032643230363937333230373436383635323035363439353032303534363936333662363537343230373436383635373932303733363136393634303030303030303030303030303030303030303030303030303030303030303030300a
</span><span>
</span><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> python3
</span><span style=color:#ed9366>>>></span><span> from </span><span style=color:#f29718>Crypto.Util.number</span><span> import long_to_bytes
</span><span style=color:#ed9366>>>></span><span> long_to_bytes(</span><span style=color:#f29718>0x2049206d6179206f72206d6179206e6f742067657420796f752061207469636b65742c20627574204920646f6e277420756e6465727374616e64206d7563682061626f757420686f7720746f206465636f646520746869732e0a4974277320736f6d6520736f7274206f6620746865697220616269436f64657220706f6c6963792e200a5649502d5469636b65743a203078303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303032303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030326635343433353033313530333137333734343336633631373337333533363536313734323032643230363937333230373436383635323035363439353032303534363936333662363537343230373436383635373932303733363136393634303030303030303030303030303030303030303030303030303030303030303030300a</span><span>)
</span><span>
</span><span style=color:#f29718>b</span><span style=color:#86b300>" I may or may not get you a ticket, but I don't understand much about how to decode this.\nIt's some sort of their abiCoder policy. \nVIP-Ticket: 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002f5443503150317374436c61737353656174202d2069732074686520564950205469636b6574207468657920736169640000000000000000000000000000000000\n"
</span><span>
</span><span style=color:#ed9366>>>></span><span> long_to_bytes(</span><span style=color:#f29718>0x5443503150317374436c61737353656174202d2069732074686520564950205469636b657420746865792073616964</span><span>)
</span><span style=color:#f29718>b</span><span style=color:#86b300>'TCP1P1stClassSeat - is the VIP Ticket they said'
</span><span>
</span></code></pre><p>Now we have got VIPCode lets call <code>Entrance(role)</code> with role as <strong><code>TCP1P1stClassSeat</code></strong> and call <code>getCall()</code> to get flag hex and decode it for the flag.<blockquote><p>The final script :</blockquote><pre class=language-javascript data-lang=javascript style=color:#61676c;background-color:#fafafa><code class=language-javascript data-lang=javascript><span style=color:#abb0b6;font-style:italic>// SPDX-License-Identifier: UNLICENSED
</span><span>pragma solidity </span><span style=color:#ed9366>^</span><span style=color:#ff8f40>0.8</span><span style=color:#ed9366>.</span><span style=color:#ff8f40>13</span><span style=color:#61676ccc>;
</span><span>
</span><span style=color:#fa6e32>import </span><span>{Script} </span><span style=color:#fa6e32>from </span><span style=color:#86b300>"forge-std/Script.sol"</span><span style=color:#61676ccc>;
</span><span style=color:#fa6e32>import </span><span style=color:#86b300>"forge-std/console.sol"</span><span style=color:#61676ccc>;
</span><span>
</span><span>contract SolveVIP is Script {
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>getHelp</span><span>() </span><span style=color:#f29718>public</span><span>{
</span><span>        address target </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637</span><span style=color:#61676ccc>;
</span><span>        (bool success</span><span style=color:#61676ccc>, </span><span>bytes memory _help) </span><span style=color:#ed9366>= </span><span>target</span><span style=color:#ed9366>.</span><span style=color:#f07171>call</span><span>(abi</span><span style=color:#ed9366>.</span><span style=color:#f29718>encodeWithSignature</span><span>(</span><span style=color:#86b300>"help()"</span><span>))</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#f07171>require</span><span>(success)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// console.logBytes(abi.decode(_help, (bytes)));
</span><span>    }
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>callStealVIPCode</span><span>() </span><span style=color:#f29718>public </span><span>{
</span><span>        address target </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637</span><span style=color:#61676ccc>;
</span><span>        (bool success</span><span style=color:#61676ccc>, </span><span>bytes memory _vipCode) </span><span style=color:#ed9366>= </span><span>target</span><span style=color:#ed9366>.</span><span style=color:#f07171>call</span><span>(abi</span><span style=color:#ed9366>.</span><span style=color:#f29718>encodeWithSignature</span><span>(</span><span style=color:#86b300>"stealVIPCode()"</span><span>))</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#f07171>require</span><span>(success)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// console.logBytes(abi.decode(_vipCode,(bytes)));
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>callEntrance</span><span>(</span><span style=color:#ff8f40>string memory _role</span><span>) </span><span style=color:#f29718>public </span><span>{
</span><span>        address target </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637</span><span style=color:#61676ccc>;
</span><span>        (bool success</span><span style=color:#61676ccc>, </span><span>) </span><span style=color:#ed9366>= </span><span>target</span><span style=color:#ed9366>.</span><span style=color:#f07171>call</span><span>(abi</span><span style=color:#ed9366>.</span><span style=color:#f29718>encodeWithSignature</span><span>(</span><span style=color:#86b300>"Entrance(string)"</span><span style=color:#61676ccc>, </span><span>_role))</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#f07171>require</span><span>(success)</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>callGetFlag</span><span>() </span><span style=color:#f29718>public </span><span>{
</span><span>        address target </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637</span><span style=color:#61676ccc>;
</span><span>        (bool success</span><span style=color:#61676ccc>, </span><span>bytes memory _flag) </span><span style=color:#ed9366>= </span><span>target</span><span style=color:#ed9366>.</span><span style=color:#f07171>call</span><span>(abi</span><span style=color:#ed9366>.</span><span style=color:#f29718>encodeWithSignature</span><span>(</span><span style=color:#86b300>"getFlag()"</span><span>))</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#f07171>require</span><span>(success)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#55b4d4;font-style:italic>console</span><span style=color:#ed9366>.</span><span style=color:#f29718>logBytes</span><span>(_flag)</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>    </span><span style=color:#fa6e32>function </span><span style=color:#f29718>run</span><span>() </span><span style=color:#f29718>public </span><span>{
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// getHelp();
</span><span>        </span><span style=color:#abb0b6;font-style:italic>// callStealVIPCode();
</span><span>        </span><span style=color:#f29718>callEntrance</span><span>(</span><span style=color:#86b300>"TCP1P1stClassSeat"</span><span>)</span><span style=color:#61676ccc>;
</span><span>        </span><span style=color:#f29718>callGetFlag</span><span>()</span><span style=color:#61676ccc>;
</span><span>    }
</span><span>}
</span><span>
</span></code></pre><pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> forge script script/Solve.s.sol</span><span style=color:#ff8f40> --rpc-url</span><span> https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8</span><span style=color:#ff8f40> --private-key </span><span style=color:#ed9366><</span><span>REDACTED</span><span style=color:#ed9366>> 
</span><span style=color:#f29718>[⠢]</span><span> Compiling...
</span><span style=color:#f29718>[⠒]</span><span> Compiling 15 files with 0.10.20
</span><span style=color:#f29718>[⠢]</span><span> Solc 0.8.20 finished in 10.35s
</span><span style=color:#f29718>Compiler</span><span> run successful!
</span><span style=color:#f29718>Script</span><span> ran successfully.
</span><span>
</span><span style=color:#ed9366>=</span><span style=color:#86b300>= </span><span style=color:#f29718>Logs</span><span> ==
</span><span>  </span><span style=color:#f29718>0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003854435031507b345f6231745f6f665f6630756e6472795f73336e645f346e645f616269436f6465725f77306e375f687572375f793334687d0000000000000000
</span><span>
</span><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> python3
</span><span style=color:#ed9366>>>></span><span> from </span><span style=color:#f29718>Crypto.Util.number</span><span> import long_to_bytes
</span><span style=color:#ed9366>>>></span><span> long_to_bytes(</span><span style=color:#f29718>0x54435031507b345f6231745f6f665f6630756e6472795f73336e645f346e645f616269436f6465725f77306e375f687572375f793334687d</span><span>)
</span><span style=color:#f29718>b</span><span style=color:#86b300>'TCP1P{4_b1t_of_f0undry_s3nd_4nd_abiCoder_w0n7_hur7_y34h}'
</span><span>
</span></code></pre><h3 id=quick-way-to-solve><a aria-label="Anchor link for: quick-way-to-solve" class=zola-anchor href=#quick-way-to-solve>Quick way to Solve</a></h3><p>We can use <code>cast</code> cli tool to call the function from command line quickly.<pre class=language-bash data-lang=bash style=color:#61676c;background-color:#fafafa><code class=language-bash data-lang=bash><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> cast 0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637  </span><span style=color:#86b300>"help()"</span><span style=color:#ff8f40> --rpc-url</span><span> https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
</span><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> cast 0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637 </span><span style=color:#86b300>"stealVIPCode()"</span><span style=color:#ff8f40> --rpc-url</span><span> https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
</span><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> cast send 0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637 </span><span style=color:#86b300>"getEntrance(string)"</span><span style=color:#ff8f40> --rpc-url</span><span> https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8</span><span style=color:#ff8f40> --private-key </span><span style=color:#ed9366><</span><span>REDACTED</span><span style=color:#ed9366>> </span><span style=color:#61676ccc>-</span><span>- </span><span style=color:#86b300>"TCP1P1stClassSeat"
</span><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/vip$</span><span> cast 0x52DF9c7cc8f8f5C8204F2401505A6248cE49d637 </span><span style=color:#86b300>"getFlag()"</span><span style=color:#ff8f40> --rpc-url</span><span> https://eth-sepolia.g.alchemy.com/v2/SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
</span></code></pre><p>And dont forget to decoding each output in the same way we did before to get the flag.<hr><h2 id=references><a aria-label="Anchor link for: references" class=zola-anchor href=#references>References</a></h2><ol><li><a href=https://docs.soliditylang.org/en/latest/internals/layout_in_storage.html target=_blank>Solidity Docs</a><li><a href=https://noxx.substack.com/p/evm-deep-dives-the-path-to-shadowy-3ea target=_blank>noxx.substack.com</a><li><a href=https://medium.com/@flores.eugenio03/exploring-the-storage-layout-in-solidity-and-how-to-access-state-variables-bf2cbc6f8018 target=_blank>Storage Layout</a><li><a href=https://blog.trustlook.com/understand-evm-bytecode-part-2/ target=_blank>blog.trustlook.com</a><li><a href=https://book.getfoundry.sh/ target=_blank>Foundry Book</a></ol><hr><p>Thank you for reading!</section></article></main></div>