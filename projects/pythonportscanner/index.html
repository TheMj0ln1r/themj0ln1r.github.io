<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         PortScan
        
    </title><meta content=PortScan property=og:title><meta content="Basic python script to brush up networking and socket programming" property=og:description><meta content="Basic python script to brush up networking and socket programming" name=description><link href=/favicons/favicon.ico rel=icon type=image/png><link href=https://themj0ln1r.github.io/fonts.css rel=stylesheet><script src=https://themj0ln1r.github.io/js/codeblock.js></script><script src=https://themj0ln1r.github.io/js/toc.js></script><script src=https://themj0ln1r.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Charan Nomula" href=https://themj0ln1r.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://themj0ln1r.github.io/theme/light.css rel=stylesheet><link href=https://themj0ln1r.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://themj0ln1r.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://themj0ln1r.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://themj0ln1r.github.io/>Charan Nomula</a><div class=socials><a class=social href=https://x.com/TheMj0ln1r/ rel=me target=_blank> <img alt=twitter src=https://themj0ln1r.github.io/social_icons/twitter.svg> </a><a class=social href=https://linkedin.com/in/mj0ln1r/ rel=me target=_blank> <img alt=linkedin src=https://themj0ln1r.github.io/social_icons/linkedin.svg> </a><a class=social href=https://github.com/TheMj0ln1r/ rel=me target=_blank> <img alt=github src=https://themj0ln1r.github.io/social_icons/github.svg> </a><a href="mailto: playermj0ln1r@gmail.com" class=social rel=me target=_blank> <img alt=Email src=https://themj0ln1r.github.io/social_icons/email.svg> </a></div></div><nav><a href=https://themj0ln1r.github.io/posts style=margin-left:.5em>/posts</a><a href=https://themj0ln1r.github.io/writeups style=margin-left:.5em>/writeups</a><a href=https://themj0ln1r.github.io/projects style=margin-left:.5em>/projects</a><a href=https://themj0ln1r.github.io/contact style=margin-left:.5em>/contact</a><a href=https://themj0ln1r.github.io/tags style=margin-left:.5em>/tags</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://themj0ln1r.github.io/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://themj0ln1r.github.io/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>PortScan<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2022-10-07</time></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://themj0ln1r.github.io/projects/pythonportscanner/#port-scanner>Port Scanner</a> <ul><li><a href=https://themj0ln1r.github.io/projects/pythonportscanner/#requirements>Requirements</a><li><a href=https://themj0ln1r.github.io/projects/pythonportscanner/#installation>Installation</a><li><a href=https://themj0ln1r.github.io/projects/pythonportscanner/#preview>Preview</a></ul></ul></div><section class=body><p>Hi guys!,<p>Mj0ln1r is here, back again with a new post this is meta data about my new python script/tool Simple Python Port Scanner.<p>As you know i am learning and building some simple python automated tools. Port Scanner is my second tool which is programmed by my own knowledge.<p>I wrote this script called <code>Port_Scanner</code> in python. I learned <code>basics of socket programming</code> , little bit about <code>platform</code> module, <code>multi-threading in python</code> and a basic tool<code>ping</code> which is useful in computer networking.<p>So, here's a brief information about my simple python port scanner.<h1 id=port-scanner>Port Scanner</h1><p>This is a basic computer networking based project. The script is developed using python which can perform following tasks.<ol><li>Scanning open ports on a single target<li>Scanning open ports in every system in a network Let's start with the main function.</ol><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>main</span><span>():
</span><span>
</span><span>	</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"""
</span><span style=color:#86b300>	1 > Scan one device
</span><span style=color:#86b300>	2 > Scan Entire network
</span><span style=color:#86b300>		"""</span><span>)
</span><span>	choice </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter your choice(1/2) : "</span><span>))
</span><span>
</span><span>	</span><span style=color:#fa6e32>if </span><span>choice </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>1</span><span>:
</span><span>
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Scanning only one target.. </span><span style=color:#4cbf99>\n</span><span style=color:#86b300>"</span><span>)
</span><span>		</span><span style=color:#fa6e32>global </span><span>target_ip
</span><span>		target_ip </span><span style=color:#ed9366>= </span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter Target IP or URL : "</span><span>)
</span><span>
</span><span>		start_port </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter start port : "</span><span>))
</span><span>		end_port </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter end port : "</span><span>))
</span><span>		
</span><span>		</span><span style=color:#f29718>input_check</span><span>(start_port</span><span style=color:#61676ccc>,</span><span>end_port)
</span><span>		</span><span style=color:#f29718>single_host_scan</span><span>(start_port</span><span style=color:#61676ccc>,</span><span>end_port)
</span><span>		sys</span><span style=color:#ed9366>.</span><span style=color:#f29718>exit</span><span>()
</span><span>	</span><span style=color:#fa6e32>elif </span><span>choice </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>2</span><span>:
</span><span>
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Scanning Entire Network..</span><span style=color:#4cbf99>\n</span><span style=color:#86b300>"</span><span>)
</span><span>		target_ip </span><span style=color:#ed9366>= </span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter your IP address : "</span><span>)
</span><span>		start_host </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter start host : "</span><span>))
</span><span>		end_host </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter end host : "</span><span>))
</span><span>		start_port </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter start port : "</span><span>))
</span><span>		end_port </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter end port : "</span><span>))
</span><span>		
</span><span>		</span><span style=color:#f29718>input_check</span><span>(start_port</span><span style=color:#61676ccc>,</span><span>end_port)
</span><span>		</span><span style=color:#f29718>host_check</span><span>(start_host</span><span style=color:#61676ccc>,</span><span>end_host)
</span><span>		</span><span style=color:#f29718>multi_host_scan</span><span>(start_host</span><span style=color:#61676ccc>,</span><span>end_host</span><span style=color:#61676ccc>,</span><span>start_port</span><span style=color:#61676ccc>,</span><span>end_port)
</span><span>		sys</span><span style=color:#ed9366>.</span><span style=color:#f29718>exit</span><span>()
</span><span>	</span><span style=color:#fa6e32>else </span><span>:
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Invalid choice."</span><span>)
</span><span>		sys</span><span style=color:#ed9366>.</span><span style=color:#f29718>exit</span><span>()
</span><span style=color:#f29718>main</span><span>()
</span></code></pre><p>In the beginning, this tool will asks the users for their choice to perform a specific task. i.e, to scan a single target or an entire network. If the user choose 1, then the tool will take start port and end port as an input from the user. Then the program is going to validate the inputs given, this is done by the <code>input_check</code> function. Next the <code>single_host_scan</code> will be called. Take look at these two functions.<p><code>input_check()</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>input_check</span><span>(</span><span style=color:#ff8f40>start_port</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>end_port</span><span>):
</span><span>	</span><span style=color:#fa6e32>global </span><span>target_ip
</span><span>	ip </span><span style=color:#ed9366>= </span><span>re</span><span style=color:#ed9366>.</span><span style=color:#f29718>search</span><span>(</span><span style=color:#fa6e32>r</span><span style=color:#86b300>'(</span><span style=color:#ff8f40>\d</span><span style=color:#ed9366>{1,3}</span><span style=color:#4cbf99>\.</span><span style=color:#ff8f40>\d</span><span style=color:#ed9366>{1,3}</span><span style=color:#4cbf99>\.</span><span style=color:#ff8f40>\d</span><span style=color:#ed9366>{1,3}</span><span style=color:#4cbf99>\.</span><span style=color:#ff8f40>\d</span><span style=color:#ed9366>{1,3}</span><span style=color:#86b300>)'</span><span style=color:#61676ccc>,</span><span>target_ip)
</span><span>	</span><span style=color:#fa6e32>if </span><span style=color:#ed9366>not </span><span>ip:
</span><span>		</span><span style=color:#fa6e32>try </span><span>:
</span><span>			target_ip </span><span style=color:#ed9366>= </span><span>socket</span><span style=color:#ed9366>.</span><span style=color:#f29718>gethostbyname</span><span>(target_ip)
</span><span>		</span><span style=color:#fa6e32>except </span><span>socket.gaierror :
</span><span>			</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Unable resolve host address"</span><span>)
</span><span>			sys</span><span style=color:#ed9366>.</span><span style=color:#f29718>exit</span><span>()
</span><span>	</span><span style=color:#fa6e32>if </span><span>((start_port </span><span style=color:#ed9366>< </span><span style=color:#ff8f40>1</span><span>) </span><span style=color:#ed9366>or </span><span>(end_port </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>65535</span><span>)):
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Port numbers are invalid.. </span><span style=color:#4cbf99>\n</span><span style=color:#86b300>"</span><span>)
</span><span>		sys</span><span style=color:#ed9366>.</span><span style=color:#f29718>exit</span><span>()
</span></code></pre><p>In the try block of the input_check function, if a user gave a website as target that url will be changed to IP address here.<p><code>single_host_scan()</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>single_host_scan</span><span>(</span><span style=color:#ff8f40>start_port</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>end_port</span><span>):
</span><span>
</span><span>	</span><span style=color:#fa6e32>if </span><span style=color:#f29718>islive</span><span>():
</span><span>		</span><span style=color:#fa6e32>for </span><span>port </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(start_port</span><span style=color:#61676ccc>,</span><span>end_port</span><span style=color:#ed9366>+</span><span style=color:#ff8f40>1</span><span>):
</span><span>			thread </span><span style=color:#ed9366>= </span><span>threading</span><span style=color:#ed9366>.</span><span style=color:#f29718>Thread</span><span>(</span><span style=color:#ff8f40>target </span><span style=color:#ed9366>= </span><span>single_port</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>args </span><span style=color:#ed9366>= </span><span>(port</span><span style=color:#61676ccc>,</span><span>))
</span><span>			thread</span><span style=color:#ed9366>.</span><span style=color:#f29718>start</span><span>()
</span><span>			thread</span><span style=color:#ed9366>.</span><span style=color:#f29718>join</span><span>()
</span><span>	</span><span style=color:#fa6e32>else</span><span>:
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"</span><span style=color:#4cbf99>\t</span><span style=color:#86b300> Not reachable.</span><span style=color:#4cbf99>\n</span><span style=color:#86b300>"</span><span>)
</span></code></pre><p>In the above function the islive function will checks that the given host is live or not. If it is live then it is going to scan every port in a given range of that target host.<p><code>islive()</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>islive</span><span>():
</span><span>	</span><span style=color:#fa6e32>try</span><span>:
</span><span>		</span><span style=color:#fa6e32>if </span><span style=color:#86b300>"Linux" </span><span style=color:#ed9366>in </span><span style=color:#f29718>system</span><span>():
</span><span>			p </span><span style=color:#ed9366>= </span><span>subprocess</span><span style=color:#ed9366>.</span><span style=color:#f29718>run</span><span>([</span><span style=color:#86b300>"ping"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"-c"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"1"</span><span style=color:#61676ccc>,</span><span>target_ip]</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>capture_output</span><span style=color:#ed9366>=</span><span style=color:#ff8f40>True</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>text</span><span style=color:#ed9366>=</span><span style=color:#ff8f40>True</span><span>)
</span><span>			</span><span style=color:#fa6e32>if </span><span>p</span><span style=color:#ed9366>.</span><span>returncode </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>0</span><span>:
</span><span>				</span><span style=color:#fa6e32>return </span><span style=color:#ff8f40>True
</span><span>
</span><span>		</span><span style=color:#fa6e32>if </span><span style=color:#86b300>"Windows" </span><span style=color:#ed9366>in </span><span style=color:#f29718>system</span><span>():
</span><span>			p </span><span style=color:#ed9366>= </span><span>subprocess</span><span style=color:#ed9366>.</span><span style=color:#f29718>run</span><span>([</span><span style=color:#86b300>"ping"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"-n"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"1"</span><span style=color:#61676ccc>,</span><span>target_ip]</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>capture_output</span><span style=color:#ed9366>=</span><span style=color:#ff8f40>True</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>text</span><span style=color:#ed9366>=</span><span style=color:#ff8f40>True</span><span>)
</span><span>			</span><span style=color:#fa6e32>if </span><span>p</span><span style=color:#ed9366>.</span><span>returncode </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>0</span><span>:
</span><span>				</span><span style=color:#fa6e32>return </span><span style=color:#ff8f40>True
</span><span>
</span><span>	</span><span style=color:#fa6e32>except </span><span>subprocess.CalledProcessError:
</span><span>		</span><span style=color:#fa6e32>return </span><span style=color:#ff8f40>False
</span></code></pre><p>islive() function uses a ping scan to check the target is live or not.<p>If the target is live, a thread is created for each port to increase the speed of the scan. In every thread single_port() function is being called.<p><code>single_port</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>single_port</span><span>(</span><span style=color:#ff8f40>port</span><span>):
</span><span>		s </span><span style=color:#ed9366>= </span><span>socket</span><span style=color:#ed9366>.</span><span style=color:#f29718>socket</span><span>(socket</span><span style=color:#ed9366>.</span><span>AF_INET</span><span style=color:#61676ccc>, </span><span>socket</span><span style=color:#ed9366>.</span><span>SOCK_STREAM)
</span><span>		socket</span><span style=color:#ed9366>.</span><span style=color:#f29718>setdefaulttimeout</span><span>(</span><span style=color:#ff8f40>1</span><span>)
</span><span>		status </span><span style=color:#ed9366>= </span><span>s</span><span style=color:#ed9366>.</span><span style=color:#f29718>connect_ex</span><span>((target_ip</span><span style=color:#61676ccc>,</span><span>port))
</span><span>		</span><span style=color:#fa6e32>if</span><span>(</span><span style=color:#ed9366>not </span><span>status):
</span><span>			</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"</span><span style=color:#4cbf99>\t</span><span style=color:#86b300>Open port "</span><span style=color:#61676ccc>,</span><span>port)
</span><span>			s</span><span style=color:#ed9366>.</span><span style=color:#f29718>close</span><span>()
</span><span>		s</span><span style=color:#ed9366>.</span><span style=color:#f29718>close</span><span>()
</span></code></pre><p>By using socket programming the connection request for a port will be sent to the remote host. If the connection was established with a port the status of the port will be printed as open.<p>Now if the user choose to scan entire network, the same concept is used to check the open ports.The functions involved in entire network scan are <code>host_check</code> and <code>multi_host_scan</code>.<p><code>host_check()</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>host_check</span><span>(</span><span style=color:#ff8f40>start_host</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>end_host</span><span>):
</span><span>	</span><span style=color:#fa6e32>if </span><span>(start_host </span><span style=color:#ed9366>< </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366>or </span><span>end_host </span><span style=color:#ed9366>> </span><span style=color:#ff8f40>255</span><span>):
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Host range in not valid..</span><span style=color:#4cbf99>\n</span><span style=color:#86b300>"</span><span>)
</span><span>		sys</span><span style=color:#ed9366>.</span><span style=color:#f29718>exit</span><span>()
</span></code></pre><p><code>multi_host_scan()</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>multi_host_scan</span><span>(</span><span style=color:#ff8f40>start_host</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>end_host</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>start_port</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>end_port</span><span>):
</span><span>	</span><span style=color:#fa6e32>global </span><span>target_ip
</span><span>	tmp </span><span style=color:#ed9366>= </span><span>target_ip
</span><span>	ip </span><span style=color:#ed9366>= </span><span>tmp</span><span style=color:#ed9366>.</span><span style=color:#f29718>split</span><span>(</span><span style=color:#86b300>"."</span><span>)
</span><span>	ip </span><span style=color:#ed9366>= </span><span style=color:#86b300>"."</span><span style=color:#ed9366>.</span><span style=color:#f29718>join</span><span>(ip[</span><span style=color:#ff8f40>0</span><span style=color:#61676ccc>:</span><span style=color:#ff8f40>3</span><span>])</span><span style=color:#ed9366>+</span><span style=color:#86b300>"."
</span><span>	</span><span style=color:#fa6e32>for </span><span>host </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(start_host</span><span style=color:#61676ccc>,</span><span>end_host</span><span style=color:#ed9366>+</span><span style=color:#ff8f40>1</span><span>):
</span><span>		target_ip </span><span style=color:#ed9366>= </span><span>ip </span><span style=color:#ed9366>+ </span><span style=color:#55b4d4;font-style:italic>str</span><span>(host)
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Scannig Host : "</span><span style=color:#ed9366>+</span><span>target_ip</span><span style=color:#ed9366>+</span><span style=color:#86b300>"</span><span style=color:#4cbf99>\n</span><span style=color:#86b300>"</span><span>)
</span><span>		</span><span style=color:#f29718>single_host_scan</span><span>(start_port</span><span style=color:#61676ccc>,</span><span>end_port)
</span><span>	sys</span><span style=color:#ed9366>.</span><span style=color:#f29718>exit</span><span>()
</span></code></pre><p>I devoloped this script with less additional modules this can be executed in any system without any additional requirements.This scanning process will take less time.<h3 id=requirements>Requirements</h3><p>You may require some python modules<ol><li>subprocess<li>socket<li>platform<li>threading<li>sys</ol><p>These modules will be pre installed on every system, if not then install them with <code>pip3 or pip</code><h3 id=installation>Installation</h3><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>git clone https://github.com/TheMj0ln1r/Port_Scanner.git
</span><span>cd Port_Scanner
</span><span>python3 Port_Scanner.py
</span></code></pre><h3 id=preview>Preview</h3><p><img alt=Preview src=/assets/img/project_img/portscanner/portscanner.png>{: w="600",h="600"}<blockquote><p>If anything should be modified in the script please let me know. {: .prompt-info }</blockquote><p>You can find complete source code of Port Scanner here : <a href=https://github.com/TheMj0ln1r/Port_Scanner>https://github.com/TheMj0ln1r/Port_Scanner</a></section></article></main></div>