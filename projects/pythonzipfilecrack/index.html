<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         ZipCrack
        
    </title><meta content=ZipCrack property=og:title><meta content="Python script to bruteforce zip files passwords" property=og:description><meta content="Python script to bruteforce zip files passwords" name=description><link href=/favicons/favicon.ico rel=icon type=image/png><link href=https://themj0ln1r.github.io/fonts.css rel=stylesheet><script src=https://themj0ln1r.github.io/js/codeblock.js></script><script src=https://themj0ln1r.github.io/js/toc.js></script><script src=https://themj0ln1r.github.io/js/note.js></script><script>MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
              }
            };</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Charan Nomula" href=https://themj0ln1r.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://themj0ln1r.github.io/theme/light.css rel=stylesheet><link href=https://themj0ln1r.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://themj0ln1r.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://themj0ln1r.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://themj0ln1r.github.io/>Charan Nomula</a><div class=socials><a class=social href=https://x.com/TheMj0ln1r/ rel=me target=_blank> <img alt=twitter src=https://themj0ln1r.github.io/social_icons/twitter.svg> </a><a class=social href=https://linkedin.com/in/mj0ln1r/ rel=me target=_blank> <img alt=linkedin src=https://themj0ln1r.github.io/social_icons/linkedin.svg> </a><a class=social href=https://github.com/TheMj0ln1r/ rel=me target=_blank> <img alt=github src=https://themj0ln1r.github.io/social_icons/github.svg> </a><a href="mailto: playermj0ln1r@gmail.com" class=social rel=me target=_blank> <img alt=Email src=https://themj0ln1r.github.io/social_icons/email.svg> </a></div></div><nav><a href=https://themj0ln1r.github.io/posts style=margin-left:.5em>/posts</a><a href=https://themj0ln1r.github.io/writeups style=margin-left:.5em>/writeups</a><a href=https://themj0ln1r.github.io/projects style=margin-left:.5em>/projects</a><a href=https://themj0ln1r.github.io/contact style=margin-left:.5em>/contact</a><a href=https://themj0ln1r.github.io/tags style=margin-left:.5em>/tags</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://themj0ln1r.github.io/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://themj0ln1r.github.io/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>ZipCrack<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2022-10-15</time></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://themj0ln1r.github.io/projects/pythonzipfilecrack/#pythonzipcracker>PythonZipCracker</a> <ul><li><a href=https://themj0ln1r.github.io/projects/pythonzipfilecrack/#requirements>Requirements</a><li><a href=https://themj0ln1r.github.io/projects/pythonzipfilecrack/#installation>Installation</a><li><a href=https://themj0ln1r.github.io/projects/pythonzipfilecrack/#preview>Preview</a></ul></ul></div><section class=body><p>Hi mates!,<p>Mj0ln1r is here, this time with another simple project named "PythonZipCracker" developed with python.<p>As you know i am learning and building some simple python automated tools. PythonZipCracker is my third tool which is programmed by my own knowledge.<p>I wrote this script called <code>PythonZipCracker</code> in python. I learned <code>pyzipper and zipfile</code> modules in python.<p>So, here's a brief information about my simple PythonZipCracker.<h1 id=pythonzipcracker>PythonZipCracker</h1><p>This is a multiway password protected zip file cracker. The script is developed using python which can perform following tasks.<ol><li>It can crack the password of a zip file with the rockyou.txt<li>It can crack the password of a zip file using your own password list<li>It can crack the password of a zip file with the bruteforcing of digits</ol><p>Let's explore the main()<pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span>
</span><span style=color:#fa6e32>def </span><span style=color:#f29718>main</span><span>():
</span><span>	zfile </span><span style=color:#ed9366>= </span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter absolute path of the zip file : "</span><span>)
</span><span>	</span><span style=color:#fa6e32>if </span><span style=color:#ed9366>not </span><span>os</span><span style=color:#ed9366>.</span><span>path</span><span style=color:#ed9366>.</span><span style=color:#f29718>isfile</span><span>(zfile):
</span><span>		</span><span style=color:#f07171>print</span><span>(zfile</span><span style=color:#61676ccc>,</span><span style=color:#86b300>" is not found.."</span><span>)
</span><span>		</span><span style=color:#f29718>exit</span><span>()
</span><span>	</span><span style=color:#f07171>dir </span><span style=color:#ed9366>= </span><span>zfile[</span><span style=color:#ff8f40>0</span><span style=color:#61676ccc>:</span><span style=color:#f07171>len</span><span>(zfile)</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>4</span><span>]
</span><span>	</span><span style=color:#fa6e32>if </span><span>os</span><span style=color:#ed9366>.</span><span>path</span><span style=color:#ed9366>.</span><span style=color:#f29718>isdir</span><span>(</span><span style=color:#f07171>dir</span><span>):
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#f07171>dir</span><span style=color:#61676ccc>, </span><span style=color:#86b300>"is already present.. extracting may leads to overwrite of old files."</span><span>)
</span><span>		</span><span style=color:#f29718>exit</span><span>()
</span><span>	</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"""
</span><span style=color:#86b300>Select method 
</span><span style=color:#86b300>	1. Crack using built-in wordlist
</span><span style=color:#86b300>	2. Crack with custom wordlist
</span><span style=color:#86b300>	3. Crack using bruteforce method
</span><span style=color:#86b300>	0. Exit
</span><span style=color:#86b300>		"""</span><span>)
</span><span>	choice </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter your choice[1/2/3/0] : "</span><span>))
</span><span>	</span><span style=color:#fa6e32>if </span><span>choice </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>1 </span><span>:
</span><span>		</span><span style=color:#f29718>rocku</span><span>(zfile)
</span><span>	</span><span style=color:#fa6e32>elif </span><span>choice </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>2 </span><span>:
</span><span>		wfile </span><span style=color:#ed9366>= </span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter the absolute path of your password list: "</span><span>)
</span><span>		</span><span style=color:#fa6e32>if </span><span style=color:#ed9366>not </span><span>os</span><span style=color:#ed9366>.</span><span>path</span><span style=color:#ed9366>.</span><span style=color:#f29718>isfile</span><span>(wfile):
</span><span>			</span><span style=color:#f07171>print</span><span>(wfile</span><span style=color:#61676ccc>,</span><span style=color:#86b300>" is not found.."</span><span>)
</span><span>			</span><span style=color:#f29718>exit</span><span>()
</span><span>		</span><span style=color:#f29718>custom_passwd</span><span>(zfile</span><span style=color:#61676ccc>,</span><span>wfile)
</span><span>	</span><span style=color:#fa6e32>elif </span><span>choice </span><span style=color:#ed9366>== </span><span style=color:#ff8f40>3 </span><span>:
</span><span>		</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"""
</span><span style=color:#86b300>----------------------------------------------------------------------------
</span><span style=color:#86b300>Bruteforcing method takes too much of time and system resources to perform..
</span><span style=color:#86b300>Use this method to crack the passwords of length upto 4 only.
</span><span style=color:#86b300>And the passwords are combination of digits only.
</span><span style=color:#86b300>----------------------------------------------------------------------------
</span><span style=color:#86b300>			"""</span><span>)
</span><span>		passlen </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#86b300>"Enter the length of password[Note: &LT5] : "</span><span>))
</span><span>		</span><span style=color:#f29718>bruteforce</span><span>(zfile</span><span style=color:#61676ccc>,</span><span>passlen)
</span><span>	</span><span style=color:#fa6e32>else </span><span>:
</span><span>		</span><span style=color:#f29718>exit</span><span>()
</span></code></pre><p>The main() function is printing the menu of the script and performing the input files are validations. If the user chooses built-in wordlist method to crack the zip file then the <code>rocku()</code> function will be invoked.<pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>rocku</span><span>(</span><span style=color:#ff8f40>zfile</span><span>):
</span><span>	wordlist </span><span style=color:#ed9366>= </span><span style=color:#f07171>open</span><span>(</span><span style=color:#86b300>"rockyou.txt"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"r"</span><span>)
</span><span>	</span><span style=color:#fa6e32>with </span><span>pyzipper</span><span style=color:#ed9366>.</span><span style=color:#f29718>AESZipFile</span><span>(zfile) </span><span style=color:#fa6e32>as </span><span>zf:
</span><span>		</span><span style=color:#fa6e32>for </span><span>i </span><span style=color:#fa6e32>in </span><span>wordlist:
</span><span>			pwd </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>bytes</span><span>(i</span><span style=color:#ed9366>.</span><span style=color:#f29718>strip</span><span>()</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"utf-8"</span><span>)
</span><span>			</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"[-] Checking password : "</span><span style=color:#61676ccc>,</span><span>i)
</span><span>			</span><span style=color:#fa6e32>try</span><span>:
</span><span>				zf</span><span style=color:#ed9366>.</span><span style=color:#f29718>extractall</span><span>(</span><span style=color:#ff8f40>pwd </span><span style=color:#ed9366>= </span><span>pwd)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#ff8f40>50</span><span style=color:#ed9366>*</span><span style=color:#86b300>"*"</span><span>)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"[+] Password is found : "</span><span style=color:#61676ccc>,</span><span>i)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Files in "</span><span style=color:#61676ccc>,</span><span>zfile)
</span><span>				</span><span style=color:#fa6e32>for </span><span>f </span><span style=color:#fa6e32>in </span><span>zf</span><span style=color:#ed9366>.</span><span style=color:#f29718>namelist</span><span>():
</span><span>					</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"</span><span style=color:#4cbf99>\t</span><span style=color:#86b300>"</span><span style=color:#61676ccc>,</span><span>f)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#ff8f40>50</span><span style=color:#ed9366>*</span><span style=color:#86b300>"*"</span><span>)
</span><span>				</span><span style=color:#fa6e32>break
</span><span>		
</span><span>			</span><span style=color:#fa6e32>except</span><span>:
</span><span>				</span><span style=color:#fa6e32>continue
</span></code></pre><p>The rocku() function is opening the rockyou.txt file in read mode and the zip file is opened using the pyzipper module. Then it is iterating over the each password in the rockyou.txt file and converting it into bytes. The password bytes is given as arguement to the extractall() function. If the password is found then the files will be extracted and the list of files and the password will be printed on screen.<p>If the user chooses custom wordlist method to crack zip file the <code>custom_password()</code> function will be invoked.<pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>custom_passwd</span><span>(</span><span style=color:#ff8f40>zfile</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>wfile</span><span>):
</span><span>	wordlist </span><span style=color:#ed9366>= </span><span style=color:#f07171>open</span><span>(wfile</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"r"</span><span>)
</span><span>	</span><span style=color:#fa6e32>with </span><span>pyzipper</span><span style=color:#ed9366>.</span><span style=color:#f29718>AESZipFile</span><span>(zfile) </span><span style=color:#fa6e32>as </span><span>zf:
</span><span>		</span><span style=color:#fa6e32>for </span><span>i </span><span style=color:#fa6e32>in </span><span>wordlist:
</span><span>			pwd </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>bytes</span><span>(i</span><span style=color:#ed9366>.</span><span style=color:#f29718>strip</span><span>()</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"utf-8"</span><span>)
</span><span>			</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"[-] Checking password : "</span><span style=color:#61676ccc>,</span><span>i)
</span><span>			</span><span style=color:#fa6e32>try</span><span>:
</span><span>				zf</span><span style=color:#ed9366>.</span><span style=color:#f29718>extractall</span><span>(</span><span style=color:#ff8f40>pwd </span><span style=color:#ed9366>= </span><span>pwd)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#ff8f40>50</span><span style=color:#ed9366>*</span><span style=color:#86b300>"*"</span><span>)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"[+] Password is found : "</span><span style=color:#61676ccc>,</span><span>i)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Files in "</span><span style=color:#61676ccc>,</span><span>zfile)
</span><span>				</span><span style=color:#fa6e32>for </span><span>f </span><span style=color:#fa6e32>in </span><span>zf</span><span style=color:#ed9366>.</span><span style=color:#f29718>namelist</span><span>():
</span><span>					</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"</span><span style=color:#4cbf99>\t</span><span style=color:#86b300>"</span><span style=color:#61676ccc>,</span><span>f)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#ff8f40>50</span><span style=color:#ed9366>*</span><span style=color:#86b300>"*"</span><span>)
</span><span>				</span><span style=color:#fa6e32>break
</span><span>		
</span><span>			</span><span style=color:#fa6e32>except</span><span>:
</span><span>				</span><span style=color:#fa6e32>continue
</span><span>
</span></code></pre><p>The custom_password() function is doing the same thing as the rocku() function. Along with the zipfile the custom wordlist is needed to proceed.<p>If the user chooses bruteforce method the <code>bruteforce()</code> method will be invoked.<pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>def </span><span style=color:#f29718>bruteforce</span><span>(</span><span style=color:#ff8f40>zfile</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>passlen</span><span>):
</span><span>
</span><span>	</span><span style=color:#fa6e32>with </span><span>pyzipper</span><span style=color:#ed9366>.</span><span style=color:#f29718>AESZipFile</span><span>(zfile) </span><span style=color:#fa6e32>as </span><span>zf:
</span><span>		total_passwords </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(passlen</span><span style=color:#ed9366>* </span><span style=color:#86b300>"9"</span><span>)
</span><span>		</span><span style=color:#fa6e32>for </span><span>i </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(total_passwords</span><span style=color:#ed9366>+</span><span style=color:#ff8f40>1</span><span>):
</span><span>			pwd </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>bytes</span><span>(</span><span style=color:#55b4d4;font-style:italic>str</span><span>(i)</span><span style=color:#61676ccc>,</span><span style=color:#86b300>"utf-8"</span><span>)
</span><span>			</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"[-] Checking password : "</span><span style=color:#61676ccc>,</span><span>i)
</span><span>			</span><span style=color:#fa6e32>try</span><span>:
</span><span>				zf</span><span style=color:#ed9366>.</span><span style=color:#f29718>extractall</span><span>(</span><span style=color:#ff8f40>pwd </span><span style=color:#ed9366>= </span><span>pwd)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#ff8f40>50</span><span style=color:#ed9366>*</span><span style=color:#86b300>"*"</span><span>)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"[+] Password is found : "</span><span style=color:#61676ccc>,</span><span>i)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Files in "</span><span style=color:#61676ccc>,</span><span>zfile)
</span><span>				</span><span style=color:#fa6e32>for </span><span>f </span><span style=color:#fa6e32>in </span><span>zf</span><span style=color:#ed9366>.</span><span style=color:#f29718>namelist</span><span>():
</span><span>					</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"</span><span style=color:#4cbf99>\t</span><span style=color:#86b300>"</span><span style=color:#61676ccc>,</span><span>f)
</span><span>				</span><span style=color:#f07171>print</span><span>(</span><span style=color:#ff8f40>50</span><span style=color:#ed9366>*</span><span style=color:#86b300>"*"</span><span>)
</span><span>				</span><span style=color:#fa6e32>break
</span><span>		
</span><span>			</span><span style=color:#fa6e32>except</span><span>:
</span><span>				</span><span style=color:#fa6e32>continue
</span><span>
</span></code></pre><p>A brute force attack is a hacking method that uses trial and error to crack passwords, login credentials, and encryption keys. It is a simple yet reliable tactic for gaining unauthorized access to individual accounts and organizations’ systems and networks. The hacker tries multiple usernames and passwords, often using a computer to test a wide range of combinations, until they find the correct login information. The brute force approach is inefficient. For real-time problems, algorithm analysis often goes above the O(N!) order of growth.<p>As it is very time consuming for the long passwords i recommend to use this method for the passwords upto the length of 6. And this passwords are the combination of digits only.<h3 id=requirements>Requirements</h3><p>You require these additional modules<ol><li>pyzipper</ol><p>These modules will be pre installed on every system, if not then install them with <code>pip3 or pip</code><p><strong>You need to download rockyou.txt and paste it in PythonZipCracker folder</strong><blockquote><p>Rockyou.txt : <a href=https://www.kaggle.com/datasets/wjburns/common-password-list-rockyoutxt>https://www.kaggle.com/datasets/wjburns/common-password-list-rockyoutxt</a></blockquote><h3 id=installation>Installation</h3><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>git clone https://github.com/TheMj0ln1r/PythonZipCracker.git
</span><span>cd PythonZipCracker
</span><span>python3 crack.py
</span></code></pre><h3 id=preview>Preview</h3><p><img alt=Preview src=/assets/img/project_img/zipcrack/pythonzipcrack.png>{: w="600",h="600"}<blockquote><p>If anything should be modified in the script please let me know.</blockquote><p>You can find complete source code of PythonZipCracker here : <a href=https://github.com/TheMj0ln1r/PythonZipCracker>https://github.com/TheMj0ln1r/PythonZipCracker</a></section></article></main></div>